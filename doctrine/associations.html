        
<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head><base href="/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
                                
    
    <link rel="stylesheet" href="assets/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/badge_only.css" type="text/css" />

</head>

<body class="wy-body-for-nav">
 <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">
                
                                                                                                    
                                                                                                                                                                        </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                                                                                                                                                                                                                                                                                                                            </div>
        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                                                        

        <div class="wy-nav-content">                <div class="rst-content">
                                        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">                            <div itemprop="articleBody">
                                    <div class="section">
<h1 id="how-to-work-with-doctrine-associations-relations">
    How to Work with Doctrine Associations / Relations
    <a class="headerlink" href="#how-to-work-with-doctrine-associations-relations" title="Permalink to this headline">¶</a>
</h1>
<div class="admonition admonition-screencast screencast">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                <span>Screencast</span>
    </p><p>Do you prefer video tutorials? Check out the <a href="https://symfonycasts.com/screencast/doctrine-relations" class="reference external" rel="external noopener noreferrer" target="_blank">Mastering Doctrine Relations</a>
screencast series.</p>
</div>
<p>There are <strong>two</strong> main relationship/association types:</p>
<dl>
                        <dt><code translate="no" class="notranslate">ManyToOne</code> / <code translate="no" class="notranslate">OneToMany</code></dt>
        
        <dd>
                            The most common relationship, mapped in the database with a foreign
key column (e.g. a <code translate="no" class="notranslate">category_id</code> column on the <code translate="no" class="notranslate">product</code> table). This is
actually only <em>one</em> association type, but seen from the two different <em>sides</em>
of the relation.
                    </dd>
                        <dt><code translate="no" class="notranslate">ManyToMany</code></dt>
        
        <dd>
                            Uses a join table and is needed when both sides of the relationship can have
many of the other side (e.g. &quot;students&quot; and &quot;classes&quot;: each student is in many
classes, and each class has many students).
                    </dd>
    </dl>
<p>First, you need to determine which relationship to use. If both sides of the relation
will contain many of the other side (e.g. &quot;students&quot; and &quot;classes&quot;), you need a
<code translate="no" class="notranslate">ManyToMany</code> relation. Otherwise, you likely need a <code translate="no" class="notranslate">ManyToOne</code>.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>There is also a OneToOne relationship (e.g. one User has one Profile and vice
versa). In practice, using this is similar to <code translate="no" class="notranslate">ManyToOne</code>.</p>
</div>
<div class="section">
<h2 id="the-manytoone-onetomany-association">
    The ManyToOne / OneToMany Association
    <a class="headerlink" href="#the-manytoone-onetomany-association" title="Permalink to this headline">¶</a>
</h2>
<p>Suppose that each product in your application belongs to exactly one category.
In this case, you'll need a <code translate="no" class="notranslate">Category</code> class, and a way to relate a
<code translate="no" class="notranslate">Product</code> object to a <code translate="no" class="notranslate">Category</code> object.</p>
<p>Start by creating a <code translate="no" class="notranslate">Category</code> entity with a <code translate="no" class="notranslate">name</code> field:</p>
<div translate="no" class="highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs bash">$ php bin/console make:entity Category

New property name (press &lt;<span class="hljs-built_in">return</span>&gt; to stop adding fields):
&gt; name

Field <span class="hljs-built_in">type</span> (enter ? to see all types) [string]:
&gt; string

Field length [255]:
&gt; 255

Can this field be null <span class="hljs-keyword">in</span> the database (nullable) (yes/no) [no]:
&gt; no

New property name (press &lt;<span class="hljs-built_in">return</span>&gt; to stop adding fields):
&gt;
(press enter again to finish)</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This will generate your new entity class:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/Category.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-comment">// ...</span>

<span class="hljs-comment">#[ORM\Entity(repositoryClass: CategoryRepository::class)]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Category</span>
</span>{
    <span class="hljs-comment">#[ORM\Id]</span>
    <span class="hljs-comment">#[ORM\GeneratedValue]</span>
    <span class="hljs-comment">#[ORM\Column]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>;

    <span class="hljs-comment">#[ORM\Column]</span>
    <span class="hljs-keyword">private</span> string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>name</span>;

    <span class="hljs-comment">// ... getters and setters</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h2 id="mapping-the-manytoone-relationship">
    Mapping the ManyToOne Relationship
    <a class="headerlink" href="#mapping-the-manytoone-relationship" title="Permalink to this headline">¶</a>
</h2>
<p>In this example, each category can be associated with <em>many</em> products. But,
each product can be associated with only <em>one</em> category. This relationship
can be summarized as: <em>many</em> products to <em>one</em> category (or equivalently,
<em>one</em> category to <em>many</em> products).</p>
<p>From the perspective of the <code translate="no" class="notranslate">Product</code> entity, this is a many-to-one relationship.
From the perspective of the <code translate="no" class="notranslate">Category</code> entity, this is a one-to-many relationship.</p>
<p>To map this, first create a <code translate="no" class="notranslate">category</code> property on the <code translate="no" class="notranslate">Product</code> class with
the <code translate="no" class="notranslate">ManyToOne</code> annotation. You can do this by hand, or by using the <code translate="no" class="notranslate">make:entity</code>
command, which will ask you several questions about your relationship. If you're
not sure of the answer, don't worry! You can always change the settings later:</p>
<div translate="no" class="highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs bash">$ php bin/console make:entity

Class name of the entity to create or update (e.g. BraveChef):
&gt; Product

New property name (press &lt;<span class="hljs-built_in">return</span>&gt; to stop adding fields):
&gt; category

Field <span class="hljs-built_in">type</span> (enter ? to see all types) [string]:
&gt; relation

What class should this entity be related to?:
&gt; Category

Relation <span class="hljs-built_in">type</span>? [ManyToOne, OneToMany, ManyToMany, OneToOne]:
&gt; ManyToOne

Is the Product.category property allowed to be null (nullable)? (yes/no) [yes]:
&gt; no

Do you want to add a new property to Category so that you can access/update
Product objects from it - e.g. <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>-&gt;getProducts()? (yes/no) [yes]:
&gt; yes

New field name inside Category [products]:
&gt; products

Do you want to automatically delete orphaned App\Entity\Product objects
(orphanRemoval)? (yes/no) [no]:
&gt; no

New property name (press &lt;<span class="hljs-built_in">return</span>&gt; to stop adding fields):
&gt;
(press enter again to finish)</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This made changes to <em>two</em> entities. First, it added a new <code translate="no" class="notranslate">category</code> property to
the <code translate="no" class="notranslate">Product</code> entity (and getter &amp; setter methods):</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="php-attributes"
                aria-controls="configuration-block-tabpanel-27412a07405b1de1a7b9bb42ab84467bf91db54f" aria-selected="true"
                data-active="true" >
                <span>Attributes</span>
            </button>
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-76fb89b59c862cbccca3d048d3b36714c2b44690" aria-selected="false"
                 tabindex="-1">
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-fef0f6c0d36ef074add42e9c277a36b449d81618" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-27412a07405b1de1a7b9bb42ab84467bf91db54f" aria-label="Attributes" class="configuration-codeblock" data-language="php-attributes" style="">
            <div translate="no" class="highlight-php-attributes highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-attributes php"><span class="hljs-comment">// src/Entity/Product.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Product</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">#[ORM\ManyToOne(targetEntity: Category::class, inversedBy: 'products')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCategory</span><span class="hljs-params">()</span>: ?<span class="hljs-title">Category</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>category;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setCategory</span><span class="hljs-params">(?Category <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>category = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>;

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-76fb89b59c862cbccca3d048d3b36714c2b44690" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="display: none">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># src/Resources/config/doctrine/Product.orm.yml</span>
<span class="hljs-string">App\Entity\Product:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">entity</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">manyToOne:</span>
        <span class="hljs-attr">category:</span>
            <span class="hljs-attr">targetEntity:</span> <span class="hljs-string">App\Entity\Category</span>
            <span class="hljs-attr">inversedBy:</span> <span class="hljs-string">products</span>
            <span class="hljs-attr">joinColumn:</span>
                <span class="hljs-attr">nullable:</span> <span class="hljs-literal">false</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-fef0f6c0d36ef074add42e9c277a36b449d81618" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- src/Resources/config/doctrine/Product.orm.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">doctrine-mapping</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping
        https://doctrine-project.org/schemas/orm/doctrine-mapping.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"App\Entity\Product"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">many-to-one</span>
            <span class="hljs-attr">field</span>=<span class="hljs-string">"category"</span>
            <span class="hljs-attr">target-entity</span>=<span class="hljs-string">"App\Entity\Category"</span>
            <span class="hljs-attr">inversed-by</span>=<span class="hljs-string">"products"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">join-column</span> <span class="hljs-attr">nullable</span>=<span class="hljs-string">"false"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">many-to-one</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">doctrine-mapping</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>This <code translate="no" class="notranslate">ManyToOne</code> mapping is required. It tells Doctrine to use the <code translate="no" class="notranslate">category_id</code>
column on the <code translate="no" class="notranslate">product</code> table to relate each record in that table with
a record in the <code translate="no" class="notranslate">category</code> table.</p>
<p>Next, since <em>one</em> <code translate="no" class="notranslate">Category</code> object will relate to <em>many</em> <code translate="no" class="notranslate">Product</code> objects,
the <code translate="no" class="notranslate">make:entity</code> command <em>also</em> added a <code translate="no" class="notranslate">products</code> property to the <code translate="no" class="notranslate">Category</code>
class that will hold these objects:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="php-attributes"
                aria-controls="configuration-block-tabpanel-0ae57c26cfac5871c40c1ff9d73e802cf2c16a7e" aria-selected="true"
                data-active="true" >
                <span>Attributes</span>
            </button>
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-f537c65700b533fde9ea04c67e748210cdc49c6c" aria-selected="false"
                 tabindex="-1">
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-cf524f9345bb287b0c99e522c69164e6f299e4af" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-0ae57c26cfac5871c40c1ff9d73e802cf2c16a7e" aria-label="Attributes" class="configuration-codeblock" data-language="php-attributes" style="">
            <div translate="no" class="highlight-php-attributes highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-attributes php"><span class="hljs-comment">// src/Entity/Category.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Common</span>\<span class="hljs-title">Collections</span>\<span class="hljs-title">ArrayCollection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Common</span>\<span class="hljs-title">Collections</span>\<span class="hljs-title">Collection</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Category</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">#[ORM\OneToMany(targetEntity: Product::class, mappedBy: 'category')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>products</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products = <span class="hljs-keyword">new</span> ArrayCollection();
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> Collection|Product[]
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getProducts</span><span class="hljs-params">()</span>: <span class="hljs-title">Collection</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products;
    }

    <span class="hljs-comment">// addProduct() and removeProduct() were also added</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-f537c65700b533fde9ea04c67e748210cdc49c6c" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="display: none">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># src/Resources/config/doctrine/Category.orm.yml</span>
<span class="hljs-string">App\Entity\Category:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">entity</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">oneToMany:</span>
        <span class="hljs-attr">products:</span>
            <span class="hljs-attr">targetEntity:</span> <span class="hljs-string">App\Entity\Product</span>
            <span class="hljs-attr">mappedBy:</span> <span class="hljs-string">category</span>
<span class="hljs-comment"># Don't forget to initialize the collection in</span>
<span class="hljs-comment"># the __construct() method of the entity</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-cf524f9345bb287b0c99e522c69164e6f299e4af" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- src/Resources/config/doctrine/Category.orm.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">doctrine-mapping</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping
        https://doctrine-project.org/schemas/orm/doctrine-mapping.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"App\Entity\Category"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">one-to-many</span>
            <span class="hljs-attr">field</span>=<span class="hljs-string">"products"</span>
            <span class="hljs-attr">target-entity</span>=<span class="hljs-string">"App\Entity\Product"</span>
            <span class="hljs-attr">mapped-by</span>=<span class="hljs-string">"category"</span>/&gt;</span>

        <span class="hljs-comment">&lt;!--
            don't forget to init the collection in
            the __construct() method of the entity
        --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">doctrine-mapping</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>The <code translate="no" class="notranslate">ManyToOne</code> mapping shown earlier is <em>required</em>, But, this <code translate="no" class="notranslate">OneToMany</code>
is optional: only add it <em>if</em> you want to be able to access the products that are
related to a category (this is one of the questions <code translate="no" class="notranslate">make:entity</code> asks you). In
this example, it <em>will</em> be useful to be able to call <code translate="no" class="notranslate">$category-&gt;getProducts()</code>.
If you don't want it, then you also don't need the <code translate="no" class="notranslate">inversedBy</code> or <code translate="no" class="notranslate">mappedBy</code>
config.</p>
<div class="admonition-wrapper"><div class="admonition admonition-sidebar"><p class="sidebar-title"><span>What is the ArrayCollection Stuff?</span></p><p>The code inside <code translate="no" class="notranslate">__construct()</code> is important: The <code translate="no" class="notranslate">$products</code> property must
be a collection object that implements Doctrine's <code translate="no" class="notranslate">Collection</code> interface.
In this case, an <a href="https://www.doctrine-project.org/projects/doctrine-collections/en/1.6/index.html" class="reference external" rel="external noopener noreferrer" target="_blank">ArrayCollection</a> object is used. This looks and acts almost
<em>exactly</em> like an array, but has some added flexibility. Just imagine that
it is an <code translate="no" class="notranslate">array</code> and you'll be in good shape.</p>
</div></div>
<p>Your database is set up! Now, run the migrations like normal:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console doctrine:migrations:diff
<span class="hljs-prompt">$ </span>php bin/console doctrine:migrations:migrate</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Thanks to the relationship, this creates a <code translate="no" class="notranslate">category_id</code> foreign key column on
the <code translate="no" class="notranslate">product</code> table. Doctrine is ready to persist our relationship!</p>
</div>
<div class="section">
<h2 id="saving-related-entities">
    Saving Related Entities
    <a class="headerlink" href="#saving-related-entities" title="Permalink to this headline">¶</a>
</h2>
<p>Now you can see this new code in action! Imagine you're inside a controller:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/ProductController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Category</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Product</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">EntityManagerInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/product', name: 'product')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">(EntityManagerInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span> = <span class="hljs-keyword">new</span> Category();
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span><span class="hljs-operator">-&gt;</span>setName(<span class="hljs-string">'Computer Peripherals'</span>);

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span> = <span class="hljs-keyword">new</span> Product();
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setName(<span class="hljs-string">'Keyboard'</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setPrice(<span class="hljs-number">19.99</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setDescription(<span class="hljs-string">'Ergonomic and stylish!'</span>);

        <span class="hljs-comment">// relates this product to the category</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setCategory(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>);

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span><span class="hljs-operator">-&gt;</span>persist(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span><span class="hljs-operator">-&gt;</span>persist(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span><span class="hljs-operator">-&gt;</span>flush();

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Response(
            <span class="hljs-string">'Saved new product with id: '</span>.<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>getId()
            .<span class="hljs-string">' and new category with id: '</span>.<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span><span class="hljs-operator">-&gt;</span>getId()
        );
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>When you go to <code translate="no" class="notranslate">/product</code>, a single row is added to both the <code translate="no" class="notranslate">category</code> and
<code translate="no" class="notranslate">product</code> tables. The <code translate="no" class="notranslate">product.category_id</code> column for the new product is set
to whatever the <code translate="no" class="notranslate">id</code> is of the new category. Doctrine manages the persistence of this
relationship for you:</p>
<img src="_images/mapping_relations.png" align="center" />
<p>If you're new to an ORM, this is the <em>hardest</em> concept: you need to stop thinking
about your database, and instead <em>only</em> think about your objects. Instead of setting
the category's integer id onto <code translate="no" class="notranslate">Product</code>, you set the entire <code translate="no" class="notranslate">Category</code> <em>object</em>.
Doctrine takes care of the rest when saving.</p>
<div class="admonition-wrapper"><div class="admonition admonition-sidebar"><p class="sidebar-title"><span>Updating the Relationship from the Inverse Side</span></p><p>Could you also call <code translate="no" class="notranslate">$category-&gt;addProduct()</code> to change the relationship? Yes,
but, only because the <code translate="no" class="notranslate">make:entity</code> command helped us. For more details,
see: <a href="#associations-inverse-side" class="reference internal">associations-inverse-side</a>.</p>
</div></div>
</div>
<div class="section">
<h2 id="fetching-related-objects">
    Fetching Related Objects
    <a class="headerlink" href="#fetching-related-objects" title="Permalink to this headline">¶</a>
</h2>
<p>When you need to fetch associated objects, your workflow looks like it did
before. First, fetch a <code translate="no" class="notranslate">$product</code> object and then access its related
<code translate="no" class="notranslate">Category</code> object:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/ProductController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Product</span>;
<span class="hljs-comment">// ...</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span><span class="hljs-params">(ProductRepository <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productRepository</span>, int <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productRepository</span><span class="hljs-operator">-&gt;</span>find(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>);
        <span class="hljs-comment">// ...</span>

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>categoryName</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>getCategory()<span class="hljs-operator">-&gt;</span>getName();

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>In this example, you first query for a <code translate="no" class="notranslate">Product</code> object based on the product's
<code translate="no" class="notranslate">id</code>. This issues a query to fetch <em>only</em> the product data and hydrates the
<code translate="no" class="notranslate">$product</code>. Later, when you call <code translate="no" class="notranslate">$product-&gt;getCategory()-&gt;getName()</code>,
Doctrine silently makes a second query to find the <code translate="no" class="notranslate">Category</code> that's related
to this <code translate="no" class="notranslate">Product</code>. It prepares the <code translate="no" class="notranslate">$category</code> object and returns it to
you.</p>
<img src="_images/mapping_relations_proxy.png" align="center" />
<p>What's important is the fact that you have access to the product's related
category, but the category data isn't actually retrieved until you ask for
the category (i.e. it's &quot;lazily loaded&quot;).</p>
<p>Because we mapped the optional <code translate="no" class="notranslate">OneToMany</code> side, you can also query in the other
direction:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/ProductController.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProducts</span><span class="hljs-params">(CategoryRepository <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>categoryRepository</span>, int <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>categoryRepository</span><span class="hljs-operator">-&gt;</span>find(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>);

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>products</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span><span class="hljs-operator">-&gt;</span>getProducts();

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>In this case, the same things occur: you first query for a single <code translate="no" class="notranslate">Category</code>
object. Then, only when (and if) you access the products, Doctrine makes a second
query to retrieve the related <code translate="no" class="notranslate">Product</code> objects. This extra query can be avoided
by adding JOINs.</p>
<div class="admonition-wrapper"><div class="admonition admonition-sidebar"><p class="sidebar-title"><span>Relationships and Proxy Classes</span></p><p>This &quot;lazy loading&quot; is possible because, when necessary, Doctrine returns
a &quot;proxy&quot; object in place of the true object. Look again at the above
example:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productRepository</span><span class="hljs-operator">-&gt;</span>find(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>);

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>getCategory();

<span class="hljs-comment">// prints "Proxies\AppEntityCategoryProxy"</span>
dump(get_class(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span>));
<span class="hljs-keyword">die</span>();</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This proxy object extends the true <code translate="no" class="notranslate">Category</code> object, and looks and
acts exactly like it. The difference is that, by using a proxy object,
Doctrine can delay querying for the real <code translate="no" class="notranslate">Category</code> data until you
actually need that data (e.g. until you call <code translate="no" class="notranslate">$category-&gt;getName()</code>).</p>
<p>The proxy classes are generated by Doctrine and stored in the cache directory.
You'll probably never even notice that your <code translate="no" class="notranslate">$category</code> object is actually
a proxy object.</p>
<p>In the next section, when you retrieve the product and category data
all at once (via a <em>join</em>), Doctrine will return the <em>true</em> <code translate="no" class="notranslate">Category</code>
object, since nothing needs to be lazily loaded.</p>
</div></div>
<span id="doctrine-associations-join-query"></span>
</div>
<div class="section">
<h2 id="joining-related-records">
    Joining Related Records
    <a class="headerlink" href="#joining-related-records" title="Permalink to this headline">¶</a>
</h2>
<p>In the examples above, two queries were made - one for the original object
(e.g. a <code translate="no" class="notranslate">Category</code>) and one for the related object(s) (e.g. the <code translate="no" class="notranslate">Product</code>
objects).</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Remember that you can see all of the queries made during a request via
the web debug toolbar.</p>
</div>
<p>If you know up front that you'll need to access both objects, you
can avoid the second query by issuing a join in the original query. Add the
following method to the <code translate="no" class="notranslate">ProductRepository</code> class:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Repository/ProductRepository.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceEntityRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findOneByIdJoinedToCategory</span><span class="hljs-params">(int <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productId</span>)</span>: ?<span class="hljs-title">Product</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>getEntityManager();

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>query</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>entityManager</span><span class="hljs-operator">-&gt;</span>createQuery(
            <span class="hljs-string">'SELECT p, c
            FROM App\Entity\Product p
            INNER JOIN p.category c
            WHERE p.id = :id'</span>
        )<span class="hljs-operator">-&gt;</span>setParameter(<span class="hljs-string">'id'</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productId</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>query</span><span class="hljs-operator">-&gt;</span>getOneOrNullResult();
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This will <em>still</em> return an array of <code translate="no" class="notranslate">Product</code> objects. But now, when you call
<code translate="no" class="notranslate">$product-&gt;getCategory()</code> and use that data, no second query is made.</p>
<p>Now, you can use this method in your controller to query for a <code translate="no" class="notranslate">Product</code>
object and its related <code translate="no" class="notranslate">Category</code> in one query:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/ProductController.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span><span class="hljs-params">(ProductRepository <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productRepository</span>, int <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>productRepository</span><span class="hljs-operator">-&gt;</span>findOneByIdJoinedToCategory(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>);

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>category</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>getCategory();

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="associations-inverse-side"></span>
</div>
<div class="section">
<h2 id="setting-information-from-the-inverse-side">
    Setting Information from the Inverse Side
    <a class="headerlink" href="#setting-information-from-the-inverse-side" title="Permalink to this headline">¶</a>
</h2>
<p>So far, you've updated the relationship by calling <code translate="no" class="notranslate">$product-&gt;setCategory($category)</code>.
This is no accident! Each relationship has two sides: in this example, <code translate="no" class="notranslate">Product.category</code>
is the <em>owning</em> side and <code translate="no" class="notranslate">Category.products</code> is the <em>inverse</em> side.</p>
<p>To update a relationship in the database, you <em>must</em> set the relationship on the
<em>owning</em> side. The owning side is always where the <code translate="no" class="notranslate">ManyToOne</code> mapping is set
(for a <code translate="no" class="notranslate">ManyToMany</code> relation, you can choose which side is the owning side).</p>
<p>Does this mean it's not possible to call <code translate="no" class="notranslate">$category-&gt;addProduct()</code> or
<code translate="no" class="notranslate">$category-&gt;removeProduct()</code> to update the database? Actually, it <em>is</em> possible,
thanks to some clever code that the <code translate="no" class="notranslate">make:entity</code> command generated:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/Category.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Category</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addProduct</span><span class="hljs-params">(Product <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products<span class="hljs-operator">-&gt;</span>contains(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>)) {
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products[] = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>;
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setCategory(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The <em>key</em> is <code translate="no" class="notranslate">$product-&gt;setCategory($this)</code>, which sets the <em>owning</em> side. Thanks,
to this, when you save, the relationship <em>will</em> update in the database.</p>
<p>What about <em>removing</em> a <code translate="no" class="notranslate">Product</code> from a <code translate="no" class="notranslate">Category</code>? The <code translate="no" class="notranslate">make:entity</code> command
also generated a <code translate="no" class="notranslate">removeProduct()</code> method:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/Category.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Category</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeProduct</span><span class="hljs-params">(Product <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products<span class="hljs-operator">-&gt;</span>contains(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>)) {
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>products<span class="hljs-operator">-&gt;</span>removeElement(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span>);
            <span class="hljs-comment">// set the owning side to null (unless already changed)</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>getCategory() === <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>) {
                <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>product</span><span class="hljs-operator">-&gt;</span>setCategory(<span class="hljs-keyword">null</span>);
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Thanks to this, if you call <code translate="no" class="notranslate">$category-&gt;removeProduct($product)</code>, the <code translate="no" class="notranslate">category_id</code>
on that <code translate="no" class="notranslate">Product</code> will be set to <code translate="no" class="notranslate">null</code> in the database.</p>
<p>But, instead of setting the <code translate="no" class="notranslate">category_id</code> to null, what if you want the <code translate="no" class="notranslate">Product</code>
to be <em>deleted</em> if it becomes &quot;orphaned&quot; (i.e. without a <code translate="no" class="notranslate">Category</code>)? To choose
that behavior, use the <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/current/reference/working-with-associations.html#orphan-removal" class="reference external" rel="external noopener noreferrer" target="_blank">orphanRemoval</a> option inside <code translate="no" class="notranslate">Category</code>:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-1">
                    <button role="tab" type="button" data-language="php-attributes"
                aria-controls="configuration-block-tabpanel-eee4dd89ca1dd5909bcff125807c179353f78b49" aria-selected="true"
                data-active="true" >
                <span>Attributes</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-eee4dd89ca1dd5909bcff125807c179353f78b49" aria-label="Attributes" class="configuration-codeblock" data-language="php-attributes" style="">
            <div translate="no" class="highlight-php-attributes highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-attributes php"><span class="hljs-comment">// src/Entity/Category.php</span>

<span class="hljs-comment">// ...</span>

<span class="hljs-comment">#[ORM\OneToMany(targetEntity: Product::class, mappedBy: 'category', orphanRemoval: true)]</span>
<span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>products</span>;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Thanks to this, if the <code translate="no" class="notranslate">Product</code> is removed from the <code translate="no" class="notranslate">Category</code>, it will be
removed from the database entirely.</p>
</div>
<div class="section">
<h2 id="more-information-on-associations">
    More Information on Associations
    <a class="headerlink" href="#more-information-on-associations" title="Permalink to this headline">¶</a>
</h2>
<p>This section has been an introduction to one common type of entity relationship,
the one-to-many relationship. For more advanced details and examples of how
to use other types of relations (e.g. one-to-one, many-to-many), see
Doctrine's <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/current/reference/association-mapping.html" class="reference external" rel="external noopener noreferrer" target="_blank">Association Mapping Documentation</a>.</p>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>If you're using attributes, you'll need to prepend all attributes with
<code translate="no" class="notranslate">#[ORM\]</code> (e.g. <code translate="no" class="notranslate">#[ORM\OneToMany]</code>), which is not reflected in Doctrine's
documentation.</p>
</div>
</div>
</div>

                            </div>                    </div>
                                    </div>        </div>

    </section>

</div>


<script type="text/javascript" src="assets/js/theme.js"></script>
<script type="text/javascript" src="assets/js/badge_only.js"></script>

 
</body>
</html>