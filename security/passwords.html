        
<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head><base href="/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
                                
    
    <link rel="stylesheet" href="assets/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/badge_only.css" type="text/css" />

</head>

<body class="wy-body-for-nav">
 <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">
                
                                                                                                    
                                                                                                                                                                        </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                                                                                                                                                                                                                                                                                                                            </div>
        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                                                        

        <div class="wy-nav-content">                <div class="rst-content">
                                        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">                            <div itemprop="articleBody">
                                    <div class="section">
<h1 id="password-hashing-and-verification">
    Password Hashing and Verification
    <a class="headerlink" href="#password-hashing-and-verification" title="Permalink to this headline">¶</a>
</h1>
<p>Most applications use passwords to login users. These passwords should be
hashed to securely store them. Symfony's PasswordHasher component provides
all utilities to safely hash and verify passwords.</p>
<p>Make sure it is installed by running:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfony/password-hasher</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="section">
<h2 id="configuring-a-password-hasher">
    Configuring a Password Hasher
    <a class="headerlink" href="#configuring-a-password-hasher" title="Permalink to this headline">¶</a>
</h2>
<p>Before hashing passwords, you must configure a hasher using the
<code translate="no" class="notranslate">password_hashers</code> option. You must configure the <em>hashing algorithm</em> and
optionally some <em>algorithm options</em>:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-4">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-a27ba82793fe9a516f4f894a71612a1c78b7fafa" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-828f4e34591542c63732de9d88e3a04017e33bef" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-04ba8c794357bca7628f9ade495bbee04786df78" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
                    <button role="tab" type="button" data-language="php-standalone"
                aria-controls="configuration-block-tabpanel-3397ffcda50788c42727dc53bedbf38619b72adc" aria-selected="false"
                 tabindex="-1">
                <span>Standalone Use</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-a27ba82793fe9a516f4f894a71612a1c78b7fafa" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-comment"># auto hasher with default options for the User class (and children)</span>
        <span class="hljs-string">App\Entity\User:</span> <span class="hljs-string">'auto'</span>

        <span class="hljs-comment"># auto hasher with custom options for all PasswordAuthenticatedUserInterface instances</span>
        <span class="hljs-string">Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">'auto'</span>
            <span class="hljs-attr">cost:</span>      <span class="hljs-number">15</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-828f4e34591542c63732de9d88e3a04017e33bef" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-comment">&lt;!-- auto hasher with default options for the User class (and children) --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"App\Entity\User"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"auto"</span>
        /&gt;</span>

        <span class="hljs-comment">&lt;!-- auto hasher with custom options for all PasswordAuthenticatedUserInterface instances --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"auto"</span>
            <span class="hljs-attr">cost</span>=<span class="hljs-string">"15"</span>
        /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-04ba8c794357bca7628f9ade495bbee04786df78" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">User</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// auto hasher with default options for the User class (and children)</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(User<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'auto'</span>);

    <span class="hljs-comment">// auto hasher with custom options for all PasswordAuthenticatedUserInterface instances</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(PasswordAuthenticatedUserInterface<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'auto'</span>)
        <span class="hljs-operator">-&gt;</span>cost(<span class="hljs-number">15</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3397ffcda50788c42727dc53bedbf38619b72adc" aria-label="Standalone Use" class="configuration-codeblock" data-language="php-standalone" style="display: none">
            <div translate="no" class="highlight-php-standalone highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-standalone php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">User</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">PasswordHasherFactory</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasherFactory</span> = <span class="hljs-keyword">new</span> PasswordHasherFactory([
    <span class="hljs-comment">// auto hasher with default options for the User class (and children)</span>
    User<span class="hljs-operator">::</span>class =&gt; [<span class="hljs-string">'algorithm'</span> =&gt; <span class="hljs-string">'auto'</span>],

    <span class="hljs-comment">// auto hasher with custom options for all PasswordAuthenticatedUserInterface instances</span>
    PasswordAuthenticatedUserInterface<span class="hljs-operator">::</span>class =&gt; [
        <span class="hljs-string">'algorithm'</span> =&gt; <span class="hljs-string">'auto'</span>,
        <span class="hljs-string">'cost'</span> =&gt; <span class="hljs-number">15</span>,
    ],
]);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>In this example, the &quot;auto&quot; algorithm is used. This hasher automatically
selects the most secure algorithm available on your system. Combined with
<a href="passwords.html#security-password-migration" class="reference internal">password migration</a>, this allows you to
always secure passwords in the safest way possible (even when new
algorithms are introduced in future PHP releases).</p>
<p>Further in this article, you can find a
<a href="passwords.html#passwordhasher-supported-algorithms" class="reference internal">full reference of all supported algorithms</a>.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Hashing passwords is resource intensive and takes time in order to
generate secure password hashes. In general, this makes your password
hashing more secure.</p>
<p>In tests however, secure hashes are not important, so you can change
the password hasher configuration in <code translate="no" class="notranslate">test</code> environment to run tests
faster:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-e57876dde03543205e51f319831cba55da81ee6d" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-6c0c6568796e7ba595552128b9f94c93b2bb9dc5" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-dbafb9de9d572a60dac2f6c5e04b32755fcfa3c8" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-e57876dde03543205e51f319831cba55da81ee6d" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/test/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-comment"># Use your user class name here</span>
        <span class="hljs-string">App\Entity\User:</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">plaintext</span> <span class="hljs-comment"># disable hashing (only do this in tests!)</span>

        <span class="hljs-comment"># or use the lowest possible values</span>
        <span class="hljs-string">App\Entity\User:</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">auto</span> <span class="hljs-comment"># This should be the same value as in config/packages/security.yaml</span>
            <span class="hljs-attr">cost:</span> <span class="hljs-number">4</span> <span class="hljs-comment"># Lowest possible value for bcrypt</span>
            <span class="hljs-attr">time_cost:</span> <span class="hljs-number">3</span> <span class="hljs-comment"># Lowest possible value for argon</span>
            <span class="hljs-attr">memory_cost:</span> <span class="hljs-number">10</span> <span class="hljs-comment"># Lowest possible value for argon</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-6c0c6568796e7ba595552128b9f94c93b2bb9dc5" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/test/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- class: Use your user class name here --&gt;</span>
        <span class="hljs-comment">&lt;!-- algorithm: disable hashing (only do this in tests!) --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"App\Entity\User"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"plaintext"</span>
        /&gt;</span>

        <span class="hljs-comment">&lt;!-- or use the lowest possible values --&gt;</span>
        <span class="hljs-comment">&lt;!-- algorithm: This should be the same value as in config/packages/security.yaml --&gt;</span>
        <span class="hljs-comment">&lt;!-- cost: Lowest possible value for bcrypt --&gt;</span>
        <span class="hljs-comment">&lt;!-- time_cost: Lowest possible value for argon --&gt;</span>
        <span class="hljs-comment">&lt;!-- memory_cost: Lowest possible value for argon --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"App\Entity\User"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"auto"</span>
            <span class="hljs-attr">cost</span>=<span class="hljs-string">"4"</span>
            <span class="hljs-attr">time_cost</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">memory_cost</span>=<span class="hljs-string">"10"</span>
        /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-dbafb9de9d572a60dac2f6c5e04b32755fcfa3c8" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/test/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">User</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// Use your user class name here</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(User<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'plaintext'</span>); <span class="hljs-comment">// disable hashing (only do this in tests!)</span>

    <span class="hljs-comment">// or use the lowest possible values</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(User<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'auto'</span>) <span class="hljs-comment">// This should be the same value as in config/packages/security.yaml</span>
        <span class="hljs-operator">-&gt;</span>cost(<span class="hljs-number">4</span>) <span class="hljs-comment">// Lowest possible value for bcrypt</span>
        <span class="hljs-operator">-&gt;</span>timeCost(<span class="hljs-number">2</span>) <span class="hljs-comment">// Lowest possible value for argon</span>
        <span class="hljs-operator">-&gt;</span>memoryCost(<span class="hljs-number">10</span>) <span class="hljs-comment">// Lowest possible value for argon</span>
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
</div>
<div class="section">
<h2 id="hashing-the-password">
    Hashing the Password
    <a class="headerlink" href="#hashing-the-password" title="Permalink to this headline">¶</a>
</h2>
<p>After configuring the correct algorithm, you can use the
<code translate="no" class="notranslate">UserPasswordHasherInterface</code> to hash and verify the passwords:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-2">
                    <button role="tab" type="button" data-language="php-symfony"
                aria-controls="configuration-block-tabpanel-35b2869376f3b32dd80657ebf3adc80d24180842" aria-selected="true"
                data-active="true" >
                <span>Framework Use</span>
            </button>
                    <button role="tab" type="button" data-language="php-standalone"
                aria-controls="configuration-block-tabpanel-cb230d321f167ae7a134edf117ee350607b1d3f1" aria-selected="false"
                 tabindex="-1">
                <span>Standalone Use</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-35b2869376f3b32dd80657ebf3adc80d24180842" aria-label="Framework Use" class="configuration-codeblock" data-language="php-symfony" style="">
            <div translate="no" class="highlight-php-symfony highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-symfony php"><span class="hljs-comment">// src/Controller/RegistrationController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span>
<span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpKernel</span>\<span class="hljs-title">Exception</span>\<span class="hljs-title">AccessDeniedHttpException</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">UserPasswordHasherInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registration</span><span class="hljs-params">(UserPasswordHasherInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span>)</span>
    </span>{
        <span class="hljs-comment">// ... e.g. get the user data from a registration form</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = <span class="hljs-keyword">new</span> User(...);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span> = ...;

        <span class="hljs-comment">// hash the password (based on the security.yaml config for the $user class)</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span><span class="hljs-operator">-&gt;</span>hashPassword(
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>,
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span>
        );
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>setPassword(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>);

        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delete</span><span class="hljs-params">(UserPasswordHasherInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span>, UserInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>)</span>
    </span>{
        <span class="hljs-comment">// ... e.g. get the password from a "confirm deletion" dialog</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span> = ...;

        <span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span><span class="hljs-operator">-&gt;</span>isPasswordValid(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AccessDeniedHttpException();
        }
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-cb230d321f167ae7a134edf117ee350607b1d3f1" aria-label="Standalone Use" class="configuration-codeblock" data-language="php-standalone" style="display: none">
            <div translate="no" class="highlight-php-standalone highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-standalone php"><span class="hljs-comment">// ...</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span> = <span class="hljs-keyword">new</span> UserPasswordHasher(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasherFactory</span>);

<span class="hljs-comment">// Get the user password (e.g. from a registration form)</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = <span class="hljs-keyword">new</span> User(...);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span> = ...;

<span class="hljs-comment">// hash the password (based on the password hasher factory config for the $user class)</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span><span class="hljs-operator">-&gt;</span>hashPassword(
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>,
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span>
);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>setPassword(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>);

<span class="hljs-comment">// In another action (e.g. to confirm deletion), you can verify the password</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span> = ...;
<span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span><span class="hljs-operator">-&gt;</span>isPasswordValid(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-keyword">Exception</span>(<span class="hljs-string">'Bad credentials, cannot delete this user.'</span>);
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
<div class="section">
<h2 id="reset-password">
    Reset Password
    <a class="headerlink" href="#reset-password" title="Permalink to this headline">¶</a>
</h2>
<p>Using <a href="https://symfony.com/doc/current/bundles/SymfonyMakerBundle/index.html" class="reference external">MakerBundle</a> and <a href="https://github.com/symfonycasts/reset-password-bundle" class="reference external" rel="external noopener noreferrer" target="_blank">SymfonyCastsResetPasswordBundle</a>, you can create
a secure out of the box solution to handle forgotten passwords. First,
install the SymfonyCastsResetPasswordBundle:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfonycasts/reset-password-bundle</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Then, use the <code translate="no" class="notranslate">make:reset-password</code> command. This asks you a few
questions about your app and generates all the files you need! After,
you'll see a success message and a list of any other steps you need to do.</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console make:reset-password</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can customize the reset password bundle's behavior by updating the
<code translate="no" class="notranslate">reset_password.yaml</code> file. For more information on the configuration,
check out the <a href="https://github.com/symfonycasts/reset-password-bundle" class="reference external" rel="external noopener noreferrer" target="_blank">SymfonyCastsResetPasswordBundle</a>  guide.</p>
<span id="security-password-migration"></span>
</div>
<div class="section">
<h2 id="password-migration">
    Password Migration
    <a class="headerlink" href="#password-migration" title="Permalink to this headline">¶</a>
</h2>
<p>In order to protect passwords, it is recommended to store them using the latest
hash algorithms. This means that if a better hash algorithm is supported on your
system, the user's password should be <em>rehashed</em> using the newer algorithm and
stored. That's possible with the <code translate="no" class="notranslate">migrate_from</code> option:</p>
<ol class="arabic">
    <li><a href="passwords.html#configure-a-new-hasher-using-migrate-from" class="reference internal">Configure a new Hasher Using &quot;migrate_from&quot;</a></li>
<li><a href="passwords.html#upgrade-the-password" class="reference internal">Upgrade the Password</a></li>
<li>Optionally, <a href="passwords.html#trigger-password-migration-from-a-custom-hasher" class="reference internal">Trigger Password Migration From a Custom Hasher</a></li>
</ol>
<div class="section">
<h3 id="configure-a-new-hasher-using-migrate-from">
    Configure a new Hasher Using &quot;migrate_from&quot;
    <a class="headerlink" href="#configure-a-new-hasher-using-migrate-from" title="Permalink to this headline">¶</a>
</h3>
<p>When a better hashing algorithm becomes available, you should keep the existing
hasher(s), rename it, and then define the new one. Set the <code translate="no" class="notranslate">migrate_from</code> option
on the new hasher to point to the old, legacy hasher(s):</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-4">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-b6a69d50c1d69592c37dcc92703658585758d9e6" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-3e6125a4db9721dab1b0cb7438327914265d40c6" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-ba2ac53f84223ec599d8d2ba146b779c8b482dd7" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
                    <button role="tab" type="button" data-language="php-standalone"
                aria-controls="configuration-block-tabpanel-fa9ae78c4db7c16d5a043b6522a0c0b132ff13e9" aria-selected="false"
                 tabindex="-1">
                <span>Standalone Use</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-b6a69d50c1d69592c37dcc92703658585758d9e6" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-comment"># a hasher used in the past for some users</span>
        <span class="hljs-attr">legacy:</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">sha256</span>
            <span class="hljs-attr">encode_as_base64:</span> <span class="hljs-literal">false</span>
            <span class="hljs-attr">iterations:</span> <span class="hljs-number">1</span>

        <span class="hljs-string">App\Entity\User:</span>
            <span class="hljs-comment"># the new hasher, along with its options</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">sodium</span>
            <span class="hljs-attr">migrate_from:</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">bcrypt</span> <span class="hljs-comment"># uses the "bcrypt" hasher with the default options</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">legacy</span> <span class="hljs-comment"># uses the "legacy" hasher configured above</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3e6125a4db9721dab1b0cb7438327914265d40c6" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:security</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">security:config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"legacy"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"sha256"</span>
            <span class="hljs-attr">encode-as-base64</span>=<span class="hljs-string">"false"</span>
            <span class="hljs-attr">iterations</span>=<span class="hljs-string">"1"</span>
        /&gt;</span>

        <span class="hljs-comment">&lt;!-- algorithm: the new hasher, along with its options --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"App\Entity\User"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"sodium"</span>
        &gt;</span>
            <span class="hljs-comment">&lt;!-- uses the bcrypt hasher with the default options --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">security:migrate-from</span>&gt;</span>bcrypt<span class="hljs-tag">&lt;/<span class="hljs-name">security:migrate-from</span>&gt;</span>

            <span class="hljs-comment">&lt;!-- uses the legacy hasher configured above --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">security:migrate-from</span>&gt;</span>legacy<span class="hljs-tag">&lt;/<span class="hljs-name">security:migrate-from</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">security:password-hasher</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">security:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-ba2ac53f84223ec599d8d2ba146b779c8b482dd7" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(<span class="hljs-string">'legacy'</span>)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'sha256'</span>)
        <span class="hljs-operator">-&gt;</span>encodeAsBase64(<span class="hljs-keyword">true</span>)
        <span class="hljs-operator">-&gt;</span>iterations(<span class="hljs-number">1</span>)
    ;

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(<span class="hljs-string">'App\Entity\User'</span>)
        <span class="hljs-comment">// the new hasher, along with its options</span>
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'sodium'</span>)
        <span class="hljs-operator">-&gt;</span>migrateFrom([
            <span class="hljs-string">'bcrypt'</span>, <span class="hljs-comment">// uses the "bcrypt" hasher with the default options</span>
            <span class="hljs-string">'legacy'</span>, <span class="hljs-comment">// uses the "legacy" hasher configured above</span>
        ])
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-fa9ae78c4db7c16d5a043b6522a0c0b132ff13e9" aria-label="Standalone Use" class="configuration-codeblock" data-language="php-standalone" style="display: none">
            <div translate="no" class="highlight-php-standalone highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-standalone php"><span class="hljs-comment">// ...</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasherFactory</span> = <span class="hljs-keyword">new</span> PasswordHasherFactory([
    <span class="hljs-string">'legacy'</span> =&gt; [
        <span class="hljs-string">'algorithm'</span> =&gt; <span class="hljs-string">'sha256'</span>,
        <span class="hljs-string">'encode_as_base64'</span> =&gt; <span class="hljs-keyword">true</span>,
        <span class="hljs-string">'iterations'</span> =&gt; <span class="hljs-number">1</span>,
    ],

    User<span class="hljs-operator">::</span>class =&gt; [
        <span class="hljs-comment">// the new hasher, along with its options</span>
        <span class="hljs-string">'algorithm'</span> =&gt; <span class="hljs-string">'sodium'</span>,
        <span class="hljs-string">'migrate_from'</span> =&gt; [
            <span class="hljs-string">'bcrypt'</span>, <span class="hljs-comment">// uses the "bcrypt" hasher with the default options</span>
            <span class="hljs-string">'legacy'</span>, <span class="hljs-comment">// uses the "legacy" hasher configured above</span>
        ],
    ],
]);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>With this setup:</p>
<ul>
    <li>New users will be hashed with the new algorithm;</li>
<li>Whenever a user logs in whose password is still stored using the old algorithm,
Symfony will verify the password with the old algorithm and then rehash
and update the password using the new algorithm.</li>
</ul>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>The <em>auto</em>, <em>native</em>, <em>bcrypt</em> and <em>argon</em> hashers automatically enable
password migration using the following list of <code translate="no" class="notranslate">migrate_from</code> algorithms:</p>
<ol class="arabic">
    <li><a href="passwords.html#reference-security-pbkdf2" class="reference internal">PBKDF2</a> (which uses <a href="https://secure.php.net/manual/en/function.hash-pbkdf2.php" class="reference external" title="hash_pbkdf2" rel="external noopener noreferrer" target="_blank">hash_pbkdf2</a>);</li>
<li>Message digest (which uses <a href="https://secure.php.net/manual/en/function.hash.php" class="reference external" title="hash" rel="external noopener noreferrer" target="_blank">hash</a>)</li>
</ol>
<p>Both use the <code translate="no" class="notranslate">hash_algorithm</code> setting as the algorithm. It is recommended to
use <code translate="no" class="notranslate">migrate_from</code> instead of <code translate="no" class="notranslate">hash_algorithm</code>, unless the <em>auto</em>
hasher is used.</p>
</div>
</div>
<div class="section">
<h3 id="upgrade-the-password">
    Upgrade the Password
    <a class="headerlink" href="#upgrade-the-password" title="Permalink to this headline">¶</a>
</h3>
<p>Upon successful login, the Security system checks whether a better algorithm
is available to hash the user's password. If it is, it'll hash the correct
password using the new hash. When using a custom authenticator, you must
use the <code translate="no" class="notranslate">PasswordCredentials</code> in the <a href="custom_authenticator.html#security-passport" class="reference internal">security passport</a>.</p>
<p>You can enable the upgrade behavior by implementing how this newly hashed
password should be stored:</p>
<ul>
    <li><a href="passwords.html#upgrade-the-password-doctrine" class="reference internal">When using Doctrine's entity user provider</a></li>
<li><a href="passwords.html#upgrade-the-password-custom-provider" class="reference internal">When using a custom user provider</a></li>
</ul>
<p>After this, you're done and passwords are always hashed as securely as possible!</p>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>When using the PasswordHasher component outside a Symfony application,
you must manually use the <code translate="no" class="notranslate">PasswordHasherInterface::needsRehash()</code>
method to check if a rehash is needed and <code translate="no" class="notranslate">PasswordHasherInterface::hash()</code>
method to rehash the plaintext password using the new algorithm.</p>
</div>
<span id="upgrade-the-password-doctrine"></span>
<div class="section">
<h4 id="upgrade-the-password-when-using-doctrine">
    Upgrade the Password when using Doctrine
    <a class="headerlink" href="#upgrade-the-password-when-using-doctrine" title="Permalink to this headline">¶</a>
</h4>
<p>When using the <a href="user_providers.html#security-entity-user-provider" class="reference internal">entity user provider</a>, implement
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/PasswordUpgraderInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\PasswordUpgraderInterface" rel="external noopener noreferrer" target="_blank">PasswordUpgraderInterface</a> in
the <code translate="no" class="notranslate">UserRepository</code> (see <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/current/reference/working-with-objects.html#custom-repositories" class="reference external" rel="external noopener noreferrer" target="_blank">the Doctrine docs for information</a> on how to
create this class if it's not already created). This interface implements
storing the newly created password hash:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Repository/UserRepository.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Repository</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordUpgraderInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EntityRepository</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PasswordUpgraderInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upgradePassword</span><span class="hljs-params">(PasswordAuthenticatedUserInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>newHashedPassword</span>)</span>: <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// set the new hashed password on the User object</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>setPassword(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>newHashedPassword</span>);

        <span class="hljs-comment">// execute the queries on the database</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>getEntityManager()<span class="hljs-operator">-&gt;</span>flush();
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="upgrade-the-password-custom-provider"></span>
</div>
<div class="section">
<h4 id="upgrade-the-password-when-using-a-custom-user-provider">
    Upgrade the Password when using a Custom User Provider
    <a class="headerlink" href="#upgrade-the-password-when-using-a-custom-user-provider" title="Permalink to this headline">¶</a>
</h4>
<p>If you're using a <a href="user_providers.html#security-custom-user-provider" class="reference internal">custom user provider</a>, implement the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/PasswordUpgraderInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\PasswordUpgraderInterface" rel="external noopener noreferrer" target="_blank">PasswordUpgraderInterface</a> in
the user provider:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Security/UserProvider.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordUpgraderInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProvider</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserProviderInterface</span>, <span class="hljs-title">PasswordUpgraderInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upgradePassword</span><span class="hljs-params">(UserInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>newHashedPassword</span>)</span>: <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// set the new hashed password on the User object</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>setPassword(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>newHashedPassword</span>);

        <span class="hljs-comment">// ... store the new password</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
</div>
<div class="section">
<h3 id="trigger-password-migration-from-a-custom-hasher">
    Trigger Password Migration From a Custom Hasher
    <a class="headerlink" href="#trigger-password-migration-from-a-custom-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>If you're using a custom password hasher, you can trigger the password
migration by returning <code translate="no" class="notranslate">true</code> in the <code translate="no" class="notranslate">needsRehash()</code> method:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Security/CustomPasswordHasher.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">UserPasswordHasherInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomPasswordHasher</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserPasswordHasherInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">needsRehash</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashed</span>)</span>: <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// check whether the current password is hashed using an outdated hasher</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashIsOutdated</span> = ...;

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashIsOutdated</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="named-password-hashers"></span>
</div>
</div>
<div class="section">
<h2 id="dynamic-password-hashers">
    Dynamic Password Hashers
    <a class="headerlink" href="#dynamic-password-hashers" title="Permalink to this headline">¶</a>
</h2>
<p>Usually, the same password hasher is used for all users by configuring it
to apply to all instances of a specific class. Another option is to use a
&quot;named&quot; hasher and then select which hasher you want to use dynamically.</p>
<p>By default (as shown at the start of the article), the <code translate="no" class="notranslate">auto</code> algorithm
is used for <code translate="no" class="notranslate">App\Entity\User</code>.</p>
<p>This may be secure enough for a regular user, but what if you want your
admins to have a stronger algorithm, for example <code translate="no" class="notranslate">auto</code> with a higher
cost. This can be done with named hashers:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-4">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-97f989b601c2d97f99a67da25b692af72f1ede24" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-15b129a386a3e45d0ee2886fb1fc470c4761b109" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-35edd63381377e5197866c8a788d3778042a0ad1" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
                    <button role="tab" type="button" data-language="php-standalone"
                aria-controls="configuration-block-tabpanel-98fcffdfe49de63d15451286119a7440f86fd01c" aria-selected="false"
                 tabindex="-1">
                <span>Standalone Use</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-97f989b601c2d97f99a67da25b692af72f1ede24" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-attr">harsh:</span>
            <span class="hljs-attr">algorithm:</span> <span class="hljs-string">auto</span>
            <span class="hljs-attr">cost:</span> <span class="hljs-number">15</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-15b129a386a3e45d0ee2886fb1fc470c4761b109" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>
&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password-hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"harsh"</span>
            <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"auto"</span>
            <span class="hljs-attr">cost</span>=<span class="hljs-string">"15"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-35edd63381377e5197866c8a788d3778042a0ad1" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(<span class="hljs-string">'harsh'</span>)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'auto'</span>)
        <span class="hljs-operator">-&gt;</span>cost(<span class="hljs-number">15</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-98fcffdfe49de63d15451286119a7440f86fd01c" aria-label="Standalone Use" class="configuration-codeblock" data-language="php-standalone" style="display: none">
            <div translate="no" class="highlight-php-standalone highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-standalone php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">PasswordHasherFactory</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasherFactory</span> = <span class="hljs-keyword">new</span> PasswordHasherFactory([
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'harsh'</span> =&gt; [
        <span class="hljs-string">'algorithm'</span> =&gt; <span class="hljs-string">'auto'</span>,
        <span class="hljs-string">'cost'</span> =&gt; <span class="hljs-number">15</span>
    ],
]);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>This creates a hasher named <code translate="no" class="notranslate">harsh</code>. In order for a <code translate="no" class="notranslate">User</code> instance
to use it, the class must implement
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/Hasher/PasswordHasherAwareInterface.php" class="reference external" title="Symfony\Component\PasswordHasher\Hasher\PasswordHasherAwareInterface" rel="external noopener noreferrer" target="_blank">PasswordHasherAwareInterface</a>.
The interface requires one method - <code translate="no" class="notranslate">getPasswordHasherName()</code> - which should return
the name of the hasher to use:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/User.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">PasswordHasherAwareInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">UserInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">implements</span>
    <span class="hljs-title">UserInterface</span>,
    <span class="hljs-title">PasswordAuthenticatedUserInterface</span>,
    <span class="hljs-title">PasswordHasherAwareInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPasswordHasherName</span><span class="hljs-params">()</span>: ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>isAdmin()) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'harsh'</span>;
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// use the default hasher</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>When <a href="passwords.html#security-password-migration" class="reference internal">migrating passwords</a>, you don't
need to implement <code translate="no" class="notranslate">PasswordHasherAwareInterface</code> to return the legacy
hasher name: Symfony will detect it from your <code translate="no" class="notranslate">migrate_from</code> configuration.</p>
</div>
<p>If you created your own password hasher implementing the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/PasswordHasherInterface.php" class="reference external" title="Symfony\Component\PasswordHasher\PasswordHasherInterface" rel="external noopener noreferrer" target="_blank">PasswordHasherInterface</a>,
you must register a service for it in order to use it as a named hasher:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-4b8b328b4a7f804252e9bfcac462e7e2321e46d2" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-8ecc085fef7febbec0a9e0b67a2b86856a2de15e" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-dc13fcb1fb1e3b5ebba51ec06ce67a8c31544828" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-4b8b328b4a7f804252e9bfcac462e7e2321e46d2" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-attr">app_hasher:</span>
            <span class="hljs-attr">id:</span> <span class="hljs-string">'App\Security\Hasher\MyCustomPasswordHasher'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-8ecc085fef7febbec0a9e0b67a2b86856a2de15e" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>
&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password_hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app_hasher"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"App\Security\Hasher\MyCustomPasswordHasher"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-dc13fcb1fb1e3b5ebba51ec06ce67a8c31544828" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">MyCustomPasswordHasher</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(<span class="hljs-string">'app_hasher'</span>)
        <span class="hljs-operator">-&gt;</span>id(MyCustomPasswordHasher<span class="hljs-operator">::</span>class)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>This creates a hasher named <code translate="no" class="notranslate">app_hasher</code> from a service with the ID
<code translate="no" class="notranslate">App\Security\Hasher\MyCustomPasswordHasher</code>.</p>
<span id="passwordhasher-supported-algorithms"></span>
</div>
<div class="section">
<h2 id="supported-algorithms">
    Supported Algorithms
    <a class="headerlink" href="#supported-algorithms" title="Permalink to this headline">¶</a>
</h2>
<ul>
    <li><a href="passwords.html#reference-security-encoder-auto" class="reference internal">auto</a></li>
<li><a href="passwords.html#reference-security-encoder-bcrypt" class="reference internal">bcrypt</a></li>
<li><a href="passwords.html#reference-security-sodium" class="reference internal">sodium</a></li>
<li><a href="passwords.html#reference-security-pbkdf2" class="reference internal">PBKDF2</a></li>
<li><a href="passwords.html#custom-password-hasher" class="reference internal">Or create a custom password hasher</a></li>
</ul>
<span id="reference-security-encoder-auto"></span>
<div class="section">
<h3 id="the-auto-hasher">
    The &quot;auto&quot;  Hasher
    <a class="headerlink" href="#the-auto-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>It automatically selects the best available hasher (currently Bcrypt). If
PHP or Symfony adds new password hashers in the future, it might select a
different hasher.</p>
<p>Because of this, the length of the hashed passwords may change in the future, so
make sure to allocate enough space for them to be persisted (<code translate="no" class="notranslate">varchar(255)</code>
should be a good setting).</p>
<span id="reference-security-encoder-bcrypt"></span>
</div>
<div class="section">
<h3 id="the-bcrypt-password-hasher">
    The Bcrypt Password Hasher
    <a class="headerlink" href="#the-bcrypt-password-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>It produces hashed passwords with the <a href="https://en.wikipedia.org/wiki/Bcrypt" class="reference external" rel="external noopener noreferrer" target="_blank">bcrypt password hashing function</a>.
Hashed passwords are <code translate="no" class="notranslate">60</code> characters long, so make sure to
allocate enough space for them to be persisted. Also, passwords include the
<a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="reference external" rel="external noopener noreferrer" target="_blank">cryptographic salt</a> inside them (it's generated automatically for each new
password) so you don't have to deal with it.</p>
<p>Its only configuration option is <code translate="no" class="notranslate">cost</code>, which is an integer in the range of
<code translate="no" class="notranslate">4-31</code> (by default, <code translate="no" class="notranslate">13</code>). Each single increment of the cost <strong>doubles the
time</strong> it takes to hash a password. It's designed this way so the password
strength can be adapted to the future improvements in computation power.</p>
<p>You can change the cost at any time — even if you already have some passwords
hashed using a different cost. New passwords will be hashed using the new
cost, while the already hashed ones will be validated using a cost that was
used back when they were hashed.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>A simple technique to make tests much faster when using BCrypt is to set
the cost to <code translate="no" class="notranslate">4</code>, which is the minimum value allowed, in the <code translate="no" class="notranslate">test</code>
environment configuration.</p>
</div>
<span id="reference-security-sodium"></span>
</div>
<div class="section">
<h3 id="the-sodium-password-hasher">
    The Sodium Password Hasher
    <a class="headerlink" href="#the-sodium-password-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>It uses the <a href="https://en.wikipedia.org/wiki/Argon2" class="reference external" rel="external noopener noreferrer" target="_blank">Argon2 key derivation function</a>. Argon2 support was introduced
in PHP 7.2 by bundling the <a href="https://pecl.php.net/package/libsodium" class="reference external" rel="external noopener noreferrer" target="_blank">libsodium</a> extension.</p>
<p>The hashed passwords are <code translate="no" class="notranslate">96</code> characters long, but due to the hashing
requirements saved in the resulting hash this may change in the future, so make
sure to allocate enough space for them to be persisted. Also, passwords include
the <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="reference external" rel="external noopener noreferrer" target="_blank">cryptographic salt</a> inside them (it's generated automatically for each new
password) so you don't have to deal with it.</p>
<span id="reference-security-pbkdf2"></span>
</div>
<div class="section">
<h3 id="the-pbkdf2-hasher">
    The PBKDF2 Hasher
    <a class="headerlink" href="#the-pbkdf2-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>Using the <a href="https://en.wikipedia.org/wiki/PBKDF2" class="reference external" rel="external noopener noreferrer" target="_blank">PBKDF2</a> hasher is no longer recommended since PHP added support for
Sodium and BCrypt. Legacy application still using it are encouraged to upgrade
to those newer hashing algorithms.</p>
<span id="custom-password-hasher"></span>
</div>
<div class="section">
<h3 id="creating-a-custom-password-hasher">
    Creating a custom Password Hasher
    <a class="headerlink" href="#creating-a-custom-password-hasher" title="Permalink to this headline">¶</a>
</h3>
<p>If you need to create your own, it needs to follow these rules:</p>
<ol class="arabic">
    <li>The class must implement <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/PasswordHasherInterface.php" class="reference external" title="Symfony\Component\PasswordHasher\PasswordHasherInterface" rel="external noopener noreferrer" target="_blank">PasswordHasherInterface</a>
(you can also implement <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/LegacyPasswordHasherInterface.php" class="reference external" title="Symfony\Component\PasswordHasher\LegacyPasswordHasherInterface" rel="external noopener noreferrer" target="_blank">LegacyPasswordHasherInterface</a> if your hash algorithm uses a separate salt);</li>
<li><p>The implementations of
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/PasswordHasherInterface.php#method_hash" class="reference external" title="Symfony\Component\PasswordHasher\PasswordHasherInterface::hash()" rel="external noopener noreferrer" target="_blank">hash()</a>
and <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/PasswordHasherInterface.php#method_verify" class="reference external" title="Symfony\Component\PasswordHasher\PasswordHasherInterface::verify()" rel="external noopener noreferrer" target="_blank">verify()</a>
<strong>must validate that the password length is no longer than 4096
characters.</strong> This is for security reasons (see <a href="https://symfony.com/blog/cve-2013-5750-security-issue-in-fosuserbundle-login-form" class="reference external">CVE-2013-5750</a>).</p>
<p>You can use the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/PasswordHasher/Hasher/CheckPasswordLengthTrait.php#method_isPasswordTooLong" class="reference external" title="Symfony\Component\PasswordHasher\Hasher\CheckPasswordLengthTrait::isPasswordTooLong()" rel="external noopener noreferrer" target="_blank">isPasswordTooLong()</a>
method for this check.</p></li>
</ol>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Security/Hasher/CustomVerySecureHasher.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Hasher</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Exception</span>\<span class="hljs-title">InvalidPasswordException</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">CheckPasswordLengthTrait</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">PasswordHasherInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomVerySecureHasher</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PasswordHasherInterface</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">CheckPasswordLengthTrait</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hash</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plainPassword</span>)</span>: <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>isPasswordTooLong(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plainPassword</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidPasswordException();
        }

        <span class="hljs-comment">// ... hash the plain password in a secure way</span>

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>, string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plainPassword</span>)</span>: <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-string">''</span> === <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plainPassword</span> || <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>isPasswordTooLong(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plainPassword</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }

        <span class="hljs-comment">// ... validate if the password equals the user's password in a secure way</span>

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordIsValid</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">needsRehash</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>)</span>: <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// Check if a password hash would benefit from rehashing</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>needsRehash</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Now, define a password hasher using the <code translate="no" class="notranslate">id</code> setting:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-4be598fdfb5863b15c3c8480a96c8bd4dd765860" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-865615a2a090c731a3aa7b51e3f073619b867609" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-7230a6f5bb0eb56526e8e5fea7230753fad99fdc" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-4be598fdfb5863b15c3c8480a96c8bd4dd765860" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-attr">app_hasher:</span>
            <span class="hljs-comment"># the service ID of your custom hasher (the FQCN using the default services.yaml)</span>
            <span class="hljs-attr">id:</span> <span class="hljs-string">'App\Security\Hasher\MyCustomPasswordHasher'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-865615a2a090c731a3aa7b51e3f073619b867609" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>
&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-comment">&lt;!-- id: the service ID of your custom hasher (the FQCN using the default services.yaml) --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">security:password_hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app_hasher"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"App\Security\Hasher\CustomVerySecureHasher"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-7230a6f5bb0eb56526e8e5fea7230753fad99fdc" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">CustomVerySecureHasher</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(<span class="hljs-string">'app_hasher'</span>)
        <span class="hljs-comment">// the service ID of your custom hasher (the FQCN using the default services.yaml)</span>
        <span class="hljs-operator">-&gt;</span>id(CustomVerySecureHasher<span class="hljs-operator">::</span>class)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
</div>
</div>

                            </div>                    </div>
                                    </div>        </div>

    </section>

</div>


<script type="text/javascript" src="assets/js/theme.js"></script>
<script type="text/javascript" src="assets/js/badge_only.js"></script>

 
</body>
</html>