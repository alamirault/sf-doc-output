        
<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head><base href="/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
                                
    
    <link rel="stylesheet" href="assets/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/badge_only.css" type="text/css" />

</head>

<body class="wy-body-for-nav">
 <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">
                
                                                                                                    
                                                                                                                                                                        </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                                                                                                                                                                                                                                                                                                                            </div>
        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                                                        

        <div class="wy-nav-content">                <div class="rst-content">
                                        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">                            <div itemprop="articleBody">
                                    <div class="section">
<h1 id="security">
    Security
    <a class="headerlink" href="#security" title="Permalink to this headline">¶</a>
</h1>
<p>Symfony provides many tools to secure your application. Some HTTP-related
security tools, like <a href="session.html" class="reference internal">secure session cookies</a> and
<a href="security/csrf.html" class="reference internal">CSRF protection</a> are provided by default. The
SecurityBundle, which you will learn about in this guide, provides all
authentication and authorization features needed to secure your
application.</p>
<span id="security-installation"></span>
<p>To get started, install the SecurityBundle:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfony/security-bundle</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>If you have <a href="setup.html#symfony-flex" class="reference internal">Symfony Flex</a> installed, this also
creates a <code translate="no" class="notranslate">security.yaml</code> configuration file for you:</p>
<div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># https://symfony.com/doc/current/security.html#registering-the-user-hashing-passwords</span>
    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-string">Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:</span> <span class="hljs-string">'auto'</span>
    <span class="hljs-comment"># https://symfony.com/doc/current/security.html#where-do-users-come-from-user-providers</span>
    <span class="hljs-attr">providers:</span>
        <span class="hljs-attr">users_in_memory:</span> <span class="hljs-string">{</span> <span class="hljs-attr">memory:</span> <span class="hljs-literal">null</span> <span class="hljs-string">}</span>
    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">dev:</span>
            <span class="hljs-attr">pattern:</span> <span class="hljs-string">^/(_(profiler|wdt)|css|images|js)/</span>
            <span class="hljs-attr">security:</span> <span class="hljs-literal">false</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-attr">lazy:</span> <span class="hljs-literal">true</span>
            <span class="hljs-attr">provider:</span> <span class="hljs-string">users_in_memory</span>

            <span class="hljs-comment"># activate different ways to authenticate</span>
            <span class="hljs-comment"># https://symfony.com/doc/current/security.html#firewalls-authentication</span>

            <span class="hljs-comment"># https://symfony.com/doc/current/security/impersonating_user.html</span>
            <span class="hljs-comment"># switch_user: true</span>

    <span class="hljs-comment"># Easy way to control access for large sections of your site</span>
    <span class="hljs-comment"># <span class="hljs-doctag">Note:</span> Only the *first* access control that matches will be used</span>
    <span class="hljs-attr">access_control:</span>
        <span class="hljs-comment"># - { path: ^/admin, roles: ROLE_ADMIN }</span>
        <span class="hljs-comment"># - { path: ^/profile, roles: ROLE_USER }</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>That's a lot of config! In the next sections, the three main elements are
discussed:</p>
<dl>
                        <dt><a href="security.html#the-user" class="reference internal">The User</a> (<code translate="no" class="notranslate">providers</code>)</dt>
        
        <dd>
                            Any secured section of your application needs some concept of
a user. The user provider loads users from any storage (e.g. the
database) based on a &quot;user identifier&quot; (e.g. the user's email address);
                    </dd>
                        <dt><a href="security.html#the-firewall" class="reference internal">The Firewall</a> &amp; <a href="security.html#authenticating-users" class="reference internal">Authenticating Users</a> (<code translate="no" class="notranslate">firewalls</code>)</dt>
        
        <dd>
                            The firewall is the core of securing your application. Every request
within the firewall is checked if it needs an authenticated user. The
firewall also takes care of authenticating this user (e.g. using a
login form);
                    </dd>
                        <dt><a href="security.html#access-control-authorization" class="reference internal">Access Control (Authorization)</a> (<code translate="no" class="notranslate">access_control</code>)</dt>
        
        <dd>
                            Using access control and the authorization checker, you control the
required permissions to perform a specific action or visit a specific
URL.
                    </dd>
    </dl>
<span id="create-user-class"></span>
<span id="a-create-your-user-class"></span>
<div class="section">
<h2 id="the-user">
    The User
    <a class="headerlink" href="#the-user" title="Permalink to this headline">¶</a>
</h2>
<p>Permissions in Symfony are always linked to a user object. If you need to
secure (parts of) your application, you need to create a user class. This
is a class that implements <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/UserInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\UserInterface" rel="external noopener noreferrer" target="_blank">UserInterface</a>.
This is often a Doctrine entity, but you can also use a dedicated
Security user class.</p>
<p>The easiest way to generate a user class is using the <code translate="no" class="notranslate">make:user</code> command
from the <a href="https://symfony.com/doc/current/bundles/SymfonyMakerBundle/index.html" class="reference external">MakerBundle</a>:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console make:user
 The name of the security user class (e.g. User) [User]:
 &gt; User

 Do you want to store user data <span class="hljs-keyword">in</span> the database (via Doctrine)? (yes/no) [yes]:
 &gt; yes

 Enter a property name that will be the unique <span class="hljs-string">"display"</span> name <span class="hljs-keyword">for</span> the user (e.g. email, username, uuid) [email]:
 &gt; email

 Will this app need to <span class="hljs-built_in">hash</span>/check user passwords? Choose No <span class="hljs-keyword">if</span> passwords are not needed or will be checked/hashed by some other system (e.g. a single sign-on server).

 Does this app need to <span class="hljs-built_in">hash</span>/check user passwords? (yes/no) [yes]:
 &gt; yes

 created: src/Entity/User.php
 created: src/Repository/UserRepository.php
 updated: src/Entity/User.php
 updated: config/packages/security.yaml</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/User.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Repository</span>\<span class="hljs-title">UserRepository</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">UserInterface</span>;

<span class="hljs-comment">#[ORM\Entity(repositoryClass: UserRepository::class)]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserInterface</span>, <span class="hljs-title">PasswordAuthenticatedUserInterface</span>
</span>{
    <span class="hljs-comment">#[ORM\Id]</span>
    <span class="hljs-comment">#[ORM\GeneratedValue]</span>
    <span class="hljs-comment">#[ORM\Column(type: 'integer')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>id</span>;

    <span class="hljs-comment">#[ORM\Column(type: 'string', length: 180, unique: true)]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>;

    <span class="hljs-comment">#[ORM\Column(type: 'json')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span> = [];

    <span class="hljs-comment">#[ORM\Column(type: 'string')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>password</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getId</span><span class="hljs-params">()</span>: ?<span class="hljs-title">int</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEmail</span><span class="hljs-params">()</span>: ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>email;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setEmail</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>email = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>;

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }

    <span class="hljs-comment">/**
     * The public representation of the user (e.g. a username, an email address, etc.)
     *
     * <span class="hljs-doctag">@see</span> UserInterface
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserIdentifier</span><span class="hljs-params">()</span>: <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> (string) <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>email;
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@see</span> UserInterface
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRoles</span><span class="hljs-params">()</span>: <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>roles;
        <span class="hljs-comment">// guarantee every user at least has ROLE_USER</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>[] = <span class="hljs-string">'ROLE_USER'</span>;

        <span class="hljs-keyword">return</span> array_unique(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setRoles</span><span class="hljs-params">(array <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>roles = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>;

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@see</span> PasswordAuthenticatedUserInterface
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPassword</span><span class="hljs-params">()</span>: <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>password;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPassword</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>password</span>)</span>: <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>password = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>password</span>;

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span>;
    }

    <span class="hljs-comment">/**
     * Returning a salt is only needed if you are not using a modern
     * hashing algorithm (e.g. bcrypt or sodium) in your security.yaml.
     *
     * <span class="hljs-doctag">@see</span> UserInterface
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSalt</span><span class="hljs-params">()</span>: ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@see</span> UserInterface
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eraseCredentials</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// If you store any temporary, sensitive data on the user, clear it here</span>
        <span class="hljs-comment">// $this-&gt;plainPassword = null;</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>If your user is a Doctrine entity, like in the example above, don't forget
to create the tables by <a href="doctrine.html#doctrine-creating-the-database-tables-schema" class="reference internal">creating and running a migration</a>:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console make:migration
<span class="hljs-prompt">$ </span>php bin/console doctrine:migrations:migrate</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="where-do-users-come-from-user-providers"></span>
<span id="security-user-providers"></span>
<div class="section">
<h3 id="loading-the-user-the-user-provider">
    Loading the User: The User Provider
    <a class="headerlink" href="#loading-the-user-the-user-provider" title="Permalink to this headline">¶</a>
</h3>
<p>Besides creating the entity, the <code translate="no" class="notranslate">make:user</code> command also adds config
for a user provider in your security configuration:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-0ae167e3785e381ea0383ec20efd08c4a54f6b51" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-dc7072ef21fdbb4fc4794e587de34e689f6008ae" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-c3ac4c7dd058b6168c25d168041d2aca3fd1b30b" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-0ae167e3785e381ea0383ec20efd08c4a54f6b51" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">providers:</span>
        <span class="hljs-attr">app_user_provider:</span>
            <span class="hljs-attr">entity:</span>
                <span class="hljs-attr">class:</span> <span class="hljs-string">App\Entity\User</span>
                <span class="hljs-attr">property:</span> <span class="hljs-string">email</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-dc7072ef21fdbb4fc4794e587de34e689f6008ae" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">provider</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"app_user_provider"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"App\Entity\User"</span> <span class="hljs-attr">property</span>=<span class="hljs-string">"email"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-c3ac4c7dd058b6168c25d168041d2aca3fd1b30b" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">User</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>provider(<span class="hljs-string">'app_user_provider'</span>)
        <span class="hljs-operator">-&gt;</span>entity()
            <span class="hljs-operator">-&gt;</span>class(User<span class="hljs-operator">::</span>class)
            <span class="hljs-operator">-&gt;</span>property(<span class="hljs-string">'email'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>This user provider knows how to (re)load users from a storage (e.g. a database)
based on a &quot;user identifier&quot; (e.g. the user's email address or username).
The configuration above uses Doctrine to load the <code translate="no" class="notranslate">User</code> entity using the
<code translate="no" class="notranslate">email</code> property as &quot;user identifier&quot;.</p>
<p>User providers are used in a couple places during the security lifecycle:</p>
<dl>
                        <dt><strong>Load the User based on an identifier</strong></dt>
        
        <dd>
                            During login (or any other authenticator), the provider loads the user
based on the user identifier. Some other features, like
<a href="security/impersonating_user.html" class="reference internal">user impersonation</a> and
<a href="security/remember_me.html" class="reference internal">Remember Me</a> also use this.
                    </dd>
                        <dt><strong>Reload the User from the session</strong></dt>
        
        <dd>
                            At the beginning of each request, the user is loaded from the
session (unless your firewall is <code translate="no" class="notranslate">stateless</code>). The provider
&quot;refreshes&quot; the user (e.g. the database is queried again for fresh
data) to make sure all user information is up to date (and if
necessary, the user is de-authenticated/logged out if something
changed). See <a href="security.html#user_session_refresh" class="reference internal">Security</a> for more information about
this process.
                    </dd>
    </dl>
<p>Symfony comes with several built-in user providers:</p>
<dl>
                        <dt><a href="security/user_providers.html#security-entity-user-provider" class="reference internal">Entity User Provider</a></dt>
        
        <dd>
                            Loads users from a database using <a href="doctrine.html" class="reference internal">Doctrine</a>;
                    </dd>
                        <dt><a href="security/ldap.html#security-ldap-user-provider" class="reference internal">LDAP User Provider</a></dt>
        
        <dd>
                            Loads users from a LDAP server;
                    </dd>
                        <dt><a href="security/user_providers.html#security-memory-user-provider" class="reference internal">Memory User Provider</a></dt>
        
        <dd>
                            Loads users from a configuration file;
                    </dd>
                        <dt><a href="security/user_providers.html#security-chain-user-provider" class="reference internal">Chain User Provider</a></dt>
        
        <dd>
                            Merges two or more user providers into a new user provider.
Since each firewall has exactly <em>one</em> user provider, you can use this
to chain multiple providers together.
                    </dd>
    </dl>
<p>The built-in user providers cover the most common needs for applications, but you
can also create your own <a href="security/user_providers.html#security-custom-user-provider" class="reference internal">custom user provider</a>.</p>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>Sometimes, you need to inject the user provider in another class (e.g.
in your custom authenticator). All user providers follow this pattern
for their service ID: <code translate="no" class="notranslate">security.user.provider.concrete.&lt;your-provider-name&gt;</code>
(where <code translate="no" class="notranslate">&lt;your-provider-name&gt;</code> is the configuration key, e.g.
<code translate="no" class="notranslate">app_user_provider</code>). If you only have one user provider, you can autowire
it using the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/UserProviderInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\UserProviderInterface" rel="external noopener noreferrer" target="_blank">UserProviderInterface</a>
type-hint.</p>
</div>
<span id="security-encoding-user-password"></span>
</div>
<div class="section">
<h3 id="registering-the-user-hashing-passwords">
    Registering the User: Hashing Passwords
    <a class="headerlink" href="#registering-the-user-hashing-passwords" title="Permalink to this headline">¶</a>
</h3>
<p>Many applications require a user to log in with a password. For these
applications, the SecurityBundle provides password hashing and verification
functionality.</p>
<p>First, make sure your User class implements the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/PasswordAuthenticatedUserInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface" rel="external noopener noreferrer" target="_blank">PasswordAuthenticatedUserInterface</a>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/User.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserInterface</span>, <span class="hljs-title">PasswordAuthenticatedUserInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string the hashed password for this user
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPassword</span><span class="hljs-params">()</span>: <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>password;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Then, configure which password hasher should be used for this class. If your
<code translate="no" class="notranslate">security.yaml</code> file wasn't already pre-configured, then <code translate="no" class="notranslate">make:user</code> should
have done this for you:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-318065312b55ceb1d24a23ddcd313ddef6df4128" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-21f55a15efb7dd78d23486224c9a9b18937e69ab" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-1bae063784975b86d6c540cf4a5ad82c982a6731" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-318065312b55ceb1d24a23ddcd313ddef6df4128" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">password_hashers:</span>
        <span class="hljs-comment"># Use native password hasher, which auto-selects and migrates the best</span>
        <span class="hljs-comment"># possible hashing algorithm (which currently is "bcrypt")</span>
        <span class="hljs-string">Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:</span> <span class="hljs-string">'auto'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-21f55a15efb7dd78d23486224c9a9b18937e69ab" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-comment">&lt;!-- Use native password hasher, which auto-selects and migrates the best
             possible hashing algorithm (currently this is "bcrypt") --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">password-hasher</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface"</span> <span class="hljs-attr">algorithm</span>=<span class="hljs-string">"auto"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-1bae063784975b86d6c540cf4a5ad82c982a6731" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">User</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">User</span>\<span class="hljs-title">PasswordAuthenticatedUserInterface</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// Use native password hasher, which auto-selects and migrates the best</span>
    <span class="hljs-comment">// possible hashing algorithm (currently this is "bcrypt")</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>passwordHasher(PasswordAuthenticatedUserInterface<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>algorithm(<span class="hljs-string">'auto'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Now that Symfony knows <em>how</em> you want to hash the passwords, you can use the
<code translate="no" class="notranslate">UserPasswordHasherInterface</code> service to do this before saving your users to
the database:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/RegistrationController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">PasswordHasher</span>\<span class="hljs-title">Hasher</span>\<span class="hljs-title">UserPasswordHasherInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegistrationController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">(UserPasswordHasherInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span>)</span>
    </span>{
        <span class="hljs-comment">// ... e.g. get the user data from a registration form</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = <span class="hljs-keyword">new</span> User(...);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span> = ...;

        <span class="hljs-comment">// hash the password (based on the security.yaml config for the $user class)</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>passwordHasher</span><span class="hljs-operator">-&gt;</span>hashPassword(
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>,
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>plaintextPassword</span>
        );
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>setPassword(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hashedPassword</span>);

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>The <code translate="no" class="notranslate">make:registration-form</code> maker command can help you set-up the
registration controller and add features like email address
verification using the <a href="https://github.com/symfonycasts/verify-email-bundle" class="reference external" rel="external noopener noreferrer" target="_blank">SymfonyCastsVerifyEmailBundle</a>.</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfonycasts/verify-email-bundle
<span class="hljs-prompt">$ </span>php bin/console make:registration-form</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<p>You can also manually hash a password by running:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console security:<span class="hljs-built_in">hash</span>-password</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Read more about all available hashers and password migration in
<a href="security/passwords.html" class="reference internal">Password Hashing and Verification</a>.</p>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>In applications using Symfony 6.2 and PHP 8.2 or newer, the
<a href="https://wiki.php.net/rfc/redact_parameters_in_back_traces" class="reference external" rel="external noopener noreferrer" target="_blank">SensitiveParameter PHP attribute</a> is applied to all plain passwords and
sensitive tokens so they don't appear in stack traces.</p>
</div>
<span id="firewalls-authentication"></span>
<span id="a-authentication-firewalls"></span>
</div>
</div>
<div class="section">
<h2 id="the-firewall">
    The Firewall
    <a class="headerlink" href="#the-firewall" title="Permalink to this headline">¶</a>
</h2>
<p>The <code translate="no" class="notranslate">firewalls</code> section of <code translate="no" class="notranslate">config/packages/security.yaml</code> is the <em>most</em>
important section. A &quot;firewall&quot; is your authentication system: the firewall
defines which parts of your application are secured and <em>how</em> your users
will be able to authenticate (e.g. login form, API token, etc).</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-1d951814207b37a4626656de84b4cdc77f1c9dfd" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-3b1f1e10b9ba5b10693f7aeb539db7dac428f8f3" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-604b582178af8775766916506fa335e6eeb308b9" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-1d951814207b37a4626656de84b4cdc77f1c9dfd" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">dev:</span>
            <span class="hljs-attr">pattern:</span> <span class="hljs-string">^/(_(profiler|wdt)|css|images|js)/</span>
            <span class="hljs-attr">security:</span> <span class="hljs-literal">false</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-attr">lazy:</span> <span class="hljs-literal">true</span>
            <span class="hljs-comment"># provider that you set earlier inside providers</span>
            <span class="hljs-attr">provider:</span> <span class="hljs-string">app_user_provider</span>

            <span class="hljs-comment"># activate different ways to authenticate</span>
            <span class="hljs-comment"># https://symfony.com/doc/current/security.html#firewalls-authentication</span>

            <span class="hljs-comment"># https://symfony.com/doc/current/security/impersonating_user.html</span>
            <span class="hljs-comment"># switch_user: true</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3b1f1e10b9ba5b10693f7aeb539db7dac428f8f3" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dev"</span>
            <span class="hljs-attr">pattern</span>=<span class="hljs-string">"^/(_(profiler|wdt)|css|images|js)/"</span>
            <span class="hljs-attr">security</span>=<span class="hljs-string">"false"</span>/&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>
            <span class="hljs-attr">lazy</span>=<span class="hljs-string">"true"</span>/&gt;</span>

        <span class="hljs-comment">&lt;!-- activate different ways to authenticate
             https://symfony.com/doc/current/security.html#firewalls-authentication --&gt;</span>

        <span class="hljs-comment">&lt;!-- https://symfony.com/doc/current/security/impersonating_user.html --&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;switch-user/&gt; --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-604b582178af8775766916506fa335e6eeb308b9" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'dev'</span>)
        <span class="hljs-operator">-&gt;</span>pattern(<span class="hljs-string">'^/(_(profiler|wdt)|css|images|js)/'</span>)
        <span class="hljs-operator">-&gt;</span>security(<span class="hljs-keyword">false</span>)
    ;

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>)
        <span class="hljs-operator">-&gt;</span>lazy(<span class="hljs-keyword">true</span>)

        <span class="hljs-comment">// activate different ways to authenticate</span>
        <span class="hljs-comment">// https://symfony.com/doc/current/security.html#firewalls-authentication</span>

        <span class="hljs-comment">// https://symfony.com/doc/current/security/impersonating_user.html</span>
        <span class="hljs-comment">// -&gt;switchUser(true)</span>
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Only one firewall is active on each request: Symfony uses the <code translate="no" class="notranslate">pattern</code> key
to find the first match (you can also
<a href="security/firewall_restriction.html" class="reference internal">match by host or other things</a>).</p>
<p>The <code translate="no" class="notranslate">dev</code> firewall is really a fake firewall: it makes sure that you
don't accidentally block Symfony's dev tools - which live under URLs like
<code translate="no" class="notranslate">/_profiler</code> and <code translate="no" class="notranslate">/_wdt</code>.</p>
<p>All <em>real</em> URLs are handled by the <code translate="no" class="notranslate">main</code> firewall (no <code translate="no" class="notranslate">pattern</code> key means
it matches <em>all</em> URLs). A firewall can have many modes of authentication,
in other words, it enables many ways to ask the question &quot;Who are you?&quot;.</p>
<p>Often, the user is unknown (i.e. not logged in) when they first visit your
website. If you visit your homepage right now, you <em>will</em> have access and
you'll see that you're visiting a page behind the firewall in the toolbar:</p>
<img src="_images/anonymous_wdt.png" align="center" />
<p>Visiting a URL under a firewall doesn't necessarily require you to be authenticated
(e.g. the login form has to be accessible or some parts of your application
are public). You'll learn how to restrict access to URLs, controllers or
anything else within your firewall in the <a href="security.html#security-access-control" class="reference internal">access control</a> section.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>The <code translate="no" class="notranslate">lazy</code> anonymous mode prevents the session from being started if
there is no need for authorization (i.e. explicit check for a user
privilege). This is important to keep requests cacheable (see
<a href="http_cache.html" class="reference internal">HTTP Cache</a>).</p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>If you do not see the toolbar, install the <a href="profiler.html" class="reference internal">profiler</a>
with:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require --dev symfony/profiler-pack</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="fetching-the-firewall-configuration-for-a-request">
    Fetching the Firewall Configuration for a Request
    <a class="headerlink" href="#fetching-the-firewall-configuration-for-a-request" title="Permalink to this headline">¶</a>
</h3>
<p>If you need to get the configuration of the firewall that matched a given request,
use the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Security</a> service:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Service/ExampleService.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">SecurityBundle</span>\<span class="hljs-title">Security</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">RequestStack</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(
        // Avoid calling getFirewallConfig<span class="hljs-params">()</span> in the constructor: auth may not
        // be complete yet. Instead, store the entire Security object.
        private Security <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>,
        RequestStack <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>requestStack</span>,
    )</span> </span>{
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someMethod</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>request</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>requestStack<span class="hljs-operator">-&gt;</span>getCurrentRequest();
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>firewallName</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>security<span class="hljs-operator">-&gt;</span>getFirewallConfig(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>request</span>)?<span class="hljs-operator">-&gt;</span>getName();

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">getFirewallConfig()</code> method was introduced in Symfony 6.2.</p>
</div>
<span id="security-authenticators"></span>
</div>
</div>
<div class="section">
<h2 id="authenticating-users">
    Authenticating Users
    <a class="headerlink" href="#authenticating-users" title="Permalink to this headline">¶</a>
</h2>
<p>During authentication, the system tries to find a matching user for the
visitor of the webpage. Traditionally, this was done using a login form or
a HTTP basic dialog in the browser. However, the SecurityBundle comes with
many other authenticators:</p>
<ul>
    <li><a href="security.html#form-login" class="reference internal">Form Login</a></li>
<li><a href="security.html#json-login" class="reference internal">JSON Login</a></li>
<li><a href="security.html#http-basic" class="reference internal">HTTP Basic</a></li>
<li><a href="security.html#login-link" class="reference internal">Login Link</a></li>
<li><a href="security.html#x-509-client-certificates" class="reference internal">X.509 Client Certificates</a></li>
<li><a href="security.html#remote-users" class="reference internal">Remote users</a></li>
<li><a href="security/custom_authenticator.html" class="reference internal">Custom Authenticators</a></li>
</ul>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>If your application logs users in via a third-party service such as
Google, Facebook or Twitter (social login), check out the <a href="https://github.com/hwi/HWIOAuthBundle" class="reference external" rel="external noopener noreferrer" target="_blank">HWIOAuthBundle</a>
community bundle.</p>
</div>
<span id="security-form-login"></span>
<div class="section">
<h3 id="form-login">
    Form Login
    <a class="headerlink" href="#form-login" title="Permalink to this headline">¶</a>
</h3>
<p>Most websites have a login form where users authenticate using an
identifier (e.g. email address or username) and a password. This
functionality is provided by the <em>form login authenticator</em>.</p>
<p>First, create a controller for the login form:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console make:controller Login

 created: src/Controller/LoginController.php
 created: templates/login/index.html.twig</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/LoginController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/login', name: 'app_login')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>render(<span class="hljs-string">'login/index.html.twig'</span>, [
            <span class="hljs-string">'controller_name'</span> =&gt; <span class="hljs-string">'LoginController'</span>,
        ]);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Then, enable the form login authenticator using the <code translate="no" class="notranslate">form_login</code> setting:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-1353d3d260e725532f08ff586b4ee23a73208733" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-2f0f81b5722785301f24333dd0a3b793e6a4796e" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-ae39c44d861bcff004dd4dfad4adaf8fcaf5d961" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-1353d3d260e725532f08ff586b4ee23a73208733" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">form_login:</span>
                <span class="hljs-comment"># "app_login" is the name of the route created previously</span>
                <span class="hljs-attr">login_path:</span> <span class="hljs-string">app_login</span>
                <span class="hljs-attr">check_path:</span> <span class="hljs-string">app_login</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-2f0f81b5722785301f24333dd0a3b793e6a4796e" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- "app_login" is the name of the route created previously --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">form-login</span> <span class="hljs-attr">login-path</span>=<span class="hljs-string">"app_login"</span> <span class="hljs-attr">check-path</span>=<span class="hljs-string">"app_login"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-ae39c44d861bcff004dd4dfad4adaf8fcaf5d961" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);

    <span class="hljs-comment">// "app_login" is the name of the route created previously</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>formLogin()
        <span class="hljs-operator">-&gt;</span>loginPath(<span class="hljs-string">'app_login'</span>)
        <span class="hljs-operator">-&gt;</span>checkPath(<span class="hljs-string">'app_login'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The <code translate="no" class="notranslate">login_path</code> and <code translate="no" class="notranslate">check_path</code> support URLs and route names (but
cannot have mandatory wildcards - e.g. <code translate="no" class="notranslate">/login/{foo}</code> where <code translate="no" class="notranslate">foo</code>
has no default value).</p>
</div>
<p>Once enabled, the security system redirects unauthenticated visitors to the
<code translate="no" class="notranslate">login_path</code> when they try to access a secured place (this behavior can
be customized using <a href="security/access_denied_handler.html#security-entry-point" class="reference internal">authentication entry points</a>).</p>
<p>Edit the login controller to render the login form:</p>
<div translate="no" class="highlight-diff notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs diff">// ...
<span class="hljs-addition">+ use Symfony\Component\Security\Http\Authentication\AuthenticationUtils;</span>

  class LoginController extends AbstractController
  {
      #[Route('/login', name: 'app_login')]
<span class="hljs-deletion">-     public function index(): Response</span>
<span class="hljs-addition">+     public function index(AuthenticationUtils $authenticationUtils): Response</span>
      {
<span class="hljs-addition">+         // get the login error if there is one</span>
<span class="hljs-addition">+         $error = $authenticationUtils-&gt;getLastAuthenticationError();</span>
<span class="hljs-addition">+</span>
<span class="hljs-addition">+         // last username entered by the user</span>
<span class="hljs-addition">+         $lastUsername = $authenticationUtils-&gt;getLastUsername();</span>
<span class="hljs-addition">+</span>
          return $this-&gt;render('login/index.html.twig', [
<span class="hljs-deletion">-             'controller_name' =&gt; 'LoginController',</span>
<span class="hljs-addition">+             'last_username' =&gt; $lastUsername,</span>
<span class="hljs-addition">+             'error'         =&gt; $error,</span>
          ]);
      }
  }</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Don't let this controller confuse you. Its job is only to <em>render</em> the form:
the <code translate="no" class="notranslate">form_login</code> authenticator will handle the form <em>submission</em> automatically.
If the user submits an invalid email or password, that authenticator will store
the error and redirect back to this controller, where we read the error (using
<code translate="no" class="notranslate">AuthenticationUtils</code>) so that it can be displayed back to the user.</p>
<p>Finally, create or update the template:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-comment">{# templates/login/index.html.twig #}</span><span class="xml">
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">extends</span></span> 'base.html.twig' %}</span><span class="xml">

</span><span class="hljs-comment">{# ... #}</span><span class="xml">

</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">block</span></span> body %}</span><span class="xml">
    </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">if</span></span> error %}</span><span class="xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-template-variable">{{ error.messageKey|trans(error.messageData, 'security') }}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endif</span></span> %}</span><span class="xml">

    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ path('app_login') }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"username"</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"_username"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ last_username }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"password"</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"_password"</span>&gt;</span>

        </span><span class="hljs-comment">{# If you want to control the URL the user is redirected to on success
        &lt;input type="hidden" name="_target_path" value="/account"&gt; #}</span><span class="xml">

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endblock</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>The <code translate="no" class="notranslate">error</code> variable passed into the template is an instance
of <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Exception/AuthenticationException.php" class="reference external" title="Symfony\Component\Security\Core\Exception\AuthenticationException" rel="external noopener noreferrer" target="_blank">AuthenticationException</a>.
It may contain sensitive information about the authentication failure.
<em>Never</em> use <code translate="no" class="notranslate">error.message</code>: use the <code translate="no" class="notranslate">messageKey</code> property instead,
as shown in the example. This message is always safe to display.</p>
</div>
<p>The form can look like anything, but it usually follows some conventions:</p>
<ul>
    <li>The <code translate="no" class="notranslate">&lt;form&gt;</code> element sends a <code translate="no" class="notranslate">POST</code> request to the <code translate="no" class="notranslate">app_login</code> route, since
that's what you configured as the <code translate="no" class="notranslate">check_path</code> under the <code translate="no" class="notranslate">form_login</code> key in
<code translate="no" class="notranslate">security.yaml</code>;</li>
<li>The username (or whatever your user's &quot;identifier&quot; is, like an email) field has
the name <code translate="no" class="notranslate">_username</code> and the password field has the name <code translate="no" class="notranslate">_password</code>.</li>
</ul>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Actually, all of this can be configured under the <code translate="no" class="notranslate">form_login</code> key. See
<a href="reference/configuration/security.html#reference-security-firewall-form-login" class="reference internal">Security Configuration Reference (SecurityBundle)</a> for more details.</p>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>This login form is currently not protected against CSRF attacks. Read
<a href="security.html#form_login-csrf" class="reference internal">Security</a> on how to protect your login form.</p>
</div>
<p>And that's it! When you submit the form, the security system automatically
reads the <code translate="no" class="notranslate">_username</code> and <code translate="no" class="notranslate">_password</code> POST parameter, loads the user via
the user provider, checks the user's credentials and either authenticates the
user or sends them back to the login form where the error can be displayed.</p>
<p>To review the whole process:</p>
<ol class="arabic">
    <li>The user tries to access a resource that is protected (e.g. <code translate="no" class="notranslate">/admin</code>);</li>
<li>The firewall initiates the authentication process by redirecting the
user to the login form (<code translate="no" class="notranslate">/login</code>);</li>
<li>The <code translate="no" class="notranslate">/login</code> page renders login form via the route and controller created
in this example;</li>
<li>The user submits the login form to <code translate="no" class="notranslate">/login</code>;</li>
<li>The security system (i.e. the <code translate="no" class="notranslate">form_login</code> authenticator) intercepts the
request, checks the user's submitted credentials, authenticates the user if
they are correct, and sends the user back to the login form if they are not.</li>
</ol>
<div class="admonition admonition-seealso ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" /></svg>
                <span>See also</span>
    </p><p>You can customize the responses on a successful or failed login
attempt. See <a href="security/form_login.html" class="reference internal">Customizing the Form Login Authenticator Responses</a>.</p>
</div>
<span id="form_login-csrf"></span>
<div class="section">
<h4 id="csrf-protection-in-login-forms">
    CSRF Protection in Login Forms
    <a class="headerlink" href="#csrf-protection-in-login-forms" title="Permalink to this headline">¶</a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery#Forging_login_requests" class="reference external" rel="external noopener noreferrer" target="_blank">Login CSRF attacks</a> can be prevented using the same technique of adding hidden
CSRF tokens into the login forms. The Security component already provides CSRF
protection, but you need to configure some options before using it.</p>
<p>First, you need to enable CSRF on the form login:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-8f707d12e2f981665b84f8c8e0f15a75e9b98430" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-b246fa42d11b857bdf7d22a2416c4229e48559ba" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-97e626a91b2341f5e62e5703756c9f0882cc001f" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-8f707d12e2f981665b84f8c8e0f15a75e9b98430" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">secured_area:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">form_login:</span>
                <span class="hljs-comment"># ...</span>
                <span class="hljs-attr">enable_csrf:</span> <span class="hljs-literal">true</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-b246fa42d11b857bdf7d22a2416c4229e48559ba" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"secured_area"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- ... --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">form-login</span> <span class="hljs-attr">enable-csrf</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-97e626a91b2341f5e62e5703756c9f0882cc001f" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>formLogin()
        <span class="hljs-comment">// ...</span>
        <span class="hljs-operator">-&gt;</span>enableCsrf(<span class="hljs-keyword">true</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<span id="csrf-login-template"></span>
<p>Then, use the <code translate="no" class="notranslate">csrf_token()</code> function in the Twig template to generate a CSRF
token and store it as a hidden field of the form. By default, the HTML field
must be called <code translate="no" class="notranslate">_csrf_token</code> and the string used to generate the value must
be <code translate="no" class="notranslate">authenticate</code>:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-comment">{# templates/login/index.html.twig #}</span><span class="xml">

</span><span class="hljs-comment">{# ... #}</span><span class="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ path('app_login') }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
    </span><span class="hljs-comment">{# ... the login fields #}</span><span class="xml">

    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"_csrf_token"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ csrf_token('authenticate') }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>After this, you have protected your login form against CSRF attacks.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>You can change the name of the field by setting <code translate="no" class="notranslate">csrf_parameter</code> and change
the token ID by setting  <code translate="no" class="notranslate">csrf_token_id</code> in your configuration. See
<a href="reference/configuration/security.html#reference-security-firewall-form-login" class="reference internal">Security Configuration Reference (SecurityBundle)</a> for more details.</p>
</div>
<span id="security-json-login"></span>
</div>
</div>
<div class="section">
<h3 id="json-login">
    JSON Login
    <a class="headerlink" href="#json-login" title="Permalink to this headline">¶</a>
</h3>
<p>Some applications provide an API that is secured using tokens. These
applications may use an endpoint that provides these tokens based on a
username (or email) and password. The JSON login authenticator helps you create
this functionality.</p>
<p>Enable the authenticator using the <code translate="no" class="notranslate">json_login</code> setting:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-70edd4debf0aa58d741cdb439d0f29d1480f8a56" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-8c8b847435aeae08dcaa55b73ebf4c45f4337137" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-6c108c20bdb2ee2b320503585864134ae88fe316" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-70edd4debf0aa58d741cdb439d0f29d1480f8a56" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">json_login:</span>
                <span class="hljs-comment"># api_login is a route we will create below</span>
                <span class="hljs-attr">check_path:</span> <span class="hljs-string">api_login</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-8c8b847435aeae08dcaa55b73ebf4c45f4337137" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">json-login</span> <span class="hljs-attr">check-path</span>=<span class="hljs-string">"api_login"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-6c108c20bdb2ee2b320503585864134ae88fe316" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>jsonLogin()
        <span class="hljs-operator">-&gt;</span>checkPath(<span class="hljs-string">'api_login'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The <code translate="no" class="notranslate">check_path</code> supports URLs and route names (but cannot have
mandatory wildcards - e.g. <code translate="no" class="notranslate">/login/{foo}</code> where <code translate="no" class="notranslate">foo</code> has no
default value).</p>
</div>
<p>The authenticator runs when a client requests the <code translate="no" class="notranslate">check_path</code>. First,
create a controller for this path:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console make:controller --no-template ApiLogin

 created: src/Controller/ApiLoginController.php</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/ApiLoginController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApiLoginController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/api/login', name: 'api_login')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>json([
            <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Welcome to your new controller!'</span>,
            <span class="hljs-string">'path'</span> =&gt; <span class="hljs-string">'src/Controller/ApiLoginController.php'</span>,
        ]);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This login controller will be called after the authenticator successfully
authenticates the user. You can get the authenticated user, generate a
token (or whatever you need to return) and return the JSON response:</p>
<div translate="no" class="highlight-diff notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs diff">// ...
<span class="hljs-addition">+ use App\Entity\User;</span>
<span class="hljs-addition">+ use Symfony\Component\Security\Http\Attribute\CurrentUser;</span>

  class ApiLoginController extends AbstractController
  {
      #[Route('/api/login', name: 'api_login')]
<span class="hljs-deletion">-     public function index(): Response</span>
<span class="hljs-addition">+     public function index(#[CurrentUser] ?User $user): Response</span>
      {
<span class="hljs-addition">+         if (null === $user) {</span>
<span class="hljs-addition">+             return $this-&gt;json([</span>
<span class="hljs-addition">+                 'message' =&gt; 'missing credentials',</span>
<span class="hljs-addition">+             ], Response::HTTP_UNAUTHORIZED);</span>
<span class="hljs-addition">+         }</span>
<span class="hljs-addition">+</span>
<span class="hljs-addition">+         $token = ...; // somehow create an API token for $user</span>
<span class="hljs-addition">+</span>
          return $this-&gt;json([
<span class="hljs-deletion">-             'message' =&gt; 'Welcome to your new controller!',</span>
<span class="hljs-deletion">-             'path' =&gt; 'src/Controller/ApiLoginController.php',</span>
<span class="hljs-addition">+             'user'  =&gt; $user-&gt;getUserIdentifier(),</span>
<span class="hljs-addition">+             'token' =&gt; $token,</span>
          ]);
      }
  }</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The <code translate="no" class="notranslate">#[CurrentUser]</code> can only be used in controller arguments to
retrieve the authenticated user. In services, you would use
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Security.php#method_getUser" class="reference external" title="Symfony\Component\Security\Core\Security::getUser()" rel="external noopener noreferrer" target="_blank">getUser()</a>.</p>
</div>
<p>That's it! To summarize the process:</p>
<ol class="arabic">
    <li><p>A client (e.g. the front-end) makes a <em>POST request</em> with the
<code translate="no" class="notranslate">Content-Type: application/json</code> header to <code translate="no" class="notranslate">/api/login</code> with
<code translate="no" class="notranslate">username</code> (even if your identifier is actually an email) and
<code translate="no" class="notranslate">password</code> keys:</p>
<div translate="no" class="highlight-json notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs json">{
    <span class="hljs-attr">"username"</span>: <span class="hljs-string">"dunglas@example.com"</span>,
    <span class="hljs-attr">"password"</span>: <span class="hljs-string">"MyPassword"</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div></li>
<li>The security system intercepts the request, checks the user's submitted
credentials and authenticates the user. If the credentials are incorrect,
an HTTP 401 Unauthorized JSON response is returned, otherwise your
controller is run;</li>
<li><p>Your controller creates the correct response:</p>
<div translate="no" class="highlight-json notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs json">{
    <span class="hljs-attr">"user"</span>: <span class="hljs-string">"dunglas@example.com"</span>,
    <span class="hljs-attr">"token"</span>: <span class="hljs-string">"45be42..."</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div></li>
</ol>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>The JSON request format can be configured under the <code translate="no" class="notranslate">json_login</code> key.
See <a href="reference/configuration/security.html#reference-security-firewall-json-login" class="reference internal">Security Configuration Reference (SecurityBundle)</a> for more details.</p>
</div>
<span id="security-http_basic"></span>
</div>
<div class="section">
<h3 id="http-basic">
    HTTP Basic
    <a class="headerlink" href="#http-basic" title="Permalink to this headline">¶</a>
</h3>
<p><a href="https://en.wikipedia.org/wiki/Basic_access_authentication" class="reference external" rel="external noopener noreferrer" target="_blank">HTTP Basic authentication</a> is a standardized HTTP authentication
framework. It asks credentials (username and password) using a dialog in
the browser and the HTTP basic authenticator of Symfony will verify these
credentials.</p>
<p>Add the <code translate="no" class="notranslate">http_basic</code> key to your firewall to enable HTTP Basic
authentication:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-bb54d6377b54b44e1d34b1154472cfeaba4183dc" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-2755ac05d3464e31313cc74a9aa4cae88a676ac3" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-8c45337f970706e303b6bcbb5918a4c75be1f75a" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-bb54d6377b54b44e1d34b1154472cfeaba4183dc" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">http_basic:</span>
                <span class="hljs-attr">realm:</span> <span class="hljs-string">Secured</span> <span class="hljs-string">Area</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-2755ac05d3464e31313cc74a9aa4cae88a676ac3" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">http-basic</span> <span class="hljs-attr">realm</span>=<span class="hljs-string">"Secured Area"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-8c45337f970706e303b6bcbb5918a4c75be1f75a" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>httpBasic()
        <span class="hljs-operator">-&gt;</span>realm(<span class="hljs-string">'Secured Area'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>That's it! Whenever an unauthenticated user tries to visit a protected
page, Symfony will inform the browser that it needs to start HTTP basic
authentication (using the <code translate="no" class="notranslate">WWW-Authenticate</code> response header). Then, the
authenticator verifies the credentials and authenticates the user.</p>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>You cannot use <a href="security.html#security-logging-out" class="reference internal">log out</a> with the HTTP
basic authenticator. Even if you log out from Symfony, your browser
&quot;remembers&quot; your credentials and will send them on every request.</p>
</div>
</div>
<div class="section">
<h3 id="login-link">
    Login Link
    <a class="headerlink" href="#login-link" title="Permalink to this headline">¶</a>
</h3>
<p>Login links are a passwordless authentication mechanism. The user will
receive a short-lived link (e.g. via email) which will authenticate them to the
website.</p>
<p>You can learn all about this authenticator in <a href="security/login_link.html" class="reference internal">How to use Passwordless Login Link Authentication</a>.</p>
</div>
<div class="section">
<h3 id="access-tokens">
    Access Tokens
    <a class="headerlink" href="#access-tokens" title="Permalink to this headline">¶</a>
</h3>
<p>Access Tokens are often used in API contexts.
The user receives a token from an authorization server
which authenticates them.</p>
<p>You can learn all about this authenticator in <a href="security/access_token.html" class="reference internal">How to use Access Token Authentication</a>.</p>
</div>
<div class="section">
<h3 id="x-509-client-certificates">
    X.509 Client Certificates
    <a class="headerlink" href="#x-509-client-certificates" title="Permalink to this headline">¶</a>
</h3>
<p>When using client certificates, your web server does all the authentication
itself. The X.509 authenticator provided by Symfony extracts the email from
the &quot;distinguished name&quot; (DN) of the client certificate. Then, it uses this
email as user identifier in the user provider.</p>
<p>First, configure your web server to enable client certificate verification
and to expose the certificate's DN to the Symfony application:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-2">
                    <button role="tab" type="button" data-language="nginx"
                aria-controls="configuration-block-tabpanel-aac0169b3464d719d54057fd37128cfdd4683c58" aria-selected="true"
                data-active="true" >
                <span>Nginx</span>
            </button>
                    <button role="tab" type="button" data-language="apache"
                aria-controls="configuration-block-tabpanel-2b22d532d8192b47483d4de05b803dcaf677f372" aria-selected="false"
                 tabindex="-1">
                <span>Apache</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-aac0169b3464d719d54057fd37128cfdd4683c58" aria-label="Nginx" class="configuration-codeblock" data-language="nginx" style="">
            <div translate="no" class="highlight-nginx notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs nginx"><span class="hljs-section">server</span> {
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attribute">ssl_client_certificate</span> /path/to/my-custom-CA.pem;

    <span class="hljs-comment"># enable client certificate verification</span>
    <span class="hljs-attribute">ssl_verify_client</span> optional;
    <span class="hljs-attribute">ssl_verify_depth</span> <span class="hljs-number">1</span>;

    <span class="hljs-attribute">location</span> / {
        <span class="hljs-comment"># pass the DN as "SSL_CLIENT_S_DN" to the application</span>
        <span class="hljs-attribute">fastcgi_param</span> SSL_CLIENT_S_DN <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>ssl_client_s_dn</span>;

        <span class="hljs-comment"># ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-2b22d532d8192b47483d4de05b803dcaf677f372" aria-label="Apache" class="configuration-codeblock" data-language="apache" style="display: none">
            <div translate="no" class="highlight-apache notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs apache"><span class="hljs-comment"># ...</span>
<span class="hljs-attribute">SSLCACertificateFile</span> <span class="hljs-string">"/path/to/my-custom-CA.pem"</span>
<span class="hljs-attribute">SSLVerifyClient</span> optional
<span class="hljs-attribute">SSLVerifyDepth</span> 1

<span class="hljs-comment"># pass the DN to the application</span>
<span class="hljs-attribute">SSLOptions</span> +StdEnvVars</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Then, enable the X.509 authenticator using <code translate="no" class="notranslate">x509</code> on your firewall:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-be942200a3e45fad454a624a3089f925ed97ec21" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-74cebdc162e3e7bc9d6c8decbb3c1dfc58633ca3" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-80d1cba47161ccea545f5544c8010cd9c4d52772" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-be942200a3e45fad454a624a3089f925ed97ec21" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">x509:</span>
                <span class="hljs-attr">provider:</span> <span class="hljs-string">your_user_provider</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-74cebdc162e3e7bc9d6c8decbb3c1dfc58633ca3" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- ... --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">x509</span> <span class="hljs-attr">provider</span>=<span class="hljs-string">"your_user_provider"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-80d1cba47161ccea545f5544c8010cd9c4d52772" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>x509()
        <span class="hljs-operator">-&gt;</span>provider(<span class="hljs-string">'your_user_provider'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>By default, Symfony extracts the email address from the DN in two different
ways:</p>
<ol class="arabic">
    <li>First, it tries the <code translate="no" class="notranslate">SSL_CLIENT_S_DN_Email</code> server parameter, which is
exposed by Apache;</li>
<li>If it is not set (e.g. when using Nginx), it uses <code translate="no" class="notranslate">SSL_CLIENT_S_DN</code> and
matches the value following <code translate="no" class="notranslate">emailAddress</code>.</li>
</ol>
<p>You can customize the name of some parameters under the <code translate="no" class="notranslate">x509</code> key.
See <a href="reference/configuration/security.html#reference-security-firewall-x509" class="reference internal">the x509 configuration reference</a>
for more details.</p>
</div>
<div class="section">
<h3 id="remote-users">
    Remote Users
    <a class="headerlink" href="#remote-users" title="Permalink to this headline">¶</a>
</h3>
<p>Besides client certificate authentication, there are more web server
modules that pre-authenticate a user (e.g. kerberos). The remote user
authenticator provides a basic integration for these services.</p>
<p>These modules often expose the authenticated user in the <code translate="no" class="notranslate">REMOTE_USER</code>
environment variable. The remote user authenticator uses this value as the
user identifier to load the corresponding user.</p>
<p>Enable remote user authentication using the <code translate="no" class="notranslate">remote_user</code> key:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-5b06681086e7170c6cd347af4b36f1b971fd01e7" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-c4c221ffca5de51f0c4661eb370f37594bf2a11a" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-3ad406e6e2161d6d51ea799e14dd6714894959dc" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-5b06681086e7170c6cd347af4b36f1b971fd01e7" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">remote_user:</span>
                <span class="hljs-attr">provider:</span> <span class="hljs-string">your_user_provider</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-c4c221ffca5de51f0c4661eb370f37594bf2a11a" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">remote-user</span> <span class="hljs-attr">provider</span>=<span class="hljs-string">"your_user_provider"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3ad406e6e2161d6d51ea799e14dd6714894959dc" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>remoteUser()
        <span class="hljs-operator">-&gt;</span>provider(<span class="hljs-string">'your_user_provider'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>You can customize the name of this server variable under the
<code translate="no" class="notranslate">remote_user</code> key. See
<a href="reference/configuration/security.html#reference-security-firewall-remote-user" class="reference internal">the configuration reference</a>
for more details.</p>
</div>
<span id="security-login-throttling"></span>
</div>
<div class="section">
<h3 id="limiting-login-attempts">
    Limiting Login Attempts
    <a class="headerlink" href="#limiting-login-attempts" title="Permalink to this headline">¶</a>
</h3>
<p>Symfony provides basic protection against <a href="https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks" class="reference external" rel="external noopener noreferrer" target="_blank">brute force login attacks</a>.
You must enable this using the <code translate="no" class="notranslate">login_throttling</code> setting:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-879c15f7c17f287b44195fb2770c162e9b33f55b" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-72a42e454bafbe0876e5ab978484785bc8f5cc8a" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-7df6f6497a4bfc6e753c3bc72d11939d26b98b85" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-879c15f7c17f287b44195fb2770c162e9b33f55b" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-comment"># ...</span>

        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>

            <span class="hljs-comment"># by default, the feature allows 5 login attempts per minute</span>
            <span class="hljs-attr">login_throttling:</span> <span class="hljs-literal">null</span>

            <span class="hljs-comment"># configure the maximum login attempts</span>
            <span class="hljs-attr">login_throttling:</span>
                <span class="hljs-attr">max_attempts:</span> <span class="hljs-number">3</span>          <span class="hljs-comment"># per minute ...</span>
                <span class="hljs-comment"># interval: '15 minutes' # ... or in a custom period</span>

            <span class="hljs-comment"># use a custom rate limiter via its service ID</span>
            <span class="hljs-attr">login_throttling:</span>
                <span class="hljs-attr">limiter:</span> <span class="hljs-string">app.my_login_rate_limiter</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-72a42e454bafbe0876e5ab978484785bc8f5cc8a" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- you must use the authenticator manager --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">config</span> <span class="hljs-attr">enable-authenticator-manager</span>=<span class="hljs-string">"true"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- by default, the feature allows 5 login attempts per minute
                 max-attempts: (optional) You can configure the maximum attempts ...
                 interval:     (optional) ... and the period of time. --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">login-throttling</span> <span class="hljs-attr">max-attempts</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">"15 minutes"</span>/&gt;</span>

            <span class="hljs-comment">&lt;!-- use a custom rate limiter via its service ID --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">login-throttling</span> <span class="hljs-attr">limiter</span>=<span class="hljs-string">"app.my_login_rate_limiter"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-7df6f6497a4bfc6e753c3bc72d11939d26b98b85" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>enableAuthenticatorManager(<span class="hljs-keyword">true</span>);

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);

    <span class="hljs-comment">// by default, the feature allows 5 login attempts per minute</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>loginThrottling()
        <span class="hljs-comment">// -&gt;maxAttempts(3)         // Optional: You can configure the maximum attempts ...</span>
        <span class="hljs-comment">// -&gt;interval('15 minutes') // ... and the period of time.</span>
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The value of the <code translate="no" class="notranslate">interval</code> option must be a number followed by any of the
units accepted by the <a href="https://www.php.net/datetime.formats.relative" class="reference external" rel="external noopener noreferrer" target="_blank">PHP date relative formats</a> (e.g. <code translate="no" class="notranslate">3 seconds</code>,
<code translate="no" class="notranslate">10 hours</code>, <code translate="no" class="notranslate">1 day</code>, etc.)</p>
</div>
<p>Internally, Symfony uses the <a href="rate_limiter.html" class="reference internal">Rate Limiter component</a>
which by default uses Symfony's cache to store the previous login attempts.
However, you can implement a <a href="rate_limiter.html#rate-limiter-storage" class="reference internal">custom storage</a>.</p>
<p>Login attempts are limited on <code translate="no" class="notranslate">max_attempts</code> (default: 5)
failed requests for <code translate="no" class="notranslate">IP address + username</code> and <code translate="no" class="notranslate">5 * max_attempts</code>
failed requests for <code translate="no" class="notranslate">IP address</code>. The second limit protects against an
attacker using multiple usernames from bypassing the first limit, without
disrupting normal users on big networks (such as offices).</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Limiting the failed login attempts is only one basic protection against
brute force attacks. The <a href="https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks" class="reference external" rel="external noopener noreferrer" target="_blank">OWASP Brute Force Attacks</a> guidelines mention
several other protections that you should consider depending on the
level of protection required.</p>
</div>
<p>If you need a more complex limiting algorithm, create a class that implements
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/HttpFoundation/RateLimiter/RequestRateLimiterInterface.php" class="reference external" title="Symfony\Component\HttpFoundation\RateLimiter\RequestRateLimiterInterface" rel="external noopener noreferrer" target="_blank">RequestRateLimiterInterface</a>
(or use
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/RateLimiter/DefaultLoginRateLimiter.php" class="reference external" title="Symfony\Component\Security\Http\RateLimiter\DefaultLoginRateLimiter" rel="external noopener noreferrer" target="_blank">DefaultLoginRateLimiter</a>)
and set the <code translate="no" class="notranslate">limiter</code> option to its service ID:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-c987e3981dcf1b7731c4d656db469e9a92ece7a8" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-04ab7d8c49369931f622b6c4d9c8587bacf6dabc" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-26f9cbb5b8397e2e4e5a1c64fff476df7c2a6b1b" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-c987e3981dcf1b7731c4d656db469e9a92ece7a8" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">rate_limiter:</span>
        <span class="hljs-comment"># define 2 rate limiters (one for username+IP, the other for IP)</span>
        <span class="hljs-attr">username_ip_login:</span>
            <span class="hljs-attr">policy:</span> <span class="hljs-string">token_bucket</span>
            <span class="hljs-attr">limit:</span> <span class="hljs-number">5</span>
            <span class="hljs-attr">rate:</span> <span class="hljs-string">{</span> <span class="hljs-attr">interval:</span> <span class="hljs-string">'5 minutes'</span> <span class="hljs-string">}</span>

        <span class="hljs-attr">ip_login:</span>
            <span class="hljs-attr">policy:</span> <span class="hljs-string">sliding_window</span>
            <span class="hljs-attr">limit:</span> <span class="hljs-number">50</span>
            <span class="hljs-attr">interval:</span> <span class="hljs-string">'15 minutes'</span>

<span class="hljs-attr">services:</span>
    <span class="hljs-comment"># our custom login rate limiter</span>
    <span class="hljs-attr">app.login_rate_limiter:</span>
        <span class="hljs-attr">class:</span> <span class="hljs-string">Symfony\Component\Security\Http\RateLimiter\DefaultLoginRateLimiter</span>
        <span class="hljs-attr">arguments:</span>
            <span class="hljs-comment"># globalFactory is the limiter for IP</span>
            <span class="hljs-string">$globalFactory:</span> <span class="hljs-string">'@limiter.ip_login'</span>
            <span class="hljs-comment"># localFactory is the limiter for username+IP</span>
            <span class="hljs-string">$localFactory:</span> <span class="hljs-string">'@limiter.username_ip_login'</span>

<span class="hljs-attr">security:</span>
    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># use a custom rate limiter via its service ID</span>
            <span class="hljs-attr">login_throttling:</span>
                <span class="hljs-attr">limiter:</span> <span class="hljs-string">app.login_rate_limiter</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-04ab7d8c49369931f622b6c4d9c8587bacf6dabc" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony
        https://symfony.com/schema/dic/symfony/symfony-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:rate-limiter</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- define 2 rate limiters (one for username+IP, the other for IP) --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:limiter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username_ip_login"</span>
                <span class="hljs-attr">policy</span>=<span class="hljs-string">"token_bucket"</span>
                <span class="hljs-attr">limit</span>=<span class="hljs-string">"5"</span>
            &gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:rate</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">"5 minutes"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">framework:limiter</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">framework:limiter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"ip_login"</span>
                <span class="hljs-attr">policy</span>=<span class="hljs-string">"sliding_window"</span>
                <span class="hljs-attr">limit</span>=<span class="hljs-string">"50"</span>
                <span class="hljs-attr">interval</span>=<span class="hljs-string">"15 minutes"</span>
            /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:rate-limiter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">srv:services</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- our custom login rate limiter --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">srv:service</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app.login_rate_limiter"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"Symfony\Component\Security\Http\RateLimiter\DefaultLoginRateLimiter"</span>
        &gt;</span>
            <span class="hljs-comment">&lt;!-- 1st argument is the limiter for IP --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">srv:argument</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"service"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"limiter.ip_login"</span>/&gt;</span>
            <span class="hljs-comment">&lt;!-- 2nd argument is the limiter for username+IP --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">srv:argument</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"service"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"limiter.username_ip_login"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">srv:service</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">srv:services</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- use a custom rate limiter via its service ID --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">login-throttling</span> <span class="hljs-attr">limiter</span>=<span class="hljs-string">"app.login_rate_limiter"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-26f9cbb5b8397e2e4e5a1c64fff476df7c2a6b1b" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">ContainerBuilder</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">Reference</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">RateLimiter</span>\<span class="hljs-title">DefaultLoginRateLimiter</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ContainerBuilder <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerBuilder</span>, FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>, SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>rateLimiter()
        <span class="hljs-operator">-&gt;</span>limiter(<span class="hljs-string">'username_ip_login'</span>)
            <span class="hljs-operator">-&gt;</span>policy(<span class="hljs-string">'token_bucket'</span>)
            <span class="hljs-operator">-&gt;</span>limit(<span class="hljs-number">5</span>)
            <span class="hljs-operator">-&gt;</span>rate()
                <span class="hljs-operator">-&gt;</span>interval(<span class="hljs-string">'5 minutes'</span>)
    ;

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>rateLimiter()
        <span class="hljs-operator">-&gt;</span>limiter(<span class="hljs-string">'ip_login'</span>)
            <span class="hljs-operator">-&gt;</span>policy(<span class="hljs-string">'sliding_window'</span>)
            <span class="hljs-operator">-&gt;</span>limit(<span class="hljs-number">50</span>)
            <span class="hljs-operator">-&gt;</span>interval(<span class="hljs-string">'15 minutes'</span>)
    ;

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerBuilder</span><span class="hljs-operator">-&gt;</span>register(<span class="hljs-string">'app.login_rate_limiter'</span>, DefaultLoginRateLimiter<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>setArguments([
            <span class="hljs-comment">// 1st argument is the limiter for IP</span>
            <span class="hljs-keyword">new</span> Reference(<span class="hljs-string">'limiter.ip_login'</span>),
            <span class="hljs-comment">// 2nd argument is the limiter for username+IP</span>
            <span class="hljs-keyword">new</span> Reference(<span class="hljs-string">'limiter.username_ip_login'</span>),
        ]);

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>)
        <span class="hljs-operator">-&gt;</span>loginThrottling()
            <span class="hljs-operator">-&gt;</span>limiter(<span class="hljs-string">'app.login_rate_limiter'</span>)
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
</div>
<div class="section">
<h2 id="login-programmatically">
    Login Programmatically
    <a class="headerlink" href="#login-programmatically" title="Permalink to this headline">¶</a>
</h2>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Symfony\Bundle\SecurityBundle\Security</a>
class was introduced in Symfony 6.2. Prior to 6.2, it was called
<code translate="no" class="notranslate">Symfony<wbr>\Component<wbr>\Security<wbr>\Core<wbr>\Security</code>.</p>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php#method_login" class="reference external" title="Symfony\Bundle\SecurityBundle\Security::login()" rel="external noopener noreferrer" target="_blank">login()</a>
method was introduced in Symfony 6.2.</p>
</div>
<p>You can log in a user programmatically using the <code translate="no" class="notranslate">login()</code> method of the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Security</a> helper:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/SecurityController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">SecurityController</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Authenticator</span>\<span class="hljs-title">ExampleAuthenticator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">SecurityBundle</span>\<span class="hljs-title">Security</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someAction</span><span class="hljs-params">(Security <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-comment">// get the user to be authenticated</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = ...;

        <span class="hljs-comment">// log the user in on the current firewall</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>login(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>);

        <span class="hljs-comment">// if the firewall has more than one authenticator, you must pass it explicitly</span>
        <span class="hljs-comment">// by using the name of built-in authenticators...</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>login(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, <span class="hljs-string">'form_login'</span>);
        <span class="hljs-comment">// ...or the service id of custom authenticators</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>login(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, ExampleAuthenticator<span class="hljs-operator">::</span>class);

        <span class="hljs-comment">// you can also log in on a different firewall</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>login(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>, <span class="hljs-string">'form_login'</span>, <span class="hljs-string">'other_firewall'</span>);

        <span class="hljs-comment">// use the redirection logic applied to regular login</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>redirectResponse</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>login(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>redirectResponse</span>;

        <span class="hljs-comment">// or use a custom redirection logic (e.g. redirect users to their account page)</span>
        <span class="hljs-comment">// return new RedirectResponse('...');</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.3</span>
    </p><p>The feature to use a custom redirection logic was introduced in Symfony 6.3.</p>
</div>
<span id="security-logging-out"></span>
</div>
<div class="section">
<h2 id="logging-out">
    Logging Out
    <a class="headerlink" href="#logging-out" title="Permalink to this headline">¶</a>
</h2>
<p>To enable logging out, activate the  <code translate="no" class="notranslate">logout</code> config parameter under your firewall:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-67ecd048b1e14cfaac474e1ecbd8d6772d20ded7" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-665f66aabae9873c52fa3bba45a45020f9bb5a22" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-b3ba6cf01084162aa8fc4633b395a050da7a8abf" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-67ecd048b1e14cfaac474e1ecbd8d6772d20ded7" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>
            <span class="hljs-attr">logout:</span>
                <span class="hljs-attr">path:</span> <span class="hljs-string">app_logout</span>

                <span class="hljs-comment"># where to redirect after logout</span>
                <span class="hljs-comment"># target: app_any_route</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-665f66aabae9873c52fa3bba45a45020f9bb5a22" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- ... --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">logout</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"app_logout"</span>/&gt;</span>

            <span class="hljs-comment">&lt;!-- use "target" to configure where to redirect after logout
            &lt;logout path="app_logout" target="app_any_route"/&gt;
            --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-b3ba6cf01084162aa8fc4633b395a050da7a8abf" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>);
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mainFirewall</span><span class="hljs-operator">-&gt;</span>logout()
        <span class="hljs-comment">// the argument can be either a route name or a path</span>
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'app_logout'</span>)

        <span class="hljs-comment">// where to redirect after logout</span>
        <span class="hljs-comment">// -&gt;target('app_any_route')</span>
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Next, you need to create a route for this URL (but not a controller):</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-4">
                    <button role="tab" type="button" data-language="php-attributes"
                aria-controls="configuration-block-tabpanel-bf8d572bef718151288ea24eb921d62fca91d584" aria-selected="true"
                data-active="true" >
                <span>Attributes</span>
            </button>
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-61cef5c5eed29c6a4112b55a7a574f377b9d81da" aria-selected="false"
                 tabindex="-1">
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-4e330781ed51ea50439d1cc345d9f152b9100d8b" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-d57e7ee292d9bc1b0ae070a25e7f6785069de846" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-bf8d572bef718151288ea24eb921d62fca91d584" aria-label="Attributes" class="configuration-codeblock" data-language="php-attributes" style="">
            <div translate="no" class="highlight-php-attributes highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-attributes php"><span class="hljs-comment">// src/Controller/SecurityController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/logout', name: 'app_logout', methods: ['GET'])]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// controller can be blank: it will never be called!</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-keyword">Exception</span>(<span class="hljs-string">'Don\'t forget to activate logout in security.yaml'</span>);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-61cef5c5eed29c6a4112b55a7a574f377b9d81da" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="display: none">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/routes.yaml</span>
<span class="hljs-attr">app_logout:</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">/logout</span>
    <span class="hljs-attr">methods:</span> <span class="hljs-string">GET</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-4e330781ed51ea50439d1cc345d9f152b9100d8b" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/routes.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">routes</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/routing"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/routing
        https://symfony.com/schema/routing/routing-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">route</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app_logout"</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/logout"</span> <span class="hljs-attr">methods</span>=<span class="hljs-string">"GET"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">routes</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-d57e7ee292d9bc1b0ae070a25e7f6785069de846" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/routes.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Loader</span>\<span class="hljs-title">Configurator</span>\<span class="hljs-title">RoutingConfigurator</span>;

<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(RoutingConfigurator <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>routes</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>routes</span><span class="hljs-operator">-&gt;</span>add(<span class="hljs-string">'app_logout'</span>, <span class="hljs-string">'/logout'</span>)
        <span class="hljs-operator">-&gt;</span>methods([<span class="hljs-string">'GET'</span>])
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>That's it! By sending a user to the <code translate="no" class="notranslate">app_logout</code> route (i.e. to <code translate="no" class="notranslate">/logout</code>)
Symfony will un-authenticate the current user and redirect them.</p>
<div class="section">
<h3 id="logout-programmatically">
    Logout programmatically
    <a class="headerlink" href="#logout-programmatically" title="Permalink to this headline">¶</a>
</h3>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Symfony\Bundle\SecurityBundle\Security</a>
class was introduced in Symfony 6.2. Prior to 6.2, it was called
<code translate="no" class="notranslate">Symfony<wbr>\Component<wbr>\Security<wbr>\Core<wbr>\Security</code>.</p>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php#method_logout" class="reference external" title="Symfony\Bundle\SecurityBundle\Security::logout()" rel="external noopener noreferrer" target="_blank">logout()</a>
method was introduced in Symfony 6.2.</p>
</div>
<p>You can logout user programmatically using the <code translate="no" class="notranslate">logout()</code> method of the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Security</a> helper:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/SecurityController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">SecurityController</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">SecurityBundle</span>\<span class="hljs-title">Security</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someAction</span><span class="hljs-params">(Security <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-comment">// logout the user in on the current firewall</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>logout();

        <span class="hljs-comment">// you can also disable the csrf logout</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>logout(<span class="hljs-keyword">false</span>);

        <span class="hljs-comment">// ... return $response (if set) or e.g. redirect to the homepage</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The user will be logout from the firewall of the request. If the request is
not behind a firewall a <code translate="no" class="notranslate">\LogicException</code> will be thrown.</p>
</div>
<div class="section">
<h3 id="customizing-logout">
    Customizing Logout
    <a class="headerlink" href="#customizing-logout" title="Permalink to this headline">¶</a>
</h3>
<p>In some cases you need to run extra logic upon logout (e.g. invalidate
some tokens) or want to customize what happens after a logout. During
logout, a <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/LogoutEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\LogoutEvent" rel="external noopener noreferrer" target="_blank">LogoutEvent</a>
is dispatched. Register an <a href="event_dispatcher.html" class="reference internal">event listener or subscriber</a>
to execute custom logic:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/EventListener/LogoutSubscriber.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">EventListener</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">EventDispatcher</span>\<span class="hljs-title">EventSubscriberInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">RedirectResponse</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Generator</span>\<span class="hljs-title">UrlGeneratorInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">LogoutEvent</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogoutSubscriber</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EventSubscriberInterface</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(
        private UrlGeneratorInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>urlGenerator</span>
    )</span> </span>{
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSubscribedEvents</span><span class="hljs-params">()</span>: <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [LogoutEvent<span class="hljs-operator">::</span>class =&gt; <span class="hljs-string">'onLogout'</span>];
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onLogout</span><span class="hljs-params">(LogoutEvent <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span>)</span>: <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// get the security token of the session that is about to be logged out</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>token</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getToken();

        <span class="hljs-comment">// get the current request</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>request</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getRequest();

        <span class="hljs-comment">// get the current response, if it is already set by another listener</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getResponse();

        <span class="hljs-comment">// configure a custom logout response to the homepage</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span> = <span class="hljs-keyword">new</span> RedirectResponse(
            <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>urlGenerator<span class="hljs-operator">-&gt;</span>generate(<span class="hljs-string">'homepage'</span>),
            RedirectResponse<span class="hljs-operator">::</span>HTTP_SEE_OTHER
        );
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>setResponse(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span>);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="retrieving-the-user-object"></span>
</div>
</div>
<div class="section">
<h2 id="fetching-the-user-object">
    Fetching the User Object
    <a class="headerlink" href="#fetching-the-user-object" title="Permalink to this headline">¶</a>
</h2>
<p>After authentication, the <code translate="no" class="notranslate">User</code> object of the current user can be
accessed via the <code translate="no" class="notranslate">getUser()</code> shortcut in the
<a href="controller.html#the-base-controller-class-services" class="reference internal">base controller</a>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProfileController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-comment">// usually you'll want to make sure the user is authenticated first,</span>
        <span class="hljs-comment">// see "Authorization" below</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>denyAccessUnlessGranted(<span class="hljs-string">'IS_AUTHENTICATED_FULLY'</span>);

        <span class="hljs-comment">// returns your User object, or null if the user is not authenticated</span>
        <span class="hljs-comment">// use inline documentation to tell your editor your exact User class</span>
        <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> \App\Entity\User $user */</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>getUser();

        <span class="hljs-comment">// Call whatever methods you've added to your User class</span>
        <span class="hljs-comment">// For example, if you added a getFirstName() method, you can use that.</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Response(<span class="hljs-string">'Well hi there '</span>.<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>getFirstName());
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="section">
<h3 id="fetching-the-user-from-a-service">
    Fetching the User from a Service
    <a class="headerlink" href="#fetching-the-user-from-a-service" title="Permalink to this headline">¶</a>
</h3>
<p>If you need to get the logged in user from a service, use the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Security</a> service:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Service/ExampleService.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">SecurityBundle</span>\<span class="hljs-title">Security</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleService</span>
</span>{
    <span class="hljs-comment">// Avoid calling getUser() in the constructor: auth may not</span>
    <span class="hljs-comment">// be complete yet. Instead, store the entire Security object.</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(
        private Security <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>,
    )</span></span>{
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someMethod</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// returns User object or null if not authenticated</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>security<span class="hljs-operator">-&gt;</span>getUser();

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/SecurityBundle/Security.php" class="reference external" title="Symfony\Bundle\SecurityBundle\Security" rel="external noopener noreferrer" target="_blank">Security</a> class
was introduced in Symfony 6.2. In previous Symfony versions this class was
defined in <code translate="no" class="notranslate">Symfony<wbr>\Component<wbr>\Security<wbr>\Core<wbr>\Security</code>.</p>
</div>
</div>
<div class="section">
<h3 id="fetch-the-user-in-a-template">
    Fetch the User in a Template
    <a class="headerlink" href="#fetch-the-user-in-a-template" title="Permalink to this headline">¶</a>
</h3>
<p>In a Twig Template the user object is available via the <code translate="no" class="notranslate">app.user</code> variable
thanks to the <a href="templates.html#twig-app-variable" class="reference internal">Twig global app variable</a>:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">if</span></span> is_granted('IS_AUTHENTICATED_FULLY') %}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: </span><span class="hljs-template-variable">{{ app.user.email }}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endif</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="denying-access-roles-and-other-authorization"></span>
<span id="security-access-control"></span>
</div>
</div>
<div class="section">
<h2 id="access-control-authorization">
    Access Control (Authorization)
    <a class="headerlink" href="#access-control-authorization" title="Permalink to this headline">¶</a>
</h2>
<p>Users can now log in to your app using your login form. Great! Now, you need to learn
how to deny access and work with the User object. This is called <strong>authorization</strong>,
and its job is to decide if a user can access some resource (a URL, a model object,
a method call, ...).</p>
<p>The process of authorization has two different sides:</p>
<ol class="arabic">
    <li>The user receives a specific role when logging in (e.g. <code translate="no" class="notranslate">ROLE_ADMIN</code>).</li>
<li>You add code so that a resource (e.g. URL, controller) requires a specific
&quot;attribute&quot; (e.g. a role like <code translate="no" class="notranslate">ROLE_ADMIN</code>) in order to be accessed.</li>
</ol>
<div class="section">
<h3 id="roles">
    Roles
    <a class="headerlink" href="#roles" title="Permalink to this headline">¶</a>
</h3>
<p>When a user logs in, Symfony calls the <code translate="no" class="notranslate">getRoles()</code> method on your <code translate="no" class="notranslate">User</code>
object to determine which roles this user has. In the <code translate="no" class="notranslate">User</code> class that
was generated earlier, the roles are an array that's stored in the
database and every user is <em>always</em> given at least one role: <code translate="no" class="notranslate">ROLE_USER</code>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Entity/User.php</span>

<span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">#[ORM\Column(type: 'json')]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span> = [];

    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRoles</span><span class="hljs-params">()</span>: <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>roles;
        <span class="hljs-comment">// guarantee every user at least has ROLE_USER</span>
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>[] = <span class="hljs-string">'ROLE_USER'</span>;

        <span class="hljs-keyword">return</span> array_unique(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>roles</span>);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This is a nice default, but you can do <em>whatever</em> you want to determine which roles
a user should have. The only rule is that every role <strong>must start with</strong> the
<code translate="no" class="notranslate">ROLE_</code> prefix - otherwise, things won't work as expected. Other than that,
a role is just a string and you can invent whatever you need (e.g. <code translate="no" class="notranslate">ROLE_PRODUCT_ADMIN</code>).</p>
<p>You'll use these roles next to grant access to specific sections of your site.</p>
<span id="security-role-hierarchy"></span>
<div class="section">
<h4 id="hierarchical-roles">
    Hierarchical Roles
    <a class="headerlink" href="#hierarchical-roles" title="Permalink to this headline">¶</a>
</h4>
<p>Instead of giving many roles to each user, you can define role inheritance
rules by creating a role hierarchy:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-98051c0a02802ca8e39edf2403cbfae9967cc465" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-314d715145d0d136c475841d028ece48201cbcc3" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-2ec4666729575ba678fa8c05be2e33c933597a9b" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-98051c0a02802ca8e39edf2403cbfae9967cc465" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">role_hierarchy:</span>
        <span class="hljs-attr">ROLE_ADMIN:</span>       <span class="hljs-string">ROLE_USER</span>
        <span class="hljs-attr">ROLE_SUPER_ADMIN:</span> <span class="hljs-string">[ROLE_ADMIN,</span> <span class="hljs-string">ROLE_ALLOWED_TO_SWITCH]</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-314d715145d0d136c475841d028ece48201cbcc3" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">role</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ROLE_ADMIN"</span>&gt;</span>ROLE_USER<span class="hljs-tag">&lt;/<span class="hljs-name">role</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">role</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ROLE_SUPER_ADMIN"</span>&gt;</span>ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH<span class="hljs-tag">&lt;/<span class="hljs-name">role</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-2ec4666729575ba678fa8c05be2e33c933597a9b" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>roleHierarchy(<span class="hljs-string">'ROLE_ADMIN'</span>, [<span class="hljs-string">'ROLE_USER'</span>]);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>roleHierarchy(<span class="hljs-string">'ROLE_SUPER_ADMIN'</span>, [<span class="hljs-string">'ROLE_ADMIN'</span>, <span class="hljs-string">'ROLE_ALLOWED_TO_SWITCH'</span>]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Users with the <code translate="no" class="notranslate">ROLE_ADMIN</code> role will also have the <code translate="no" class="notranslate">ROLE_USER</code> role.
Users with <code translate="no" class="notranslate">ROLE_SUPER_ADMIN</code>, will automatically have <code translate="no" class="notranslate">ROLE_ADMIN</code>,
<code translate="no" class="notranslate">ROLE_ALLOWED_TO_SWITCH</code> and <code translate="no" class="notranslate">ROLE_USER</code> (inherited from
<code translate="no" class="notranslate">ROLE_ADMIN</code>).</p>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>For role hierarchy to work, do not use <code translate="no" class="notranslate">$user-&gt;getRoles()</code> manually.
For example, in a controller extending from the <a href="controller.html#the-base-controller-class-services" class="reference internal">base controller</a>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// BAD - $user-&gt;getRoles() will not know about the role hierarchy</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hasAccess</span> = in_array(<span class="hljs-string">'ROLE_ADMIN'</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>user</span><span class="hljs-operator">-&gt;</span>getRoles());

<span class="hljs-comment">// GOOD - use of the normal security methods</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>hasAccess</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>isGranted(<span class="hljs-string">'ROLE_ADMIN'</span>);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>denyAccessUnlessGranted(<span class="hljs-string">'ROLE_ADMIN'</span>);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The <code translate="no" class="notranslate">role_hierarchy</code> values are static - you can't, for example, store the
role hierarchy in a database. If you need that, create a custom
<a href="security/voters.html" class="reference internal">security voter</a> that looks for the user roles
in the database.</p>
</div>
<span id="security-role-authorization"></span>
</div>
</div>
<div class="section">
<h3 id="add-code-to-deny-access">
    Add Code to Deny Access
    <a class="headerlink" href="#add-code-to-deny-access" title="Permalink to this headline">¶</a>
</h3>
<p>There are <strong>two</strong> ways to deny access to something:</p>
<ol class="arabic">
    <li><a href="security.html#security-authorization-access-control" class="reference internal">access_control in security.yaml</a>
allows you to protect URL patterns (e.g. <code translate="no" class="notranslate">/admin/*</code>). Simpler, but less flexible;</li>
<li><a href="security.html#security-securing-controller" class="reference internal">in your controller (or other code)</a>.</li>
</ol>
<span id="security-authorization-access-control"></span>
<div class="section">
<h4 id="securing-url-patterns-access-control">
    Securing URL patterns (access_control)
    <a class="headerlink" href="#securing-url-patterns-access-control" title="Permalink to this headline">¶</a>
</h4>
<p>The most basic way to secure part of your app is to secure an entire URL pattern
in <code translate="no" class="notranslate">security.yaml</code>. For example, to require <code translate="no" class="notranslate">ROLE_ADMIN</code> for all URLs that
start with <code translate="no" class="notranslate">/admin</code>, you can:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-12d8e210841d4b252413e26f9bd7dae1cd4b245b" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-aad20bbf2df10e19412539a0e1ccc29c764ad31a" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-d231dc25955aa9d0b1c1fd8ceb67170a6f6a98f1" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-12d8e210841d4b252413e26f9bd7dae1cd4b245b" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">firewalls:</span>
        <span class="hljs-comment"># ...</span>
        <span class="hljs-attr">main:</span>
            <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">access_control:</span>
        <span class="hljs-comment"># require ROLE_ADMIN for /admin*</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">'^/admin'</span><span class="hljs-string">,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">ROLE_ADMIN</span> <span class="hljs-string">}</span>

        <span class="hljs-comment"># or require ROLE_ADMIN or IS_AUTHENTICATED_FULLY for /admin*</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">'^/admin'</span><span class="hljs-string">,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">[IS_AUTHENTICATED_FULLY,</span> <span class="hljs-string">ROLE_ADMIN]</span> <span class="hljs-string">}</span>

        <span class="hljs-comment"># the 'path' value can be any valid regular expression</span>
        <span class="hljs-comment"># (this one will match URLs like /api/post/7298 and /api/comment/528491)</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">^/api/(post|comment)/\d+$,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">ROLE_USER</span> <span class="hljs-string">}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-aad20bbf2df10e19412539a0e1ccc29c764ad31a" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">firewall</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- ... --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">firewall</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- require ROLE_ADMIN for /admin* --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"ROLE_ADMIN"</span>/&gt;</span>

        <span class="hljs-comment">&lt;!-- require ROLE_ADMIN or IS_AUTHENTICATED_FULLY for /admin* --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">role</span>&gt;</span>ROLE_ADMIN<span class="hljs-tag">&lt;/<span class="hljs-name">role</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">role</span>&gt;</span>IS_AUTHENTICATED_FULLY<span class="hljs-tag">&lt;/<span class="hljs-name">role</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">rule</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- the 'path' value can be any valid regular expression
             (this one will match URLs like /api/post/7298 and /api/comment/528491) --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/api/(post|comment)/\d+$"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"ROLE_USER"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-d231dc25955aa9d0b1c1fd8ceb67170a6f6a98f1" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>enableAuthenticatorManager(<span class="hljs-keyword">true</span>);

    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>firewall(<span class="hljs-string">'main'</span>)
    <span class="hljs-comment">// ...</span>
    ;

    <span class="hljs-comment">// require ROLE_ADMIN for /admin*</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_ADMIN'</span>]);

    <span class="hljs-comment">// require ROLE_ADMIN or IS_AUTHENTICATED_FULLY for /admin*</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_ADMIN'</span>, <span class="hljs-string">'IS_AUTHENTICATED_FULLY'</span>]);

    <span class="hljs-comment">// the 'path' value can be any valid regular expression</span>
    <span class="hljs-comment">// (this one will match URLs like /api/post/7298 and /api/comment/528491)</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/api/(post|comment)/\d+$'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_USER'</span>]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>You can define as many URL patterns as you need - each is a regular expression.
<strong>BUT</strong>, only <strong>one</strong> will be matched per request: Symfony starts at the top of
the list and stops when it finds the first match:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-9e7639322e74611f8d864445c5413112c0b41b0f" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-4a227c0648c32ec2736f115569ac43899a15ed8c" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-b9e720c41563719c3b6ed8adcbe635aa8b4ba8de" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-9e7639322e74611f8d864445c5413112c0b41b0f" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">access_control:</span>
        <span class="hljs-comment"># matches /admin/users/*</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">'^/admin/users'</span><span class="hljs-string">,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">ROLE_SUPER_ADMIN</span> <span class="hljs-string">}</span>

        <span class="hljs-comment"># matches /admin/* except for anything matching the above rule</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">'^/admin'</span><span class="hljs-string">,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">ROLE_ADMIN</span> <span class="hljs-string">}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-4a227c0648c32ec2736f115569ac43899a15ed8c" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin/users"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"ROLE_SUPER_ADMIN"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"ROLE_ADMIN"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-b9e720c41563719c3b6ed8adcbe635aa8b4ba8de" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin/users'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_SUPER_ADMIN'</span>]);

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_ADMIN'</span>]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Prepending the path with <code translate="no" class="notranslate">^</code> means that only URLs <em>beginning</em> with the
pattern are matched. For example, a path of <code translate="no" class="notranslate">/admin</code> (without the <code translate="no" class="notranslate">^</code>)
would match <code translate="no" class="notranslate">/admin/foo</code> but would also match URLs like <code translate="no" class="notranslate">/foo/admin</code>.</p>
<p>Each <code translate="no" class="notranslate">access_control</code> can also match on IP address, hostname and HTTP methods.
It can also be used to redirect a user to the <code translate="no" class="notranslate">https</code> version of a URL pattern.
For more complex needs, you can also use a service implementing <code translate="no" class="notranslate">RequestMatcherInterface</code>.</p>
<p>See <a href="security/access_control.html" class="reference internal">How Does the Security access_control Work?</a>.</p>
<span id="security-securing-controller"></span>
</div>
<div class="section">
<h4 id="securing-controllers-and-other-code">
    Securing Controllers and other Code
    <a class="headerlink" href="#securing-controllers-and-other-code" title="Permalink to this headline">¶</a>
</h4>
<p>You can deny access from inside a controller:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/AdminController.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adminDashboard</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>denyAccessUnlessGranted(<span class="hljs-string">'ROLE_ADMIN'</span>);

    <span class="hljs-comment">// or add an optional message - seen by developers</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>denyAccessUnlessGranted(<span class="hljs-string">'ROLE_ADMIN'</span>, <span class="hljs-keyword">null</span>, <span class="hljs-string">'User tried to access a page without having ROLE_ADMIN'</span>);
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>That's it! If access is not granted, a special
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Exception/AccessDeniedException.php" class="reference external" title="Symfony\Component\Security\Core\Exception\AccessDeniedException" rel="external noopener noreferrer" target="_blank">AccessDeniedException</a>
is thrown and no more code in your controller is called. Then, one of two things
will happen:</p>
<ol class="arabic">
    <li>If the user isn't logged in yet, they will be asked to log in (e.g. redirected
to the login page).</li>
<li>If the user <em>is</em> logged in, but does <em>not</em> have the <code translate="no" class="notranslate">ROLE_ADMIN</code> role, they'll
be shown the 403 access denied page (which you can
<a href="controller/error_pages.html#controller-error-pages-by-status-code" class="reference internal">customize</a>).</li>
</ol>
<span id="security-securing-controller-annotations"></span>
<p>Another way to secure one or more controller actions is to use an attribute.
In the following example, all controller actions will require the
<code translate="no" class="notranslate">ROLE_ADMIN</code> permission, except for <code translate="no" class="notranslate">adminDashboard()</code>, which will require
the <code translate="no" class="notranslate">ROLE_SUPER_ADMIN</code> permission:</p>
<div translate="no" class="highlight-php-attributes highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php-attributes php"><span class="hljs-comment">// src/Controller/AdminController.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Attribute</span>\<span class="hljs-title">IsGranted</span>;

<span class="hljs-comment">#[IsGranted('ROLE_ADMIN')]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AdminController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">// Optionally, you can set a custom message that will be displayed to the user</span>
    <span class="hljs-comment">#[IsGranted('ROLE_SUPER_ADMIN', message: 'You are not allowed to access the admin dashboard.')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adminDashboard</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>If you want to use a custom status code instead of the default one (which
is 403), this can be done by setting with the <code translate="no" class="notranslate">statusCode</code> argument:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/AdminController.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Attribute</span>\<span class="hljs-title">IsGranted</span>;

<span class="hljs-comment">#[IsGranted('ROLE_ADMIN', statusCode: 423)]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AdminController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">// ...</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can also set the internal exception code of the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Exception/AccessDeniedException.php" class="reference external" title="Symfony\Component\Security\Core\Exception\AccessDeniedException" rel="external noopener noreferrer" target="_blank">AccessDeniedException</a>
that is thrown with the <code translate="no" class="notranslate">exceptionCode</code> argument:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/AdminController.php</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Attribute</span>\<span class="hljs-title">IsGranted</span>;

<span class="hljs-comment">#[IsGranted('ROLE_ADMIN', statusCode: 403, exceptionCode: 10010)]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AdminController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">// ...</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">#[IsGranted()]</code> attribute was introduced in Symfony 6.2.</p>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.3</span>
    </p><p>The <code translate="no" class="notranslate">exceptionCode</code> argument of the <code translate="no" class="notranslate">#[IsGranted()]</code> attribute was
introduced in Symfony 6.3.</p>
</div>
<span id="security-template"></span>
</div>
<div class="section">
<h4 id="access-control-in-templates">
    Access Control in Templates
    <a class="headerlink" href="#access-control-in-templates" title="Permalink to this headline">¶</a>
</h4>
<p>If you want to check if the current user has a certain role, you can use
the built-in <code translate="no" class="notranslate">is_granted()</code> helper function in any Twig template:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">if</span></span> is_granted('ROLE_ADMIN') %}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"..."</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endif</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="security-isgranted"></span>
</div>
<div class="section">
<h4 id="securing-other-services">
    Securing other Services
    <a class="headerlink" href="#securing-other-services" title="Permalink to this headline">¶</a>
</h4>
<p>You can check access <em>anywhere</em> in your code by injecting the <code translate="no" class="notranslate">Security</code>
service. For example, suppose you have a <code translate="no" class="notranslate">SalesReportManager</code> service and you
want to include extra details only for users that have a <code translate="no" class="notranslate">ROLE_SALES_ADMIN</code> role:</p>
<div translate="no" class="highlight-diff notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs diff">// src/SalesReport/SalesReportManager.php

  // ...
  use Symfony\Component\Security\Core\Exception\AccessDeniedException;
<span class="hljs-addition">+ use Symfony\Bundle\SecurityBundle\Security;</span>

  class SalesReportManager
  {
<span class="hljs-addition">+     public function __construct(</span>
<span class="hljs-addition">+         Security $security,</span>
<span class="hljs-addition">+     ) {</span>
<span class="hljs-addition">+     }</span>

      public function generateReport()
      {
          $salesData = [];

<span class="hljs-addition">+         if ($this-&gt;security-&gt;isGranted('ROLE_SALES_ADMIN')) {</span>
<span class="hljs-addition">+             $salesData['top_secret_numbers'] = rand();</span>
<span class="hljs-addition">+         }</span>

          // ...
      }

      // ...
  }</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>If you're using the <a href="service_container.html#service-container-services-load-example" class="reference internal">default services.yaml configuration</a>,
Symfony will automatically pass the <code translate="no" class="notranslate">security.helper</code> to your service
thanks to autowiring and the <code translate="no" class="notranslate">Security</code> type-hint.</p>
<p>You can also use a lower-level
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Authorization/AuthorizationCheckerInterface.php" class="reference external" title="Symfony\Component\Security\Core\Authorization\AuthorizationCheckerInterface" rel="external noopener noreferrer" target="_blank">AuthorizationCheckerInterface</a>
service. It does the same thing as <code translate="no" class="notranslate">Security</code>, but allows you to type-hint a
more-specific interface.</p>
</div>
</div>
<div class="section">
<h3 id="allowing-unsecured-access-i-e-anonymous-users">
    Allowing Unsecured Access (i.e. Anonymous Users)
    <a class="headerlink" href="#allowing-unsecured-access-i-e-anonymous-users" title="Permalink to this headline">¶</a>
</h3>
<p>When a visitor isn't yet logged in to your website, they are treated as
&quot;unauthenticated&quot; and don't have any roles. This will block them from
visiting your pages if you defined an <code translate="no" class="notranslate">access_control</code> rule.</p>
<p>In the <code translate="no" class="notranslate">access_control</code> configuration, you can use the <code translate="no" class="notranslate">PUBLIC_ACCESS</code>
security attribute to exclude some routes for unauthenticated access (e.g.
the login page):</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-5d64a87f5d661c09f5299576be23bf6a2fb0c694" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-f05bcc41a221ce43a1b15375350ebf5c68e4b57c" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-ca84df81e62122db1c59ded855dce2c2430a4838" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-5d64a87f5d661c09f5299576be23bf6a2fb0c694" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/security.yaml</span>
<span class="hljs-attr">security:</span>

    <span class="hljs-comment"># ...</span>
    <span class="hljs-attr">access_control:</span>
        <span class="hljs-comment"># allow unauthenticated users to access the login form</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">^/admin/login,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">PUBLIC_ACCESS</span> <span class="hljs-string">}</span>

        <span class="hljs-comment"># but require authentication for all other admin routes</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">{</span> <span class="hljs-attr">path:</span> <span class="hljs-string">^/admin,</span> <span class="hljs-attr">roles:</span> <span class="hljs-string">ROLE_ADMIN</span> <span class="hljs-string">}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-f05bcc41a221ce43a1b15375350ebf5c68e4b57c" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/security.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">srv:container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/security"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:srv</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/security
        https://symfony.com/schema/dic/security/security-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">config</span> <span class="hljs-attr">enable-authenticator-manager</span>=<span class="hljs-string">"true"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">access-control</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- allow unauthenticated users to access the login form --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin/login"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"PUBLIC_ACCESS"</span>/&gt;</span>

            <span class="hljs-comment">&lt;!-- but require authentication for all other admin routes --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"^/admin"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"ROLE_ADMIN"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">access-control</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">srv:container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-ca84df81e62122db1c59ded855dce2c2430a4838" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/security.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Authorization</span>\<span class="hljs-title">Voter</span>\<span class="hljs-title">AuthenticatedVoter</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">SecurityConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(SecurityConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>enableAuthenticatorManager(<span class="hljs-keyword">true</span>);
    <span class="hljs-comment">// ....</span>

    <span class="hljs-comment">// allow unauthenticated users to access the login form</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin/login'</span>)
        <span class="hljs-operator">-&gt;</span>roles([AuthenticatedVoter<span class="hljs-operator">::</span>PUBLIC_ACCESS])
    ;

    <span class="hljs-comment">// but require authentication for all other admin routes</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>security</span><span class="hljs-operator">-&gt;</span>accessControl()
        <span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'^/admin'</span>)
        <span class="hljs-operator">-&gt;</span>roles([<span class="hljs-string">'ROLE_ADMIN'</span>])
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
<div class="section">
<h3 id="granting-anonymous-users-access-in-a-custom-voter">
    Granting Anonymous Users Access in a Custom Voter
    <a class="headerlink" href="#granting-anonymous-users-access-in-a-custom-voter" title="Permalink to this headline">¶</a>
</h3>
<p>If you're using a <a href="security/voters.html" class="reference internal">custom voter</a>, you can allow
anonymous users access by checking if there is no user set on the token:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Security/PostVoter.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Security</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Authentication</span>\<span class="hljs-title">Token</span>\<span class="hljs-title">TokenInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Authentication</span>\<span class="hljs-title">User</span>\<span class="hljs-title">UserInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Security</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Authorization</span>\<span class="hljs-title">Voter</span>\<span class="hljs-title">Voter</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostVoter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Voter</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">voteOnAttribute</span><span class="hljs-params">(string <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>attribute</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>subject</span>, TokenInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>token</span>)</span>: <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// ...</span>

        <span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>token</span><span class="hljs-operator">-&gt;</span>getUser() <span class="hljs-keyword">instanceof</span> UserInterface) {
            <span class="hljs-comment">// the user is not authenticated, e.g. only allow them to</span>
            <span class="hljs-comment">// see public posts</span>
            <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>subject</span><span class="hljs-operator">-&gt;</span>isPublic();
        }
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="setting-individual-user-permissions">
    Setting Individual User Permissions
    <a class="headerlink" href="#setting-individual-user-permissions" title="Permalink to this headline">¶</a>
</h3>
<p>Most applications require more specific access rules. For instance, a user
should be able to only edit their <em>own</em> comments on a blog. Voters allow you
to write <em>whatever</em> business logic you need to determine access. Using
these voters is similar to the role-based access checks implemented in the
previous chapters. Read <a href="security/voters.html" class="reference internal">How to Use Voters to Check User Permissions</a> to learn how to implement
your own voter.</p>
<span id="checking-to-see-if-a-user-is-logged-in-is-authenticated-fully"></span>
</div>
<div class="section">
<h3 id="checking-to-see-if-a-user-is-logged-in">
    Checking to see if a User is Logged In
    <a class="headerlink" href="#checking-to-see-if-a-user-is-logged-in" title="Permalink to this headline">¶</a>
</h3>
<p>If you <em>only</em> want to check if a user is logged in (you don't care about roles),
you have the following two options.</p>
<p>Firstly, if you've given <em>every</em> user <code translate="no" class="notranslate">ROLE_USER</code>, you can check for that role.</p>
<p>Secondly, you can use the special &quot;attribute&quot; <code translate="no" class="notranslate">IS_AUTHENTICATED_FULLY</code> in place of a role:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// ...</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adminDashboard</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>denyAccessUnlessGranted(<span class="hljs-string">'IS_AUTHENTICATED'</span>);

    <span class="hljs-comment">// ...</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can use <code translate="no" class="notranslate">IS_AUTHENTICATED</code> anywhere roles are used: like
<code translate="no" class="notranslate">access_control</code> or in Twig.</p>
<p><code translate="no" class="notranslate">IS_AUTHENTICATED</code> isn't a role, but it kind of acts like one, and every
user that has logged in will have this. Actually, there are some special attributes
like this:</p>
<ul>
    <li><code translate="no" class="notranslate">IS_AUTHENTICATED_REMEMBERED</code>: <em>all</em> logged in users have this, even
if they are logged in because of a &quot;remember me cookie&quot;. Even if you don't
use the <a href="security/remember_me.html" class="reference internal">remember me functionality</a>,
you can use this to check if the user is logged in.</li>
<li><code translate="no" class="notranslate">IS_AUTHENTICATED_FULLY</code>: This is similar to <code translate="no" class="notranslate">IS_AUTHENTICATED_REMEMBERED</code>,
but stronger. Users who are logged in only because of a &quot;remember me cookie&quot;
will have <code translate="no" class="notranslate">IS_AUTHENTICATED_REMEMBERED</code> but will not have <code translate="no" class="notranslate">IS_AUTHENTICATED_FULLY</code>.</li>
<li><code translate="no" class="notranslate">IS_REMEMBERED</code>: <em>Only</em> users authenticated using the
<a href="security/remember_me.html" class="reference internal">remember me functionality</a>, (i.e. a
remember-me cookie).</li>
<li><code translate="no" class="notranslate">IS_IMPERSONATOR</code>: When the current user is
<a href="security/impersonating_user.html" class="reference internal">impersonating</a> another user in this
session, this attribute will match.</li>
</ul>
<span id="user_session_refresh"></span>
</div>
</div>
<div class="section">
<h2 id="understanding-how-users-are-refreshed-from-the-session">
    Understanding how Users are Refreshed from the Session
    <a class="headerlink" href="#understanding-how-users-are-refreshed-from-the-session" title="Permalink to this headline">¶</a>
</h2>
<p>At the end of every request (unless your firewall is <code translate="no" class="notranslate">stateless</code>), your
<code translate="no" class="notranslate">User</code> object is serialized to the session. At the beginning of the next
request, it's deserialized and then passed to your user provider to &quot;refresh&quot; it
(e.g. Doctrine queries for a fresh user).</p>
<p>Then, the two User objects (the original from the session and the refreshed User
object) are &quot;compared&quot; to see if they are &quot;equal&quot;. By default, the core
<code translate="no" class="notranslate">AbstractToken</code> class compares the return values of the <code translate="no" class="notranslate">getPassword()</code>,
<code translate="no" class="notranslate">getSalt()</code> and <code translate="no" class="notranslate">getUserIdentifier()</code> methods. If any of these are different,
your user will be logged out. This is a security measure to make sure that malicious
users can be de-authenticated if core user data changes.</p>
<p>However, in some cases, this process can cause unexpected authentication problems.
If you're having problems authenticating, it could be that you <em>are</em> authenticating
successfully, but you immediately lose authentication after the first redirect.</p>
<p>In that case, review the serialization logic (e.g. the <code translate="no" class="notranslate">__serialize()</code> or
<code translate="no" class="notranslate">serialize()</code> methods) on your user class (if you have any) to make sure
that all the fields necessary are serialized and also exclude all the
fields not necessary to be serialized (e.g. Doctrine relations).</p>
<div class="section">
<h3 id="comparing-users-manually-with-equatableinterface">
    Comparing Users Manually with EquatableInterface
    <a class="headerlink" href="#comparing-users-manually-with-equatableinterface" title="Permalink to this headline">¶</a>
</h3>
<p>Or, if you need more control over the &quot;compare users&quot; process, make your User class
implement <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/User/EquatableInterface.php" class="reference external" title="Symfony\Component\Security\Core\User\EquatableInterface" rel="external noopener noreferrer" target="_blank">EquatableInterface</a>.
Then, your <code translate="no" class="notranslate">isEqualTo()</code> method will be called when comparing users instead
of the core logic.</p>
</div>
</div>
<div class="section">
<h2 id="security-events">
    Security Events
    <a class="headerlink" href="#security-events" title="Permalink to this headline">¶</a>
</h2>
<p>During the authentication process, multiple events are dispatched that allow you
to hook into the process or customize the response sent back to the user. You
can do this by creating an <a href="event_dispatcher.html" class="reference internal">event listener or subscriber</a>
for these events.</p>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Every Security firewall has its own event dispatcher
(<code translate="no" class="notranslate">security.event_dispatcher.FIREWALLNAME</code>). Events are dispatched on
both the global and the firewall-specific dispatcher. You can register
on the firewall dispatcher if you want your listener to only be
called for a specific firewall. For instance, if you have an <code translate="no" class="notranslate">api</code>
and <code translate="no" class="notranslate">main</code> firewall, use this configuration to register only on the
logout event in the <code translate="no" class="notranslate">main</code> firewall:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-ed5b48b9ab36fbc6949f635043e6cbff7a5c0cc4" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-76bf222f6aef977af01428ee03399aceeb923251" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-00012e0aa7f77d6bdbf329625327b4569a8ef95e" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-ed5b48b9ab36fbc6949f635043e6cbff7a5c0cc4" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/services.yaml</span>
<span class="hljs-attr">services:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-string">App\EventListener\LogoutSubscriber:</span>
        <span class="hljs-attr">tags:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">kernel.event_subscriber</span>
              <span class="hljs-attr">dispatcher:</span> <span class="hljs-string">security.event_dispatcher.main</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-76bf222f6aef977af01428ee03399aceeb923251" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/services.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">services</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">service</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"App\EventListener\LogoutSubscriber"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tag</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"kernel.event_subscriber"</span>
                 <span class="hljs-attr">dispatcher</span>=<span class="hljs-string">"security.event_dispatcher.main"</span>
             /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">service</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">services</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-00012e0aa7f77d6bdbf329625327b4569a8ef95e" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/services.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">Loader</span>\<span class="hljs-title">Configurator</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">EventListener</span>\<span class="hljs-title">LogoutSubscriber</span>;

<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(ContainerConfigurator <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerConfigurator</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>services</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerConfigurator</span><span class="hljs-operator">-&gt;</span>services();

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>services</span><span class="hljs-operator">-&gt;</span>set(LogoutSubscriber<span class="hljs-operator">::</span>class)
        <span class="hljs-operator">-&gt;</span>tag(<span class="hljs-string">'kernel.event_subscriber'</span>, [
            <span class="hljs-string">'dispatcher'</span> =&gt; <span class="hljs-string">'security.event_dispatcher.main'</span>,
        ]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
<div class="section">
<h3 id="authentication-events">
    Authentication Events
    <a class="headerlink" href="#authentication-events" title="Permalink to this headline">¶</a>
</h3>
<object data="./_images/security/security_events.svg" type="image/svg+xml"></object>
<dl>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/CheckPassportEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\CheckPassportEvent" rel="external noopener noreferrer" target="_blank">CheckPassportEvent</a></dt>
        
        <dd>
                            Dispatched after the authenticator created the <a href="security/custom_authenticator.html#security-passport" class="reference internal">security passport</a>.
Listeners of this event do the actual authentication checks (like
checking the passport, validating the CSRF token, etc.)
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/AuthenticationTokenCreatedEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\AuthenticationTokenCreatedEvent" rel="external noopener noreferrer" target="_blank">AuthenticationTokenCreatedEvent</a></dt>
        
        <dd>
                            Dispatched after the passport was validated and the authenticator
created the security token (and user). This can be used in advanced use-cases
where you need to modify the created token (e.g. for multi factor
authentication).
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Core/Event/AuthenticationSuccessEvent.php" class="reference external" title="Symfony\Component\Security\Core\Event\AuthenticationSuccessEvent" rel="external noopener noreferrer" target="_blank">AuthenticationSuccessEvent</a></dt>
        
        <dd>
                            Dispatched when authentication is nearing success. This is the last
event that can make an authentication fail by throwing an
<code translate="no" class="notranslate">AuthenticationException</code>.
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/LoginSuccessEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\LoginSuccessEvent" rel="external noopener noreferrer" target="_blank">LoginSuccessEvent</a></dt>
        
        <dd>
                            Dispatched after authentication was fully successful. Listeners to this
event can modify the response sent back to the user.
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/LoginFailureEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\LoginFailureEvent" rel="external noopener noreferrer" target="_blank">LoginFailureEvent</a></dt>
        
        <dd>
                            Dispatched after an <code translate="no" class="notranslate">AuthenticationException</code> was thrown during
authentication. Listeners to this event can modify the error response
sent back to the user.
                    </dd>
    </dl>
</div>
<div class="section">
<h3 id="other-events">
    Other Events
    <a class="headerlink" href="#other-events" title="Permalink to this headline">¶</a>
</h3>
<dl>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/LogoutEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\LogoutEvent" rel="external noopener noreferrer" target="_blank">LogoutEvent</a></dt>
        
        <dd>
                            Dispatched just before a user logs out of your application. See
<a href="security.html#security-logging-out" class="reference internal">Security</a>.
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/TokenDeauthenticatedEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\TokenDeauthenticatedEvent" rel="external noopener noreferrer" target="_blank">TokenDeauthenticatedEvent</a></dt>
        
        <dd>
                            Dispatched when a user is deauthenticated, for instance because the
password was changed. See <a href="security.html#user_session_refresh" class="reference internal">Security</a>.
                    </dd>
                        <dt><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Security/Http/Event/SwitchUserEvent.php" class="reference external" title="Symfony\Component\Security\Http\Event\SwitchUserEvent" rel="external noopener noreferrer" target="_blank">SwitchUserEvent</a></dt>
        
        <dd>
                            Dispatched after impersonation is completed. See
<a href="security/impersonating_user.html" class="reference internal">How to Impersonate a User</a>.
                    </dd>
    </dl>
</div>
</div>
<div class="section">
<h2 id="frequently-asked-questions">
    Frequently Asked Questions
    <a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a>
</h2>
<dl>
                        <dt><strong>Can I have Multiple Firewalls?</strong></dt>
        
        <dd>
                            Yes! However, each firewall is like a separate security system: being authenticated
in one firewall doesn't make you authenticated in another one. Each firewall can have
multiple ways of allowing authentication (e.g. form login, and API key authentication).
If you want to share authentication between firewalls, you have to explicitly
specify the same <a href="reference/configuration/security.html#reference-security-firewall-context" class="reference internal">Security Configuration Reference (SecurityBundle)</a> for different firewalls.
                    </dd>
                        <dt><strong>Security doesn't seem to work on my Error Pages</strong></dt>
        
        <dd>
                            As routing is done <em>before</em> security, 404 error pages are not covered by
any firewall. This means you can't check for security or even access the
user object on these pages. See <a href="controller/error_pages.html" class="reference internal">How to Customize Error Pages</a>
for more details.
                    </dd>
                        <dt><strong>My Authentication Doesn't Seem to Work: No Errors, but I'm Never Logged In</strong></dt>
        
        <dd>
                            Sometimes authentication may be successful, but after redirecting, you're
logged out immediately due to a problem loading the <code translate="no" class="notranslate">User</code> from the session.
To see if this is an issue, check your log file (<code translate="no" class="notranslate">var/log/dev.log</code>) for
the log message:
                    </dd>
                        <dt><strong>Cannot refresh token because user has changed</strong></dt>
        
        <dd>
                            If you see this, there are two possible causes. First, there may be a problem
loading your User from the session. See <a href="security.html#user_session_refresh" class="reference internal">Security</a>. Second,
if certain user information was changed in the database since the last page
refresh, Symfony will purposely log out the user for security reasons.
                    </dd>
    </dl>
</div>
<div class="section">
<h2 id="learn-more">
    Learn More
    <a class="headerlink" href="#learn-more" title="Permalink to this headline">¶</a>
</h2>
<div class="section">
<h3 id="authentication-identifying-logging-in-the-user">
    Authentication (Identifying/Logging in the User)
    <a class="headerlink" href="#authentication-identifying-logging-in-the-user" title="Permalink to this headline">¶</a>
</h3>
<div class="toctree-wrapper toc-size-lg"><ul class="toctree toctree-level-1 toctree-length-10"><li><a href="security/passwords.html">Password Hashing and Verification</a></li><li><a href="security/ldap.html">Authenticating against an LDAP server</a></li><li><a href="security/remember_me.html">How to Add "Remember Me" Login Functionality</a></li><li><a href="security/impersonating_user.html">How to Impersonate a User</a></li><li><a href="security/user_checkers.html">How to Create and Enable Custom User Checkers</a></li><li><a href="security/firewall_restriction.html">How to Restrict Firewalls to a Request</a></li><li><a href="security/csrf.html">How to Implement CSRF Protection</a></li><li><a href="security/form_login.html">Customizing the Form Login Authenticator Responses</a></li><li><a href="security/custom_authenticator.html">How to Write a Custom Authenticator</a></li><li><a href="security/entry_point.html">The Entry Point: Helping Users Start Authentication</a></li></ul></div>
</div>
<div class="section">
<h3 id="authorization-denying-access">
    Authorization (Denying Access)
    <a class="headerlink" href="#authorization-denying-access" title="Permalink to this headline">¶</a>
</h3>
<div class="toctree-wrapper toc-size-md"><ul class="toctree toctree-level-1 toctree-length-5"><li><a href="security/voters.html">How to Use Voters to Check User Permissions</a></li><li><a href="security/access_control.html">How Does the Security access_control Work?</a></li><li><a href="security/expressions.html">Using Expressions in Security Access Controls</a></li><li><a href="security/access_denied_handler.html">How to Customize Access Denied Responses</a></li><li><a href="security/force_https.html">How to Force HTTPS or HTTP for different URLs</a></li></ul></div>
</div>
</div>
</div>

                            </div>                    </div>
                                    </div>        </div>

    </section>

</div>


<script type="text/javascript" src="assets/js/theme.js"></script>
<script type="text/javascript" src="assets/js/badge_only.js"></script>

 
</body>
</html>