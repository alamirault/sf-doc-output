        
<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head><base href="/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
                                
    
    <link rel="stylesheet" href="assets/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/badge_only.css" type="text/css" />

</head>

<body class="wy-body-for-nav">
 <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">
                
                                                                                                    
                                                                                                                                                                        </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                                                                                                                                                                                                                                                                                                                            </div>
        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                                                        

        <div class="wy-nav-content">                <div class="rst-content">
                                        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">                            <div itemprop="articleBody">
                                    <div class="section">
<h1 id="sending-emails-with-mailer">
    Sending Emails with Mailer
    <a class="headerlink" href="#sending-emails-with-mailer" title="Permalink to this headline">¶</a>
</h1>
<div class="section">
<h2 id="installation">
    Installation
    <a class="headerlink" href="#installation" title="Permalink to this headline">¶</a>
</h2>
<p>Symfony's Mailer &amp; <a href="components/mime.html" class="reference internal">Mime</a> components form a <em>powerful</em> system
for creating and sending emails - complete with support for multipart messages, Twig
integration, CSS inlining, file attachments and a lot more. Get them installed with:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfony/mailer</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="mailer-transport-setup"></span>
</div>
<div class="section">
<h2 id="transport-setup">
    Transport Setup
    <a class="headerlink" href="#transport-setup" title="Permalink to this headline">¶</a>
</h2>
<p>Emails are delivered via a &quot;transport&quot;. Out of the box, you can deliver emails
over SMTP by configuring the DSN in your <code translate="no" class="notranslate">.env</code> file (the <code translate="no" class="notranslate">user</code>,
<code translate="no" class="notranslate">pass</code> and <code translate="no" class="notranslate">port</code> parameters are optional):</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash"><span class="hljs-comment"># .env</span>
MAILER_DSN=smtp://user:pass@smtp.example.com:port</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-265a8e1e510b9a5af43add63292e45259b43cf1a" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-e838865b361b006db3f5d2462d38f48186fddd95" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-a851648d138abadb6ccc054e2f457fcf1474211f" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-265a8e1e510b9a5af43add63292e45259b43cf1a" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">mailer:</span>
        <span class="hljs-attr">dsn:</span> <span class="hljs-string">'%env(MAILER_DSN)%'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-e838865b361b006db3f5d2462d38f48186fddd95" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/mailer.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span> <span class="hljs-attr">dsn</span>=<span class="hljs-string">"%env(MAILER_DSN)%"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-a851648d138abadb6ccc054e2f457fcf1474211f" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">Loader</span>\<span class="hljs-title">Configurator</span>\<span class="hljs-title">env</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">Loader</span>\<span class="hljs-title">Configurator</span>\<span class="hljs-title">ContainerConfigurator</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ContainerConfigurator <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerConfigurator</span>)</span>: <span class="hljs-title">void</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>containerConfigurator</span><span class="hljs-operator">-&gt;</span>extension(<span class="hljs-string">'framework'</span>, [
        <span class="hljs-string">'mailer'</span> =&gt; [
            <span class="hljs-string">'dsn'</span> =&gt; env(<span class="hljs-string">'MAILER_DSN'</span>),
        ],
    ]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>If the username, password or host contain any character considered special in a
URI (such as <code translate="no" class="notranslate">+</code>, <code translate="no" class="notranslate">@</code>, <code translate="no" class="notranslate">$</code>, <code translate="no" class="notranslate">#</code>, <code translate="no" class="notranslate">/</code>, <code translate="no" class="notranslate">:</code>, <code translate="no" class="notranslate">*</code>, <code translate="no" class="notranslate">!</code>), you must
encode them. See <a href="https://www.ietf.org/rfc/rfc3986.txt" class="reference external" rel="external noopener noreferrer" target="_blank">RFC 3986</a> for the full list of reserved characters or use the
<a href="https://secure.php.net/manual/en/function.urlencode.php" class="reference external" title="urlencode" rel="external noopener noreferrer" target="_blank">urlencode</a> function to encode them.</p>
</div>
<div class="section">
<h3 id="using-built-in-transports">
    Using Built-in Transports
    <a class="headerlink" href="#using-built-in-transports" title="Permalink to this headline">¶</a>
</h3>
<div class="table-wrapper">
<table>
            <thead>
                            <tr>
                                            <th>DSN protocol</th>
                                            <th>Example</th>
                                            <th>Description</th>
                                    </tr>
                    </thead>
        <tbody>
                    <tr>
                                    <td>smtp</td>
                                    <td><code translate="no" class="notranslate">smtp://user:pass@smtp.example.com:25</code></td>
                                    <td>Mailer uses an SMTP server to send emails</td>
                            </tr>
                    <tr>
                                    <td>sendmail</td>
                                    <td><code translate="no" class="notranslate">sendmail://default</code></td>
                                    <td>Mailer uses the local sendmail binary to send emails</td>
                            </tr>
                    <tr>
                                    <td>native</td>
                                    <td><code translate="no" class="notranslate">native://default</code></td>
                                    <td>Mailer uses the sendmail binary and options configured
in the <code translate="no" class="notranslate">sendmail_path</code> setting of <code translate="no" class="notranslate">php.ini</code>. On Windows
hosts, Mailer fallbacks to <code translate="no" class="notranslate">smtp</code> and <code translate="no" class="notranslate">smtp_port</code>
<code translate="no" class="notranslate">php.ini</code> settings when <code translate="no" class="notranslate">sendmail_path</code> is not configured.</td>
                            </tr>
            </tbody>
</table>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>When using <code translate="no" class="notranslate">native://default</code>, if <code translate="no" class="notranslate">php.ini</code> uses the <code translate="no" class="notranslate">sendmail -t</code>
command, you won't have error reporting and <code translate="no" class="notranslate">Bcc</code> headers won't be removed.
It's highly recommended to NOT use <code translate="no" class="notranslate">native://default</code> as you cannot control
how sendmail is configured (prefer using <code translate="no" class="notranslate">sendmail://default</code> if possible).</p>
</div>
</div>
<div class="section">
<h3 id="using-a-3rd-party-transport">
    Using a 3rd Party Transport
    <a class="headerlink" href="#using-a-3rd-party-transport" title="Permalink to this headline">¶</a>
</h3>
<p>Instead of using your own SMTP server or sendmail binary, you can send emails
via a third-party provider:</p>
<div class="table-wrapper">
<table>
            <thead>
                            <tr>
                                            <th>Service</th>
                                            <th>Install with</th>
                                    </tr>
                    </thead>
        <tbody>
                    <tr>
                                    <td>Amazon SES</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/amazon-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>Infobip</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/infobip-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>MailChimp</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/mailchimp-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>MailerSend</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/mailersend-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>Mailgun</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/mailgun-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>Mailjet</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/mailjet-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>MailPace</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/mail-pace-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>Postmark</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/postmark-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>SendGrid</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/sendgrid-mailer</code></td>
                            </tr>
                    <tr>
                                    <td>Sendinblue</td>
                                    <td><code translate="no" class="notranslate">composer require symfony/sendinblue-mailer</code></td>
                            </tr>
            </tbody>
</table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The Infobip integration was introduced in Symfony 6.2 and the <code translate="no" class="notranslate">MailPace</code>
integration was renamed in Symfony 6.2 (in previous Symfony versions it was
called <code translate="no" class="notranslate">OhMySMTP</code>).</p>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.3</span>
    </p><p>The MailerSend integration was introduced in Symfony 6.3.</p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>As a convenience, Symfony also provides support for Gmail (<code translate="no" class="notranslate">composer
require symfony/google-mailer</code>), but this should not be used in
production. In development, you should probably use an <a href="mailer.html#mail-catcher" class="reference internal">email catcher</a> instead. Note that most supported providers also offer a
free tier.</p>
</div>
<p>Each library includes a <a href="setup.html#symfony-flex" class="reference internal">Symfony Flex recipe</a> that will add
a configuration example to your <code translate="no" class="notranslate">.env</code> file. For example, suppose you want to
use SendGrid. First, install it:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfony/sendgrid-mailer</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You'll now have a new line in your <code translate="no" class="notranslate">.env</code> file that you can uncomment:</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash"><span class="hljs-comment"># .env</span>
MAILER_DSN=sendgrid://KEY@default</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The <code translate="no" class="notranslate">MAILER_DSN</code> isn't a <em>real</em> address: it's a convenient format that
offloads most of the configuration work to mailer. The <code translate="no" class="notranslate">sendgrid</code> scheme
activates the SendGrid provider that you just installed, which knows all about
how to deliver messages via SendGrid. The <em>only</em> part you need to change is the
<code translate="no" class="notranslate">KEY</code> placeholder.</p>
<p>Each provider has different environment variables that the Mailer uses to
configure the <em>actual</em> protocol, address and authentication for delivery. Some
also have options that can be configured with query parameters at the end of the
<code translate="no" class="notranslate">MAILER_DSN</code> - like <code translate="no" class="notranslate">?region=</code> for Amazon SES or Mailgun. Some providers support
sending via <code translate="no" class="notranslate">http</code>, <code translate="no" class="notranslate">api</code> or <code translate="no" class="notranslate">smtp</code>. Symfony chooses the best available
transport, but you can force to use one:</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash"><span class="hljs-comment"># .env</span>
<span class="hljs-comment"># force to use SMTP instead of HTTP (which is the default)</span>
MAILER_DSN=sendgrid+smtp://<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>SENDGRID_KEY</span>@default</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This table shows the full list of available DSN formats for each third
party provider:</p>
<div class="table-wrapper">
<table>
            <thead>
                            <tr>
                                            <th>Provider</th>
                                            <th>SMTP</th>
                                            <th>HTTP</th>
                                            <th>API</th>
                                    </tr>
                    </thead>
        <tbody>
                    <tr>
                                    <td>Amazon SES</td>
                                    <td><a href="ses+smtp://USERNAME:PASSWORD@default" class="reference external">ses+smtp://USERNAME:PASSWORD@default</a></td>
                                    <td><a href="ses+https://ACCESS_KEY:SECRET_KEY@default" class="reference external">ses+https://ACCESS_KEY:SECRET_KEY@default</a></td>
                                    <td><a href="ses+api://ACCESS_KEY:SECRET_KEY@default" class="reference external">ses+api://ACCESS_KEY:SECRET_KEY@default</a></td>
                            </tr>
                    <tr>
                                    <td>Google Gmail</td>
                                    <td><a href="gmail+smtp://USERNAME:APP-PASSWORD@default" class="reference external">gmail+smtp://USERNAME:APP-PASSWORD@default</a></td>
                                    <td>n/a</td>
                                    <td>n/a</td>
                            </tr>
                    <tr>
                                    <td>Mailchimp Mandrill</td>
                                    <td><a href="mandrill+smtp://USERNAME:PASSWORD@default" class="reference external">mandrill+smtp://USERNAME:PASSWORD@default</a></td>
                                    <td><a href="mandrill+https://KEY@default" class="reference external">mandrill+https://KEY@default</a></td>
                                    <td><a href="mandrill+api://KEY@default" class="reference external">mandrill+api://KEY@default</a></td>
                            </tr>
                    <tr>
                                    <td>Mailgun</td>
                                    <td><a href="mailgun+smtp://USERNAME:PASSWORD@default" class="reference external">mailgun+smtp://USERNAME:PASSWORD@default</a></td>
                                    <td><a href="mailgun+https://KEY:DOMAIN@default" class="reference external">mailgun+https://KEY:DOMAIN@default</a></td>
                                    <td><a href="mailgun+api://KEY:DOMAIN@default" class="reference external">mailgun+api://KEY:DOMAIN@default</a></td>
                            </tr>
                    <tr>
                                    <td>Mailjet</td>
                                    <td><a href="mailjet+smtp://ACCESS_KEY:SECRET_KEY@default" class="reference external">mailjet+smtp://ACCESS_KEY:SECRET_KEY@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="mailjet+api://ACCESS_KEY:SECRET_KEY@default?sandbox=false" class="reference external">mailjet+api://ACCESS_KEY:SECRET_KEY@default?sandbox=false</a></td>
                            </tr>
                    <tr>
                                    <td>MailPace</td>
                                    <td><a href="mailpace+api://API_TOKEN@default" class="reference external">mailpace+api://API_TOKEN@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="mailpace+api://API_TOKEN@default" class="reference external">mailpace+api://API_TOKEN@default</a></td>
                            </tr>
                    <tr>
                                    <td>Postmark</td>
                                    <td><a href="postmark+smtp://ID@default" class="reference external">postmark+smtp://ID@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="postmark+api://KEY@default" class="reference external">postmark+api://KEY@default</a></td>
                            </tr>
                    <tr>
                                    <td>Sendgrid</td>
                                    <td><a href="sendgrid+smtp://KEY@default" class="reference external">sendgrid+smtp://KEY@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="sendgrid+api://KEY@default" class="reference external">sendgrid+api://KEY@default</a></td>
                            </tr>
                    <tr>
                                    <td>Sendinblue</td>
                                    <td><a href="sendinblue+smtp://USERNAME:PASSWORD@default" class="reference external">sendinblue+smtp://USERNAME:PASSWORD@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="sendinblue+api://KEY@default" class="reference external">sendinblue+api://KEY@default</a></td>
                            </tr>
                    <tr>
                                    <td>Infobip</td>
                                    <td><a href="infobip+smtp://KEY@default" class="reference external">infobip+smtp://KEY@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="infobip+api://KEY@BASE_URL" class="reference external">infobip+api://KEY@BASE_URL</a></td>
                            </tr>
                    <tr>
                                    <td>MailerSend</td>
                                    <td><a href="mailersend+smtp://KEY@default" class="reference external">mailersend+smtp://KEY@default</a></td>
                                    <td>n/a</td>
                                    <td><a href="mailersend+api://KEY@BASE_URL" class="reference external">mailersend+api://KEY@BASE_URL</a></td>
                            </tr>
            </tbody>
</table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.3</span>
    </p><p>The <code translate="no" class="notranslate">sandbox</code> option in <code translate="no" class="notranslate">Mailjet</code> API was introduced in Symfony 6.3.</p>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>If your credentials contain special characters, you must URL-encode them.
For example, the DSN <code translate="no" class="notranslate">ses+smtp://ABC1234:abc+12/345@default</code> should be
configured as <code translate="no" class="notranslate">ses+smtp://ABC1234:abc%2B12%2F345@default</code></p>
</div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>If you want to use the <code translate="no" class="notranslate">ses+smtp</code> transport together with <a href="messenger.html" class="reference internal">Messenger</a>
to <a href="mailer.html#mailer-sending-messages-async" class="reference internal">send messages in background</a>,
you need to add the <code translate="no" class="notranslate">ping_threshold</code> parameter to your <code translate="no" class="notranslate">MAILER_DSN</code> with
a value lower than <code translate="no" class="notranslate">10</code>: <code translate="no" class="notranslate">ses+smtp://USERNAME:PASSWORD@default?ping_threshold=9</code></p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>When using SMTP, the default timeout for sending a message before throwing an
exception is the value defined in the <a href="https://www.php.net/manual/en/filesystem.configuration.php#ini.default-socket-timeout" class="reference external" rel="external noopener noreferrer" target="_blank">default_socket_timeout</a> PHP.ini option.</p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>To use Google Gmail, you must have a Google Account with 2-Step-Verification (2FA)
enabled and you must use <a href="https://support.google.com/accounts/answer/185833" class="reference external" rel="external noopener noreferrer" target="_blank">App Password</a> to authenticate. Also note that Google
revokes your App Passwords when you change your Google Account password and then
you need to generate a new one.
Using other methods (like <code translate="no" class="notranslate">XOAUTH2</code> or the <code translate="no" class="notranslate">Gmail API</code>) are not supported currently.
You should use Gmail for testing purposes only and use a real provider in production.</p>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>If you want to override the default host for a provider (to debug an issue using
a service like <code translate="no" class="notranslate">requestbin.com</code>), change <code translate="no" class="notranslate">default</code> by your host:</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash"><span class="hljs-comment"># .env</span>
MAILER_DSN=mailgun+https://KEY:DOMAIN@requestbin.com</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Note that the protocol is <em>always</em> HTTPs and cannot be changed.</p>
</div>
</div>
<div class="section">
<h3 id="high-availability">
    High Availability
    <a class="headerlink" href="#high-availability" title="Permalink to this headline">¶</a>
</h3>
<p>Symfony's mailer supports <a href="https://en.wikipedia.org/wiki/High_availability" class="reference external" rel="external noopener noreferrer" target="_blank">high availability</a> via a technique called &quot;failover&quot;
to ensure that emails are sent even if one mailer server fails.</p>
<p>A failover transport is configured with two or more transports and the
<code translate="no" class="notranslate">failover</code> keyword:</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash">MAILER_DSN=<span class="hljs-string">"failover(postmark+api://ID@default sendgrid+smtp://KEY@default)"</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The failover-transport starts using the first transport and if it fails, it
will retry the same delivery with the next transports until one of them succeeds
(or until all of them fail).</p>
</div>
<div class="section">
<h3 id="load-balancing">
    Load Balancing
    <a class="headerlink" href="#load-balancing" title="Permalink to this headline">¶</a>
</h3>
<p>Symfony's mailer supports <a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)" class="reference external" rel="external noopener noreferrer" target="_blank">load balancing</a> via a technique called &quot;round-robin&quot;
to distribute the mailing workload across multiple transports.</p>
<p>A round-robin transport is configured with two or more transports and the
<code translate="no" class="notranslate">roundrobin</code> keyword:</p>
<div translate="no" class="highlight-env highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs env bash">MAILER_DSN=<span class="hljs-string">"roundrobin(postmark+api://ID@default sendgrid+smtp://KEY@default)"</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The round-robin transport starts with a <em>randomly</em> selected transport and
then switches to the next available transport for each subsequent email.</p>
<p>As with the failover transport, round-robin retries deliveries until
a transport succeeds (or all fail). In contrast to the failover transport,
it <em>spreads</em> the load across all its transports.</p>
</div>
<div class="section">
<h3 id="tls-peer-verification">
    TLS Peer Verification
    <a class="headerlink" href="#tls-peer-verification" title="Permalink to this headline">¶</a>
</h3>
<p>By default, SMTP transports perform TLS peer verification. This behavior is
configurable with the <code translate="no" class="notranslate">verify_peer</code> option. Although it's not recommended to
disable this verification for security reasons, it can be useful while developing
the application or when using a self-signed certificate:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtp://user:pass@smtp.example.com?verify_peer=0'</span>;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="other-options">
    Other Options
    <a class="headerlink" href="#other-options" title="Permalink to this headline">¶</a>
</h3>
<dl>
                        <dt><code translate="no" class="notranslate">command</code></dt>
        
        <dd>
                            <p class="first">Command to be executed by <code translate="no" class="notranslate">sendmail</code> transport:</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'sendmail://default?command=/usr/sbin/sendmail%20-oi%20-t'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    </dd>
                        <dt><code translate="no" class="notranslate">local_domain</code></dt>
        
        <dd>
                            <p class="first">The domain name to use in <code translate="no" class="notranslate">HELO</code> command:</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtps://smtp.example.com?local_domain=example.org'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    </dd>
                        <dt><code translate="no" class="notranslate">restart_threshold</code></dt>
        
        <dd>
                            <p class="first">The maximum number of messages to send before re-starting the transport. It
can be used together with <code translate="no" class="notranslate">restart_threshold_sleep</code>:</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtps://smtp.example.com?restart_threshold=10&amp;restart_threshold_sleep=1'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    </dd>
                        <dt><code translate="no" class="notranslate">restart_threshold_sleep</code></dt>
        
        <dd>
                            <p class="first">The number of seconds to sleep between stopping and re-starting the transport.
It's common to combine it with <code translate="no" class="notranslate">restart_threshold</code>:</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtps://smtp.example.com?restart_threshold=10&amp;restart_threshold_sleep=1'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    </dd>
                        <dt><code translate="no" class="notranslate">ping_threshold</code></dt>
        
        <dd>
                            <p class="first">The minimum number of seconds between two messages required to ping the server:</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtps://smtp.example.com?ping_threshold=200'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    </dd>
                        <dt><code translate="no" class="notranslate">max_per_second</code></dt>
        
        <dd>
                            <p class="first">The number of messages to send per second (0 to disable this limitation):</p>
                            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>dsn</span> = <span class="hljs-string">'smtps://smtp.example.com?max_per_second=2'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                            <div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">max_per_second</code> option was introduced in Symfony 6.2.</p>
</div>
                    </dd>
    </dl>
</div>
</div>
<div class="section">
<h2 id="creating-sending-messages">
    Creating &amp; Sending Messages
    <a class="headerlink" href="#creating-sending-messages" title="Permalink to this headline">¶</a>
</h2>
<p>To send an email, get a <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Mailer.php" class="reference external" title="Symfony\Component\Mailer\Mailer" rel="external noopener noreferrer" target="_blank">Mailer</a>
instance by type-hinting <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/MailerInterface.php" class="reference external" title="Symfony\Component\Mailer\MailerInterface" rel="external noopener noreferrer" target="_blank">MailerInterface</a>
and create an <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mime/Email.php" class="reference external" title="Symfony\Component\Mime\Email" rel="external noopener noreferrer" target="_blank">Email</a> object:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/MailerController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">MailerInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Email</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MailerController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/email')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendEmail</span><span class="hljs-params">(MailerInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span>)</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
            <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'hello@example.com'</span>)
            <span class="hljs-operator">-&gt;</span>to(<span class="hljs-string">'you@example.com'</span>)
            <span class="hljs-comment">//-&gt;cc('cc@example.com')</span>
            <span class="hljs-comment">//-&gt;bcc('bcc@example.com')</span>
            <span class="hljs-comment">//-&gt;replyTo('fabien@example.com')</span>
            <span class="hljs-comment">//-&gt;priority(Email::PRIORITY_HIGH)</span>
            <span class="hljs-operator">-&gt;</span>subject(<span class="hljs-string">'Time for Symfony Mailer!'</span>)
            <span class="hljs-operator">-&gt;</span>text(<span class="hljs-string">'Sending emails is fun again!'</span>)
            <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'&lt;p&gt;See Twig integration for better HTML integration!&lt;/p&gt;'</span>);

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);

        <span class="hljs-comment">// ...</span>
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>That's it! The message will be sent via the transport you configured. If the
transport is configured to <a href="mailer.html#mailer-sending-messages-async" class="reference internal">send emails asynchronously</a>,
the message won't be actually sent until <a href="messenger.html#messenger-worker" class="reference internal">a worker consumes it</a>.</p>
<div class="section">
<h3 id="email-addresses">
    Email Addresses
    <a class="headerlink" href="#email-addresses" title="Permalink to this headline">¶</a>
</h3>
<p>All the methods that require email addresses (<code translate="no" class="notranslate">from()</code>, <code translate="no" class="notranslate">to()</code>, etc.) accept
both strings or address objects:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Address</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// email address as a simple string</span>
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'fabien@example.com'</span>)

    <span class="hljs-comment">// email address as an object</span>
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-keyword">new</span> Address(<span class="hljs-string">'fabien@example.com'</span>))

    <span class="hljs-comment">// defining the email address and name as an object</span>
    <span class="hljs-comment">// (email clients will display the name)</span>
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-keyword">new</span> Address(<span class="hljs-string">'fabien@example.com'</span>, <span class="hljs-string">'Fabien'</span>))

    <span class="hljs-comment">// defining the email address and name as a string</span>
    <span class="hljs-comment">// (the format must match: 'Name &lt;email@example.com&gt;')</span>
    <span class="hljs-operator">-&gt;</span>from(Address<span class="hljs-operator">::</span>create(<span class="hljs-string">'Fabien Potencier &lt;fabien@example.com&gt;'</span>))

    <span class="hljs-comment">// ...</span>
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Instead of calling <code translate="no" class="notranslate">-&gt;from()</code> <em>every</em> time you create a new email, you can
<a href="mailer.html#mailer-configure-email-globally" class="reference internal">configure emails globally</a> to set the
same <code translate="no" class="notranslate">From</code> email to all messages.</p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>The local part of the address (what goes before the <code translate="no" class="notranslate">@</code>) can include UTF-8
characters, except for the sender address (to avoid issues with bounced emails).
For example: <code translate="no" class="notranslate">föóbàr@example.com</code>, <code translate="no" class="notranslate">用户@example.com</code>, <code translate="no" class="notranslate">θσερ@example.com</code>, etc.</p>
</div>
<p>Use <code translate="no" class="notranslate">addTo()</code>, <code translate="no" class="notranslate">addCc()</code>, or <code translate="no" class="notranslate">addBcc()</code> methods to add more addresses:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>to(<span class="hljs-string">'foo@example.com'</span>)
    <span class="hljs-operator">-&gt;</span>addTo(<span class="hljs-string">'bar@example.com'</span>)
    <span class="hljs-operator">-&gt;</span>cc(<span class="hljs-string">'cc@example.com'</span>)
    <span class="hljs-operator">-&gt;</span>addCc(<span class="hljs-string">'cc2@example.com'</span>)

    <span class="hljs-comment">// ...</span>
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Alternatively, you can pass multiple addresses to each method:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>toAddresses</span> = [<span class="hljs-string">'foo@example.com'</span>, <span class="hljs-keyword">new</span> Address(<span class="hljs-string">'bar@example.com'</span>)];

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>to(...<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>toAddresses</span>)
    <span class="hljs-operator">-&gt;</span>cc(<span class="hljs-string">'cc1@example.com'</span>, <span class="hljs-string">'cc2@example.com'</span>)

    <span class="hljs-comment">// ...</span>
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="message-headers">
    Message Headers
    <a class="headerlink" href="#message-headers" title="Permalink to this headline">¶</a>
</h3>
<p>Messages include a number of header fields to describe their contents. Symfony
sets all the required headers automatically, but you can set your own headers
too. There are different types of headers (Id header, Mailbox header, Date
header, etc.) but most of the times you'll set text headers:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>getHeaders()
        <span class="hljs-comment">// this non-standard header tells compliant autoresponders ("email holiday mode") to not</span>
        <span class="hljs-comment">// reply to this message because it's an automated email</span>
        <span class="hljs-operator">-&gt;</span>addTextHeader(<span class="hljs-string">'X-Auto-Response-Suppress'</span>, <span class="hljs-string">'OOF, DR, RN, NRN, AutoReply'</span>)

        <span class="hljs-comment">// use an array if you want to add a header with multiple values</span>
        <span class="hljs-comment">// (for example in the "References" or "In-Reply-To" header)</span>
        <span class="hljs-operator">-&gt;</span>addIdHeader(<span class="hljs-string">'References'</span>, [<span class="hljs-string">'123@example.com'</span>, <span class="hljs-string">'456@example.com'</span>])

        <span class="hljs-comment">// ...</span>
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>Instead of calling <code translate="no" class="notranslate">-&gt;addTextHeader()</code> <em>every</em> time you create a new email, you can
<a href="mailer.html#mailer-configure-email-globally" class="reference internal">configure emails globally</a> to set the same
headers to all sent emails.</p>
</div>
</div>
<div class="section">
<h3 id="message-contents">
    Message Contents
    <a class="headerlink" href="#message-contents" title="Permalink to this headline">¶</a>
</h3>
<p>The text and HTML contents of the email messages can be strings (usually the
result of rendering some template) or PHP resources:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// simple contents defined as a string</span>
    <span class="hljs-operator">-&gt;</span>text(<span class="hljs-string">'Lorem ipsum...'</span>)
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'&lt;p&gt;Lorem ipsum...&lt;/p&gt;'</span>)

    <span class="hljs-comment">// attach a file stream</span>
    <span class="hljs-operator">-&gt;</span>text(fopen(<span class="hljs-string">'/path/to/emails/user_signup.txt'</span>, <span class="hljs-string">'r'</span>))
    <span class="hljs-operator">-&gt;</span>html(fopen(<span class="hljs-string">'/path/to/emails/user_signup.html'</span>, <span class="hljs-string">'r'</span>))
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>You can also use Twig templates to render the HTML and text contents. Read
the <a href="mailer.html#twig-html-css" class="reference internal">Twig: HTML &amp; CSS</a> section later in this article to
learn more.</p>
</div>
</div>
<div class="section">
<h3 id="file-attachments">
    File Attachments
    <a class="headerlink" href="#file-attachments" title="Permalink to this headline">¶</a>
</h3>
<p>Use the <code translate="no" class="notranslate">addPart()</code> method with a <code translate="no" class="notranslate">BodyFile</code> to add files that exist on your file system:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Part</span>\<span class="hljs-title">DataPart</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Part</span>\<span class="hljs-title">File</span>;
<span class="hljs-comment">// ...</span>

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>addPart(<span class="hljs-keyword">new</span> DataPart(<span class="hljs-keyword">new</span> File(<span class="hljs-string">'/path/to/documents/terms-of-use.pdf'</span>)))
    <span class="hljs-comment">// optionally you can tell email clients to display a custom name for the file</span>
    <span class="hljs-operator">-&gt;</span>addPart(<span class="hljs-keyword">new</span> DataPart(<span class="hljs-keyword">new</span> File(<span class="hljs-string">'/path/to/documents/privacy.pdf'</span>), <span class="hljs-string">'Privacy Policy'</span>))
    <span class="hljs-comment">// optionally you can provide an explicit MIME type (otherwise it's guessed)</span>
    <span class="hljs-operator">-&gt;</span>addPart(<span class="hljs-keyword">new</span> DataPart(<span class="hljs-keyword">new</span> File(<span class="hljs-string">'/path/to/documents/contract.doc'</span>), <span class="hljs-string">'Contract'</span>, <span class="hljs-string">'application/msword'</span>))
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Alternatively you can attach contents from a stream by passing it directly to the <code translate="no" class="notranslate">DataPart</code> :</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>addPart(<span class="hljs-keyword">new</span> DataPart(fopen(<span class="hljs-string">'/path/to/documents/contract.doc'</span>, <span class="hljs-string">'r'</span>)))
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-deprecated ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>In Symfony versions previous to 6.2, the methods <code translate="no" class="notranslate">attachFromPath()</code> and
<code translate="no" class="notranslate">attach()</code> could be used to add attachments. These methods have been
deprecated and replaced with <code translate="no" class="notranslate">addPart()</code>.</p>
</div>
</div>
<div class="section">
<h3 id="embedding-images">
    Embedding Images
    <a class="headerlink" href="#embedding-images" title="Permalink to this headline">¶</a>
</h3>
<p>If you want to display images inside your email, you must embed them
instead of adding them as attachments. When using Twig to render the email
contents, as explained <a href="mailer.html#mailer-twig-embedding-images" class="reference internal">later in this article</a>,
the images are embedded automatically. Otherwise, you need to embed them manually.</p>
<p>First, use the <code translate="no" class="notranslate">addPart()</code> method to add an image from a
file or stream:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// get the image contents from a PHP resource</span>
    <span class="hljs-operator">-&gt;</span>addPart((<span class="hljs-keyword">new</span> DataPart(fopen(<span class="hljs-string">'/path/to/images/logo.png'</span>, <span class="hljs-string">'r'</span>), <span class="hljs-string">'logo'</span>, <span class="hljs-string">'image/png'</span>))<span class="hljs-operator">-&gt;</span>asInline())
    <span class="hljs-comment">// get the image contents from an existing file</span>
    <span class="hljs-operator">-&gt;</span>addPart((<span class="hljs-keyword">new</span> DataPart(<span class="hljs-keyword">new</span> File(<span class="hljs-string">'/path/to/images/signature.gif'</span>), <span class="hljs-string">'footer-signature'</span>, <span class="hljs-string">'image/gif'</span>))<span class="hljs-operator">-&gt;</span>asInline())
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Use the <code translate="no" class="notranslate">asInline()</code> method to embed the content instead of attaching it.</p>
<p>The second optional argument of both methods is the image name (&quot;Content-ID&quot; in
the MIME standard). Its value is an arbitrary string used later to reference the
images inside the HTML contents:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>addPart((<span class="hljs-keyword">new</span> DataPart(fopen(<span class="hljs-string">'/path/to/images/logo.png'</span>, <span class="hljs-string">'r'</span>), <span class="hljs-string">'logo'</span>, <span class="hljs-string">'image/png'</span>))<span class="hljs-operator">-&gt;</span>asInline())
    <span class="hljs-operator">-&gt;</span>addPart((<span class="hljs-keyword">new</span> DataPart(<span class="hljs-keyword">new</span> File(<span class="hljs-string">'/path/to/images/signature.gif'</span>), <span class="hljs-string">'footer-signature'</span>, <span class="hljs-string">'image/gif'</span>))<span class="hljs-operator">-&gt;</span>asInline())

    <span class="hljs-comment">// reference images using the syntax 'cid:' + "image embed name"</span>
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'&lt;img src="cid:logo"&gt; ... &lt;img src="cid:footer-signature"&gt; ...'</span>)

    <span class="hljs-comment">// use the same syntax for images included as HTML background images</span>
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'... &lt;div background="cid:footer-signature"&gt; ... &lt;/div&gt; ...'</span>)
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.1</span>
    </p><p>The support of embedded images as HTML backgrounds was introduced in Symfony 6.1.</p>
</div>
<div class="admonition admonition-deprecated ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>In Symfony versions previous to 6.2, the methods <code translate="no" class="notranslate">embedFromPath()</code> and
<code translate="no" class="notranslate">embed()</code> could be used to embed images. These methods have been deprecated
and replaced with <code translate="no" class="notranslate">addPart()</code> together with inline <code translate="no" class="notranslate">DataPart</code> objects.</p>
</div>
<span id="mailer-configure-email-globally"></span>
</div>
</div>
<div class="section">
<h2 id="configuring-emails-globally">
    Configuring Emails Globally
    <a class="headerlink" href="#configuring-emails-globally" title="Permalink to this headline">¶</a>
</h2>
<p>Instead of calling <code translate="no" class="notranslate">-&gt;from()</code> on each Email you create, you can configure this
value globally so that it is set on all sent emails. The same is true with <code translate="no" class="notranslate">-&gt;to()</code>
and headers.</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-e9dcc8f5b394ecec9ccb6ba34439af212129435f" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-a1e8f461ad538f50778ca9d18b90408323c21e6c" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-274c3ecaf812ff41ddc03c437a2264e8087bc9c9" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-e9dcc8f5b394ecec9ccb6ba34439af212129435f" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">mailer:</span>
        <span class="hljs-attr">envelope:</span>
            <span class="hljs-attr">sender:</span> <span class="hljs-string">'fabien@example.com'</span>
            <span class="hljs-attr">recipients:</span> <span class="hljs-string">['foo@example.com',</span> <span class="hljs-string">'bar@example.com'</span><span class="hljs-string">]</span>
        <span class="hljs-attr">headers:</span>
            <span class="hljs-attr">From:</span> <span class="hljs-string">'Fabien &lt;fabien@example.com&gt;'</span>
            <span class="hljs-attr">Bcc:</span> <span class="hljs-string">'baz@example.com'</span>
            <span class="hljs-attr">X-Custom-Header:</span> <span class="hljs-string">'foobar'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-a1e8f461ad538f50778ca9d18b90408323c21e6c" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/mailer.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:envelope</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:sender</span>&gt;</span>fabien@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">framework:sender</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:recipients</span>&gt;</span>foo@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">framework:recipients</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:recipients</span>&gt;</span>bar@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">framework:recipients</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">framework:envelope</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:header</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"From"</span>&gt;</span>Fabien <span class="hljs-symbol">&amp;lt;</span>fabien@example.com<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">framework:header</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:header</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Bcc"</span>&gt;</span>baz@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">framework:header</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:header</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"X-Custom-Header"</span>&gt;</span>foobar<span class="hljs-tag">&lt;/<span class="hljs-name">framework:header</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:mailer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-274c3ecaf812ff41ddc03c437a2264e8087bc9c9" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>mailer();
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span>
        <span class="hljs-operator">-&gt;</span>envelope()
            <span class="hljs-operator">-&gt;</span>sender(<span class="hljs-string">'fabien@example.com'</span>)
            <span class="hljs-operator">-&gt;</span>recipients([<span class="hljs-string">'foo@example.com'</span>, <span class="hljs-string">'bar@example.com'</span>])
    ;

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>header(<span class="hljs-string">'From'</span>)<span class="hljs-operator">-&gt;</span>value(<span class="hljs-string">'Fabien &lt;fabien@example.com&gt;'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>header(<span class="hljs-string">'Bcc'</span>)<span class="hljs-operator">-&gt;</span>value(<span class="hljs-string">'baz@example.com'</span>);
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>header(<span class="hljs-string">'X-Custom-Header'</span>)<span class="hljs-operator">-&gt;</span>value(<span class="hljs-string">'foobar'</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>Some third-party providers don't support the usage of keywords like <code translate="no" class="notranslate">from</code>
in the <code translate="no" class="notranslate">headers</code>. Check out your provider's documentation before setting
any global header.</p>
</div>
</div>
<div class="section">
<h2 id="handling-sending-failures">
    Handling Sending Failures
    <a class="headerlink" href="#handling-sending-failures" title="Permalink to this headline">¶</a>
</h2>
<p>Symfony Mailer considers that sending was successful when your transport (SMTP
server or third-party provider) accepts the mail for further delivery. The message
can later be lost or not delivered because of some problem in your provider, but
that's out of reach for your Symfony application.</p>
<p>If there's an error when handing over the email to your transport, Symfony throws
a <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Exception/TransportExceptionInterface.php" class="reference external" title="Symfony\Component\Mailer\Exception\TransportExceptionInterface" rel="external noopener noreferrer" target="_blank">TransportExceptionInterface</a>.
Catch that exception to recover from the error or to display some message:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Exception</span>\<span class="hljs-title">TransportExceptionInterface</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = <span class="hljs-keyword">new</span> Email();
<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);
} <span class="hljs-keyword">catch</span> (TransportExceptionInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>e</span>) {
    <span class="hljs-comment">// some error prevented the email sending; display an</span>
    <span class="hljs-comment">// error message or try to resend the message</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h2 id="debugging-emails">
    Debugging Emails
    <a class="headerlink" href="#debugging-emails" title="Permalink to this headline">¶</a>
</h2>
<p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/SentMessage.php" class="reference external" title="Symfony\Component\Mailer\SentMessage" rel="external noopener noreferrer" target="_blank">SentMessage</a> object returned by the
<code translate="no" class="notranslate">send()</code> method of the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Transport/TransportInterface.php" class="reference external" title="Symfony\Component\Mailer\Transport\TransportInterface" rel="external noopener noreferrer" target="_blank">TransportInterface</a>
provides access to the original message (<code translate="no" class="notranslate">getOriginalMessage()</code>) and to some
debug information (<code translate="no" class="notranslate">getDebug()</code>) such as the HTTP calls done by the HTTP
transports, which is useful to debug errors.</p>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>If your code used <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/MailerInterface.php" class="reference external" title="Symfony\Component\Mailer\MailerInterface" rel="external noopener noreferrer" target="_blank">MailerInterface</a>, you
need to replace it by <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Transport/TransportInterface.php" class="reference external" title="Symfony\Component\Mailer\Transport\TransportInterface" rel="external noopener noreferrer" target="_blank">TransportInterface</a>
to have the <code translate="no" class="notranslate">SentMessage</code> object returned.</p>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>Some mailer providers change the <code translate="no" class="notranslate">Message-Id</code> when sending the email. The
<code translate="no" class="notranslate">getMessageId()</code> method from <code translate="no" class="notranslate">SentMessage</code> always returns the definitive
ID of the message (being the original random ID generated by Symfony or the
new ID generated by the mailer provider).</p>
</div>
<p>The exceptions related to mailer transports (those which implement
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Exception/TransportException.php" class="reference external" title="Symfony\Component\Mailer\Exception\TransportException" rel="external noopener noreferrer" target="_blank">TransportException</a>) also provide
this debug information via the <code translate="no" class="notranslate">getDebug()</code> method.</p>
<span id="mailer-twig"></span>
</div>
<div class="section">
<h2 id="twig-html-css">
    Twig: HTML &amp; CSS
    <a class="headerlink" href="#twig-html-css" title="Permalink to this headline">¶</a>
</h2>
<p>The Mime component integrates with the <a href="templates.html#twig-language" class="reference internal">Twig template engine</a>
to provide advanced features such as CSS style inlining and support for HTML/CSS
frameworks to create complex HTML email messages. First, make sure Twig is installed:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require symfony/twig-bundle

<span class="hljs-comment"># or if you're using the component in a non-Symfony app:</span>
<span class="hljs-comment"># composer require symfony/twig-bridge</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="section">
<h3 id="html-content">
    HTML Content
    <a class="headerlink" href="#html-content" title="Permalink to this headline">¶</a>
</h3>
<p>To define the contents of your email with Twig, use the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bridge/Twig/Mime/TemplatedEmail.php" class="reference external" title="Symfony\Bridge\Twig\Mime\TemplatedEmail" rel="external noopener noreferrer" target="_blank">TemplatedEmail</a> class. This class extends
the normal <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mime/Email.php" class="reference external" title="Symfony\Component\Mime\Email" rel="external noopener noreferrer" target="_blank">Email</a> class but adds some new methods
for Twig templates:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bridge</span>\<span class="hljs-title">Twig</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">TemplatedEmail</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> TemplatedEmail())
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'fabien@example.com'</span>)
    <span class="hljs-operator">-&gt;</span>to(<span class="hljs-keyword">new</span> Address(<span class="hljs-string">'ryan@example.com'</span>))
    <span class="hljs-operator">-&gt;</span>subject(<span class="hljs-string">'Thanks for signing up!'</span>)

    <span class="hljs-comment">// path of the Twig template to render</span>
    <span class="hljs-operator">-&gt;</span>htmlTemplate(<span class="hljs-string">'emails/signup.html.twig'</span>)

    <span class="hljs-comment">// pass variables (name =&gt; value) to the template</span>
    <span class="hljs-operator">-&gt;</span>context([
        <span class="hljs-string">'expiration_date'</span> =&gt; <span class="hljs-keyword">new</span> \DateTime(<span class="hljs-string">'+7 days'</span>),
        <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'foo'</span>,
    ])
;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Then, create the template:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-comment">{# templates/emails/signup.html.twig #}</span><span class="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome </span><span class="hljs-template-variable">{{ email.toName }}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
    You signed up as </span><span class="hljs-template-variable">{{ username }}</span><span class="xml"> the following email:
<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span></span><span class="hljs-template-variable">{{ email.to[0].address }}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;</span>Click here to activate your account<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    (this link is valid until </span><span class="hljs-template-variable">{{ expiration_date|<span class="hljs-keyword">date</span>('F jS') }}</span><span class="xml">)
<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The Twig template has access to any of the parameters passed in the <code translate="no" class="notranslate">context()</code>
method of the <code translate="no" class="notranslate">TemplatedEmail</code> class and also to a special variable called
<code translate="no" class="notranslate">email</code>, which is an instance of
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bridge/Twig/Mime/WrappedTemplatedEmail.php" class="reference external" title="Symfony\Bridge\Twig\Mime\WrappedTemplatedEmail" rel="external noopener noreferrer" target="_blank">WrappedTemplatedEmail</a>.</p>
</div>
<div class="section">
<h3 id="text-content">
    Text Content
    <a class="headerlink" href="#text-content" title="Permalink to this headline">¶</a>
</h3>
<p>When the text content of a <code translate="no" class="notranslate">TemplatedEmail</code> is not explicitly defined, it is
automatically generated from the HTML contents.</p>
<p>Symfony uses the following strategy when generating the text version of an
email:</p>
<ul>
    <li>If an explicit HTML to text converter has been configured (see
<a href="reference/configuration/twig.html#config-twig-html-to-text-converter" class="reference internal">twig.mailer.html_to_text_converter</a>), it calls it;</li>
<li>If not, and if you have <a href="https://github.com/thephpleague/html-to-markdown" class="reference external" rel="external noopener noreferrer" target="_blank">league/html-to-markdown</a> installed in your
application, it uses it to turn HTML into Markdown (so the text email has
some visual appeal);</li>
<li>Otherwise, it applies the <a href="https://secure.php.net/manual/en/function.strip-tags.php" class="reference external" title="strip_tags" rel="external noopener noreferrer" target="_blank">strip_tags</a> PHP function to the
original HTML contents.</li>
</ul>
<p>If you want to define the text content yourself, use the <code translate="no" class="notranslate">text()</code> method
explained in the previous sections or the <code translate="no" class="notranslate">textTemplate()</code> method provided by
the <code translate="no" class="notranslate">TemplatedEmail</code> class:</p>
<div translate="no" class="highlight-diff notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs diff"><span class="hljs-addition">+use Symfony\Bridge\Twig\Mime\TemplatedEmail;</span>

 $email = (new TemplatedEmail())
     // ...

     -&gt;htmlTemplate('emails/signup.html.twig')
<span class="hljs-addition">+     -&gt;textTemplate('emails/signup.txt.twig')</span>
     // ...
 ;</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="mailer-twig-embedding-images"></span>
</div>
<div class="section">
<h3 id="embedding-images-1">
    Embedding Images
    <a class="headerlink" href="#embedding-images-1" title="Permalink to this headline">¶</a>
</h3>
<p>Instead of dealing with the <code translate="no" class="notranslate">&lt;img src=&quot;cid: ...&quot;&gt;</code> syntax explained in the
previous sections, when using Twig to render email contents you can refer to
image files as usual. First, to simplify things, define a Twig namespace called
<code translate="no" class="notranslate">images</code> that points to whatever directory your images are stored in:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-2b6f14fbc375a10d6f6fe7dd2c0b7ec6152e9063" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-ae1aba209be8d0e31651887b6dbc748328b6a6ae" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-677300c657efda72a7aac5c4c90be74fb982b41a" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-2b6f14fbc375a10d6f6fe7dd2c0b7ec6152e9063" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/twig.yaml</span>
<span class="hljs-attr">twig:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">paths:</span>
        <span class="hljs-comment"># point this wherever your images live</span>
        <span class="hljs-string">'%kernel.project_dir%/assets/images'</span><span class="hljs-string">:</span> <span class="hljs-string">images</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-ae1aba209be8d0e31651887b6dbc748328b6a6ae" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/twig.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:twig</span>=<span class="hljs-string">"http://symfony.com/schema/dic/twig"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/twig https://symfony.com/schema/dic/twig/twig-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">twig:config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-comment">&lt;!-- point this wherever your images live --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">twig:path</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"images"</span>&gt;</span>%kernel.project_dir%/assets/images<span class="hljs-tag">&lt;/<span class="hljs-name">twig:path</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">twig:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-677300c657efda72a7aac5c4c90be74fb982b41a" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/twig.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">TwigConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(TwigConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>twig</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// point this wherever your images live</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>twig</span><span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'%kernel.project_dir%/assets/images'</span>, <span class="hljs-string">'images'</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Now, use the special <code translate="no" class="notranslate">email.image()</code> Twig helper to embed the images inside
the email contents:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-comment">{# '@images/' refers to the Twig namespace defined earlier #}</span><span class="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ email.image('@images/logo.png') }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Logo"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome </span><span class="hljs-template-variable">{{ email.toName }}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
</span><span class="hljs-comment">{# ... #}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="mailer-inline-css"></span>
</div>
<div class="section">
<h3 id="inlining-css-styles">
    Inlining CSS Styles
    <a class="headerlink" href="#inlining-css-styles" title="Permalink to this headline">¶</a>
</h3>
<p>Designing the HTML contents of an email is very different from designing a
normal HTML page. For starters, most email clients only support a subset of all
CSS features. In addition, popular email clients like Gmail don't support
defining styles inside <code translate="no" class="notranslate">&lt;style&gt; ... &lt;/style&gt;</code> sections and you must <strong>inline
all the CSS styles</strong>.</p>
<p>CSS inlining means that every HTML tag must define a <code translate="no" class="notranslate">style</code> attribute with
all its CSS styles. This can make organizing your CSS a mess. That's why Twig
provides a <code translate="no" class="notranslate">CssInlinerExtension</code> that automates everything for you. Install
it with:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require twig/extra-bundle twig/cssinliner-extra</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The extension is enabled automatically. To use it, wrap the entire template
with the <code translate="no" class="notranslate">inline_css</code> filter:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">apply</span></span> inline_css %}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
        </span><span class="hljs-comment">{# here, define your CSS styles as usual #}</span><span class="xml"><span class="css">
        <span class="hljs-selector-tag">h1</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome </span><span class="hljs-template-variable">{{ email.toName }}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    </span><span class="hljs-comment">{# ... #}</span><span class="xml">
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endapply</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="section">
<h4 id="using-external-css-files">
    Using External CSS Files
    <a class="headerlink" href="#using-external-css-files" title="Permalink to this headline">¶</a>
</h4>
<p>You can also define CSS styles in external files and pass them as
arguments to the filter:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">apply</span></span> inline_css(<span class="hljs-name">source</span><span class="hljs-params">('@styles/email.css')</span>) %}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome </span><span class="hljs-template-variable">{{ username }}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    </span><span class="hljs-comment">{# ... #}</span><span class="xml">
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endapply</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can pass unlimited number of arguments to <code translate="no" class="notranslate">inline_css()</code> to load multiple
CSS files. For this example to work, you also need to define a new Twig namespace
called <code translate="no" class="notranslate">styles</code> that points to the directory where <code translate="no" class="notranslate">email.css</code> lives:</p>
<span id="mailer-css-namespace"></span>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-c48701e8f8c623aa284352ec73362832f6480a55" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-3eba844e3879d7a845a5f2c036620919a6201697" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-e7bff94f10dc6d8086870aa66ff4bbd8529001a9" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-c48701e8f8c623aa284352ec73362832f6480a55" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/twig.yaml</span>
<span class="hljs-attr">twig:</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-attr">paths:</span>
        <span class="hljs-comment"># point this wherever your css files live</span>
        <span class="hljs-string">'%kernel.project_dir%/assets/styles'</span><span class="hljs-string">:</span> <span class="hljs-string">styles</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3eba844e3879d7a845a5f2c036620919a6201697" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/twig.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:twig</span>=<span class="hljs-string">"http://symfony.com/schema/dic/twig"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/twig https://symfony.com/schema/dic/twig/twig-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">twig:config</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- ... --&gt;</span>

        <span class="hljs-comment">&lt;!-- point this wherever your css files live --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">twig:path</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"styles"</span>&gt;</span>%kernel.project_dir%/assets/styles<span class="hljs-tag">&lt;/<span class="hljs-name">twig:path</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">twig:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-e7bff94f10dc6d8086870aa66ff4bbd8529001a9" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/twig.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">TwigConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(TwigConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>twig</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// point this wherever your css files live</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>twig</span><span class="hljs-operator">-&gt;</span>path(<span class="hljs-string">'%kernel.project_dir%/assets/styles'</span>, <span class="hljs-string">'styles'</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<span id="mailer-markdown"></span>
</div>
</div>
<div class="section">
<h3 id="rendering-markdown-content">
    Rendering Markdown Content
    <a class="headerlink" href="#rendering-markdown-content" title="Permalink to this headline">¶</a>
</h3>
<p>Twig provides another extension called <code translate="no" class="notranslate">MarkdownExtension</code> that lets you
define the email contents using <a href="https://commonmark.org/" class="reference external" rel="external noopener noreferrer" target="_blank">Markdown syntax</a>. To use this, install the
extension and a Markdown conversion library (the extension is compatible with
several popular libraries):</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-comment"># instead of league/commonmark, you can also use erusev/parsedown or michelf/php-markdown</span>
<span class="hljs-prompt">$ </span>composer require twig/extra-bundle twig/markdown-extra league/commonmark</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The extension adds a <code translate="no" class="notranslate">markdown_to_html</code> filter, which you can use to convert parts or
the entire email contents from Markdown to HTML:</p>
<div translate="no" class="highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">apply</span></span> markdown_to_html %}</span><span class="xml">
    Welcome </span><span class="hljs-template-variable">{{ email.toName }}</span><span class="xml">!
    ===========================

    You signed up to our site using the following email:
    `</span><span class="hljs-template-variable">{{ email.to[0].address }}</span><span class="xml">`

    [Click here to activate your account](</span><span class="hljs-template-variable">{{ url('...') }}</span><span class="xml">)
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endapply</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="mailer-inky"></span>
</div>
<div class="section">
<h3 id="inky-email-templating-language">
    Inky Email Templating Language
    <a class="headerlink" href="#inky-email-templating-language" title="Permalink to this headline">¶</a>
</h3>
<p>Creating beautifully designed emails that work on every email client is so
complex that there are HTML/CSS frameworks dedicated to that. One of the most
popular frameworks is called <a href="https://get.foundation/emails/docs/inky.html" class="reference external" rel="external noopener noreferrer" target="_blank">Inky</a>. It defines a syntax based on some HTML-like
tags which are later transformed into the real HTML code sent to users:</p>
<div translate="no" class="highlight-html notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html"><span class="hljs-comment">&lt;!-- a simplified example of the Inky syntax --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">row</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">columns</span>&gt;</span>This is a column.<span class="hljs-tag">&lt;/<span class="hljs-name">columns</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">row</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Twig provides integration with Inky via the <code translate="no" class="notranslate">InkyExtension</code>. First, install
the extension in your application:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>composer require twig/extra-bundle twig/inky-extra</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The extension adds an <code translate="no" class="notranslate">inky_to_html</code> filter, which can be used to convert
parts or the entire email contents from Inky to HTML:</p>
<div translate="no" class="highlight-html+twig highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs html+twig twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">apply</span></span> inky_to_html %}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">container</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">row</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">columns</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">spacer</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"16"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">spacer</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center"</span>&gt;</span>Welcome </span><span class="hljs-template-variable">{{ email.toName }}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">columns</span>&gt;</span>

            </span><span class="hljs-comment">{# ... #}</span><span class="xml">
        <span class="hljs-tag">&lt;/<span class="hljs-name">row</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span>
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endapply</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can combine all filters to create complex email messages:</p>
<div translate="no" class="highlight-twig notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs twig"><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">apply</span></span> inky_to_html|<span class="hljs-keyword">inline_css</span>(<span class="hljs-name">source</span><span class="hljs-params">('@styles/foundation-emails.css')</span>) %}</span><span class="xml">
    </span><span class="hljs-comment">{# ... #}</span><span class="xml">
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-keyword">endapply</span></span> %}</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This makes use of the <a href="mailer.html#mailer-css-namespace" class="reference internal">styles Twig namespace</a> we created
earlier. You could, for example, <a href="https://github.com/foundation/foundation-emails/blob/develop/dist/foundation-emails.css" class="reference external" rel="external noopener noreferrer" target="_blank">download the foundation-emails.css file</a>
directly from GitHub and save it in <code translate="no" class="notranslate">assets/styles</code>.</p>
<span id="signing-and-encrypting-messages"></span>
</div>
</div>
<div class="section">
<h2 id="signing-and-encrypting-messages">
    Signing and Encrypting Messages
    <a class="headerlink" href="#signing-and-encrypting-messages" title="Permalink to this headline">¶</a>
</h2>
<p>It's possible to sign and/or encrypt email messages to increase their
integrity/security. Both options can be combined to encrypt a signed message
and/or to sign an encrypted message.</p>
<p>Before signing/encrypting messages, make sure to have:</p>
<ul>
    <li>The <a href="https://www.php.net/manual/en/book.openssl.php" class="reference external" rel="external noopener noreferrer" target="_blank">OpenSSL PHP extension</a> properly installed and configured;</li>
<li>A valid <a href="https://en.wikipedia.org/wiki/S/MIME" class="reference external" rel="external noopener noreferrer" target="_blank">S/MIME</a> security certificate.</li>
</ul>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>When using OpenSSL to generate certificates, make sure to add the
<code translate="no" class="notranslate">-addtrust emailProtection</code> command option.</p>
</div>
<div class="section">
<h3 id="signing-messages">
    Signing Messages
    <a class="headerlink" href="#signing-messages" title="Permalink to this headline">¶</a>
</h3>
<p>When signing a message, a cryptographic hash is generated for the entire content
of the message (including attachments). This hash is added as an attachment so
the recipient can validate the integrity of the received message. However, the
contents of the original message are still readable for mailing agents not
supporting signed messages, so you must also encrypt the message if you want to
hide its contents.</p>
<p>You can sign messages using either <code translate="no" class="notranslate">S/MIME</code> or <code translate="no" class="notranslate">DKIM</code>. In both cases, the
certificate and private key must be <a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" class="reference external" rel="external noopener noreferrer" target="_blank">PEM encoded</a>, and can be either created
using for example OpenSSL or obtained at an official Certificate Authority (CA).
The email recipient must have the CA certificate in the list of trusted issuers
in order to verify the signature.</p>
<div class="admonition admonition-caution ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Caution</span>
    </p><p>If you use message signature, sending to <code translate="no" class="notranslate">Bcc</code> will be removed from the
message. If you need to send a message to multiple recipients, you need
to compute a new signature for each recipient.</p>
</div>
<div class="section">
<h4 id="s-mime-signer">
    S/MIME Signer
    <a class="headerlink" href="#s-mime-signer" title="Permalink to this headline">¶</a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/S/MIME" class="reference external" rel="external noopener noreferrer" target="_blank">S/MIME</a> is a standard for public key encryption and signing of MIME data. It
requires using both a certificate and a private key:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Crypto</span>\<span class="hljs-title">SMimeSigner</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Email</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'hello@example.com'</span>)
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'...'</span>);

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signer</span> = <span class="hljs-keyword">new</span> SMimeSigner(<span class="hljs-string">'/path/to/certificate.crt'</span>, <span class="hljs-string">'/path/to/certificate-private-key.key'</span>);
<span class="hljs-comment">// if the private key has a passphrase, pass it as the third argument</span>
<span class="hljs-comment">// new SMimeSigner('/path/to/certificate.crt', '/path/to/certificate-private-key.key', 'the-passphrase');</span>

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signer</span><span class="hljs-operator">-&gt;</span>sign(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);
<span class="hljs-comment">// now use the Mailer component to send this $signedEmail instead of the original email</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>The <code translate="no" class="notranslate">SMimeSigner</code> class defines other optional arguments to pass
intermediate certificates and to configure the signing process using a
bitwise operator options for <a href="https://secure.php.net/manual/en/function.openssl-pkcs7-sign.php" class="reference external" title="openssl_pkcs7_sign" rel="external noopener noreferrer" target="_blank">openssl_pkcs7_sign</a> PHP function.</p>
</div>
</div>
<div class="section">
<h4 id="dkim-signer">
    DKIM Signer
    <a class="headerlink" href="#dkim-signer" title="Permalink to this headline">¶</a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail" class="reference external" rel="external noopener noreferrer" target="_blank">DKIM</a> is an email authentication method that affixes a digital signature,
linked to a domain name, to each outgoing email messages. It requires a private
key but not a certificate:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Crypto</span>\<span class="hljs-title">DkimSigner</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Email</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'hello@example.com'</span>)
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'...'</span>);

<span class="hljs-comment">// first argument: same as openssl_pkey_get_private(), either a string with the</span>
<span class="hljs-comment">// contents of the private key or the absolute path to it (prefixed with 'file://')</span>
<span class="hljs-comment">// second and third arguments: the domain name and "selector" used to perform a DNS lookup</span>
<span class="hljs-comment">// (the selector is a string used to point to a specific DKIM public key record in your DNS)</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signer</span> = <span class="hljs-keyword">new</span> DkimSigner(<span class="hljs-string">'file:///path/to/private-key.key'</span>, <span class="hljs-string">'example.com'</span>, <span class="hljs-string">'sf'</span>);
<span class="hljs-comment">// if the private key has a passphrase, pass it as the fifth argument</span>
<span class="hljs-comment">// new DkimSigner('file:///path/to/private-key.key', 'example.com', 'sf', [], 'the-passphrase');</span>

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signer</span><span class="hljs-operator">-&gt;</span>sign(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);
<span class="hljs-comment">// now use the Mailer component to send this $signedEmail instead of the original email</span>

<span class="hljs-comment">// DKIM signer provides many config options and a helper object to configure them</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Crypto</span>\<span class="hljs-title">DkimOptions</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>signer</span><span class="hljs-operator">-&gt;</span>sign(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>, (<span class="hljs-keyword">new</span> DkimOptions())
    <span class="hljs-operator">-&gt;</span>bodyCanon(<span class="hljs-string">'relaxed'</span>)
    <span class="hljs-operator">-&gt;</span>headerCanon(<span class="hljs-string">'relaxed'</span>)
    <span class="hljs-operator">-&gt;</span>headersToIgnore([<span class="hljs-string">'Message-ID'</span>])
    <span class="hljs-operator">-&gt;</span>toArray()
);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
</div>
<div class="section">
<h3 id="encrypting-messages">
    Encrypting Messages
    <a class="headerlink" href="#encrypting-messages" title="Permalink to this headline">¶</a>
</h3>
<p>When encrypting a message, the entire message (including attachments) is
encrypted using a certificate. Therefore, only the recipients that have the
corresponding private key can read the original message contents:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Crypto</span>\<span class="hljs-title">SMimeEncrypter</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Email</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-operator">-&gt;</span>from(<span class="hljs-string">'hello@example.com'</span>)
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>html(<span class="hljs-string">'...'</span>);

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encrypter</span> = <span class="hljs-keyword">new</span> SMimeEncrypter(<span class="hljs-string">'/path/to/certificate.crt'</span>);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encryptedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encrypter</span><span class="hljs-operator">-&gt;</span>encrypt(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);
<span class="hljs-comment">// now use the Mailer component to send this $encryptedEmail instead of the original email</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can pass more than one certificate to the <code translate="no" class="notranslate">SMimeEncrypter</code> constructor
and it will select the appropriate certificate depending on the <code translate="no" class="notranslate">To</code> option:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>firstEmail</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>to(<span class="hljs-string">'jane@example.com'</span>);

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>secondEmail</span> = (<span class="hljs-keyword">new</span> Email())
    <span class="hljs-comment">// ...</span>
    <span class="hljs-operator">-&gt;</span>to(<span class="hljs-string">'john@example.com'</span>);

<span class="hljs-comment">// the second optional argument of SMimeEncrypter defines which encryption algorithm is used</span>
<span class="hljs-comment">// (it must be one of these constants: https://www.php.net/manual/en/openssl.ciphers.php)</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encrypter</span> = <span class="hljs-keyword">new</span> SMimeEncrypter([
    <span class="hljs-comment">// key = email recipient; value = path to the certificate file</span>
    <span class="hljs-string">'jane@example.com'</span> =&gt; <span class="hljs-string">'/path/to/first-certificate.crt'</span>,
    <span class="hljs-string">'john@example.com'</span> =&gt; <span class="hljs-string">'/path/to/second-certificate.crt'</span>,
]);

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>firstEncryptedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encrypter</span><span class="hljs-operator">-&gt;</span>encrypt(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>firstEmail</span>);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>secondEncryptedEmail</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>encrypter</span><span class="hljs-operator">-&gt;</span>encrypt(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>secondEmail</span>);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="multiple-email-transports"></span>
</div>
</div>
<div class="section">
<h2 id="multiple-email-transports">
    Multiple Email Transports
    <a class="headerlink" href="#multiple-email-transports" title="Permalink to this headline">¶</a>
</h2>
<p>You may want to use more than one mailer transport for delivery of your messages.
This can be configured by replacing the <code translate="no" class="notranslate">dsn</code> configuration entry with a
<code translate="no" class="notranslate">transports</code> entry, like:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-66d854ebd043430ffa01bd5d1835db1f4d602df2" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-945e4715de694c25bb4f6ec8f5126353ca849952" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-16d1880314a55601ab694ac5b9915b74ce71cb1c" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-66d854ebd043430ffa01bd5d1835db1f4d602df2" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">mailer:</span>
        <span class="hljs-attr">transports:</span>
            <span class="hljs-attr">main:</span> <span class="hljs-string">'%env(MAILER_DSN)%'</span>
            <span class="hljs-attr">alternative:</span> <span class="hljs-string">'%env(MAILER_DSN_IMPORTANT)%'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-945e4715de694c25bb4f6ec8f5126353ca849952" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/mailer.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:transport</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>%env(MAILER_DSN)%<span class="hljs-tag">&lt;/<span class="hljs-name">framework:transport</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:transport</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"alternative"</span>&gt;</span>%env(MAILER_DSN_IMPORTANT)%<span class="hljs-tag">&lt;/<span class="hljs-name">framework:transport</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:mailer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-16d1880314a55601ab694ac5b9915b74ce71cb1c" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">Loader</span>\<span class="hljs-title">Configurator</span>\<span class="hljs-title">env</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>mailer()
        <span class="hljs-operator">-&gt;</span>transport(<span class="hljs-string">'main'</span>, env(<span class="hljs-string">'MAILER_DSN'</span>))
        <span class="hljs-operator">-&gt;</span>transport(<span class="hljs-string">'alternative'</span>, env(<span class="hljs-string">'MAILER_DSN_IMPORTANT'</span>))
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>By default the first transport is used. The other transports can be selected by
adding an <code translate="no" class="notranslate">X-Transport</code> header (which Mailer will remove automatically from
the final email):</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// Send using first transport ("main"):</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);

<span class="hljs-comment">// ... or use the transport "alternative":</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span><span class="hljs-operator">-&gt;</span>getHeaders()<span class="hljs-operator">-&gt;</span>addTextHeader(<span class="hljs-string">'X-Transport'</span>, <span class="hljs-string">'alternative'</span>);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<span id="mailer-sending-messages-async"></span>
</div>
<div class="section">
<h2 id="sending-messages-async">
    Sending Messages Async
    <a class="headerlink" href="#sending-messages-async" title="Permalink to this headline">¶</a>
</h2>
<p>When you call <code translate="no" class="notranslate">$mailer-&gt;send($email)</code>, the email is sent to the transport immediately.
To improve performance, you can leverage <a href="messenger.html" class="reference internal">Messenger</a> to send
the messages later via a Messenger transport.</p>
<p>Start by following the <a href="messenger.html" class="reference internal">Messenger</a> documentation and configuring
a transport. Once everything is set up, when you call <code translate="no" class="notranslate">$mailer-&gt;send()</code>, a
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Messenger/SendEmailMessage.php" class="reference external" title="Symfony\Component\Mailer\Messenger\SendEmailMessage" rel="external noopener noreferrer" target="_blank">SendEmailMessage</a> message will
be dispatched through the default message bus (<code translate="no" class="notranslate">messenger.default_bus</code>). Assuming
you have a transport called <code translate="no" class="notranslate">async</code>, you can route the message there:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-5fb5d072c9cc5d8bff4547537ebe4c897f316ed4" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-18207340469544c7b6b79f8eaea4ba5e8458af45" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-0c1c52c950e6e0e3d65b7c645b1506490b80caee" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-5fb5d072c9cc5d8bff4547537ebe4c897f316ed4" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/messenger.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">messenger:</span>
        <span class="hljs-attr">transports:</span>
            <span class="hljs-attr">async:</span> <span class="hljs-string">"%env(MESSENGER_TRANSPORT_DSN)%"</span>

        <span class="hljs-attr">routing:</span>
            <span class="hljs-string">'Symfony\Component\Mailer\Messenger\SendEmailMessage'</span><span class="hljs-string">:</span> <span class="hljs-string">async</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-18207340469544c7b6b79f8eaea4ba5e8458af45" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/messenger.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony
        https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:messenger</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:transport</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"async"</span>&gt;</span>%env(MESSENGER_TRANSPORT_DSN)%<span class="hljs-tag">&lt;/<span class="hljs-name">framework:transport</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:routing</span> <span class="hljs-attr">message-class</span>=<span class="hljs-string">"Symfony\Component\Mailer\Messenger\SendEmailMessage"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:sender</span> <span class="hljs-attr">service</span>=<span class="hljs-string">"async"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">framework:routing</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:messenger</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-0c1c52c950e6e0e3d65b7c645b1506490b80caee" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/messenger.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>messenger()
        <span class="hljs-operator">-&gt;</span>transport(<span class="hljs-string">'async'</span>)<span class="hljs-operator">-&gt;</span>dsn(env(<span class="hljs-string">'MESSENGER_TRANSPORT_DSN'</span>));

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>messenger()
        <span class="hljs-operator">-&gt;</span>routing(<span class="hljs-string">'Symfony\Component\Mailer\Messenger\SendEmailMessage'</span>)
        <span class="hljs-operator">-&gt;</span>senders([<span class="hljs-string">'async'</span>]);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<p>Thanks to this, instead of being delivered immediately, messages will be sent
to the transport to be handled later (see <a href="messenger.html#messenger-worker" class="reference internal">Messenger: Sync &amp; Queued Message Handling</a>). Note that
the &quot;rendering&quot; of the email (computed headers, body rendering, ...) is also
deferred and will only happen just before the email is sent by the Messenger
handler.</p>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The following example about rendering the email before calling
<code translate="no" class="notranslate">$mailer-&gt;send($email)</code> works as of Symfony 6.2.</p>
</div>
<p>When sending an email asynchronously, its instance must be serializable.
This is always the case for <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bridge/Twig/Mime/Email.php" class="reference external" title="Symfony\Bridge\Twig\Mime\Email" rel="external noopener noreferrer" target="_blank">Email</a>
instances, but when sending a
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bridge/Twig/Mime/TemplatedEmail.php" class="reference external" title="Symfony\Bridge\Twig\Mime\TemplatedEmail" rel="external noopener noreferrer" target="_blank">TemplatedEmail</a>, you must ensure that
the <code translate="no" class="notranslate">context</code> is serializable. If you have non-serializable variables,
like Doctrine entities, either replace them with more specific variables or
render the email before calling <code translate="no" class="notranslate">$mailer-&gt;send($email)</code>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">MailerInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">BodyRendererInterface</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span><span class="hljs-params">(MailerInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span>, BodyRendererInterface <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>bodyRenderer</span>)</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = (<span class="hljs-keyword">new</span> TemplatedEmail())
        <span class="hljs-operator">-&gt;</span>htmlTemplate(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>template</span>)
        <span class="hljs-operator">-&gt;</span>context(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>context</span>)
    ;
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>bodyRenderer</span><span class="hljs-operator">-&gt;</span>render(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);

    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>You can configure which bus is used to dispatch the message using the <code translate="no" class="notranslate">message_bus</code> option.
You can also set this to <code translate="no" class="notranslate">false</code> to call the Mailer transport directly and
disable asynchronous delivery.</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-d03737f7ece7297a8f159620655c270870d857c0" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-3aaa4e64ad7e65504ba548e01948f92fb03d4dba" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-29600338c5e7fd5410a3bc12661511607d551800" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-d03737f7ece7297a8f159620655c270870d857c0" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-attr">framework:</span>
    <span class="hljs-attr">mailer:</span>
        <span class="hljs-attr">message_bus:</span> <span class="hljs-string">app.another_bus</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3aaa4e64ad7e65504ba548e01948f92fb03d4dba" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/messenger.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony
        https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span>
            <span class="hljs-attr">message_bus</span>=<span class="hljs-string">"app.another_bus"</span>
        &gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:mailer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-29600338c5e7fd5410a3bc12661511607d551800" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>mailer()
        <span class="hljs-operator">-&gt;</span>messageBus(<span class="hljs-string">'app.another_bus'</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>In cases of long-running scripts, and when Mailer uses the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Transport/Smtp/SmtpTransport.php" class="reference external" title="Symfony\Component\Mailer\Transport\Smtp\SmtpTransport" rel="external noopener noreferrer" target="_blank">SmtpTransport</a>
you may manually disconnect from the SMTP server to avoid keeping
an open connection to the SMTP server in between sending emails.
You can do so by using the <code translate="no" class="notranslate">stop()</code> method.</p>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.1</span>
    </p><p>The <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Transport/Smtp/SmtpTransport.php#method_stop" class="reference external" title="Symfony\Component\Mailer\Transport\Smtp\SmtpTransport::stop()" rel="external noopener noreferrer" target="_blank">stop()</a>
method was made public in Symfony 6.1.</p>
</div>
<p>You can also select the transport by adding an <code translate="no" class="notranslate">X-Bus-Transport</code> header (which
will be remove automatically from the final message):</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// Use the bus transport "app.another_bus":</span>
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span><span class="hljs-operator">-&gt;</span>getHeaders()<span class="hljs-operator">-&gt;</span>addTextHeader(<span class="hljs-string">'X-Bus-Transport'</span>, <span class="hljs-string">'app.another_bus'</span>);
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>mailer</span><span class="hljs-operator">-&gt;</span>send(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>);</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">X-Bus-Transport</code> header support was introduced in Symfony 6.2.</p>
</div>
</div>
<div class="section">
<h2 id="adding-tags-and-metadata-to-emails">
    Adding Tags and Metadata to Emails
    <a class="headerlink" href="#adding-tags-and-metadata-to-emails" title="Permalink to this headline">¶</a>
</h2>
<p>Certain 3rd party transports support email <em>tags</em> and <em>metadata</em>, which can be used
for grouping, tracking and workflows. You can add those by using the
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Header/TagHeader.php" class="reference external" title="Symfony\Component\Mailer\Header\TagHeader" rel="external noopener noreferrer" target="_blank">TagHeader</a> and
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Header/MetadataHeader.php" class="reference external" title="Symfony\Component\Mailer\Header\MetadataHeader" rel="external noopener noreferrer" target="_blank">MetadataHeader</a> classes. If your transport
supports headers, it will convert them to their appropriate format:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Header</span>\<span class="hljs-title">MetadataHeader</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Header</span>\<span class="hljs-title">TagHeader</span>;

<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span><span class="hljs-operator">-&gt;</span>getHeaders()<span class="hljs-operator">-&gt;</span>add(<span class="hljs-keyword">new</span> TagHeader(<span class="hljs-string">'password-reset'</span>));
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span><span class="hljs-operator">-&gt;</span>getHeaders()<span class="hljs-operator">-&gt;</span>add(<span class="hljs-keyword">new</span> MetadataHeader(<span class="hljs-string">'Color'</span>, <span class="hljs-string">'blue'</span>));
<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span><span class="hljs-operator">-&gt;</span>getHeaders()<span class="hljs-operator">-&gt;</span>add(<span class="hljs-keyword">new</span> MetadataHeader(<span class="hljs-string">'Client-ID'</span>, <span class="hljs-string">'12345'</span>));</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>If your transport does not support tags and metadata, they will be added as custom headers:</p>
<div translate="no" class="highlight-text notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs text">X-Tag: password-reset
X-Metadata-Color: blue
X-Metadata-Client-ID: 12345</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>The following transports currently support tags and metadata:</p>
<ul>
    <li>MailChimp</li>
<li>Mailgun</li>
<li>Postmark</li>
<li>Sendgrid</li>
<li>Sendinblue</li>
</ul>
<p>The following transports only support tags:</p>
<ul>
    <li>MailPace</li>
</ul>
<p>The following transports only support metadata:</p>
<ul>
    <li>Amazon SES (note that Amazon refers to this feature as &quot;tags&quot;, but Symfony
calls it &quot;metadata&quot; because it contains a key and a value)</li>
</ul>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.1</span>
    </p><p>Metadata support for Amazon SES was introduced in Symfony 6.1.</p>
</div>
</div>
<div class="section">
<h2 id="draft-emails">
    Draft Emails
    <a class="headerlink" href="#draft-emails" title="Permalink to this headline">¶</a>
</h2>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.1</span>
    </p><p><code translate="no" class="notranslate">Symfony\Component\Mime\DraftEmail</code> was introduced in 6.1.</p>
</div>
<p><a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mime/DraftEmail.php" class="reference external" title="Symfony\Component\Mime\DraftEmail" rel="external noopener noreferrer" target="_blank">DraftEmail</a> is a special instance of
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mime/Email.php" class="reference external" title="Symfony\Component\Mime\Email" rel="external noopener noreferrer" target="_blank">Email</a>. Its purpose is to build up an email
(with body, attachments, etc) and make available to download as an <code translate="no" class="notranslate">.eml</code> with
the <code translate="no" class="notranslate">X-Unsent</code> header. Many email clients can open these files and interpret
them as <em>draft emails</em>. You can use these to create advanced <code translate="no" class="notranslate">mailto:</code> links.</p>
<p>Here's an example of making one available to download:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// src/Controller/DownloadEmailController.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Controller</span>\<span class="hljs-title">AbstractController</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">HttpFoundation</span>\<span class="hljs-title">ResponseHeaderBag</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">DraftEmail</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Routing</span>\<span class="hljs-title">Annotation</span>\<span class="hljs-title">Route</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DownloadEmailController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractController</span>
</span>{
    <span class="hljs-comment">#[Route('/download-email')]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span><span class="hljs-params">()</span>: <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span> = (<span class="hljs-keyword">new</span> DraftEmail())
            <span class="hljs-operator">-&gt;</span>html(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>renderView(<span class="hljs-comment">/* ... */</span>))
            <span class="hljs-operator">-&gt;</span>attach(<span class="hljs-comment">/* ... */</span>)
        ;

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span> = <span class="hljs-keyword">new</span> Response(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span><span class="hljs-operator">-&gt;</span>toString());
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>contentDisposition</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span><span class="hljs-operator">-&gt;</span>headers<span class="hljs-operator">-&gt;</span>makeDisposition(
            ResponseHeaderBag<span class="hljs-operator">::</span>DISPOSITION_ATTACHMENT,
            <span class="hljs-string">'download.eml'</span>
        );
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span><span class="hljs-operator">-&gt;</span>headers<span class="hljs-operator">-&gt;</span>set(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'message/rfc822'</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span><span class="hljs-operator">-&gt;</span>headers<span class="hljs-operator">-&gt;</span>set(<span class="hljs-string">'Content-Disposition'</span>, <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>contentDisposition</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>response</span>;
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>As it's possible for <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mime/DraftEmail.php" class="reference external" title="Symfony\Component\Mime\DraftEmail" rel="external noopener noreferrer" target="_blank">DraftEmail</a>'s to be created
without a To/From they cannot be sent with the mailer.</p>
</div>
</div>
<div class="section">
<h2 id="mailer-events">
    Mailer Events
    <a class="headerlink" href="#mailer-events" title="Permalink to this headline">¶</a>
</h2>
<div class="section">
<h3 id="messageevent">
    MessageEvent
    <a class="headerlink" href="#messageevent" title="Permalink to this headline">¶</a>
</h3>
<p><strong>Event Class</strong>: <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Event/MessageEvent.php" class="reference external" title="Symfony\Component\Mailer\Event\MessageEvent" rel="external noopener noreferrer" target="_blank">MessageEvent</a></p>
<p><code translate="no" class="notranslate">MessageEvent</code> allows to change the Mailer message and the envelope before
the email is sent:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">EventDispatcher</span>\<span class="hljs-title">EventSubscriberInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">MessageEvent</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mime</span>\<span class="hljs-title">Email</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(MessageEvent <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span>)</span>: <span class="hljs-title">void</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getMessage();
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span> <span class="hljs-keyword">instanceof</span> Email) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// do something with the message (logging, ...)</span>

    <span class="hljs-comment">// and/or add some Messenger stamps</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>addStamp(<span class="hljs-keyword">new</span> SomeMessengerStamp());
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>Methods <code translate="no" class="notranslate">addStamp()</code> and <code translate="no" class="notranslate">getStamps()</code> were introduced in Symfony 6.2.</p>
</div>
<p>If you want to stop the Message from being sent, call <code translate="no" class="notranslate">reject()</code> (it will
also stop the event propagation):</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">MessageEvent</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(MessageEvent <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span>)</span>: <span class="hljs-title">void</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>reject();
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.3</span>
    </p><p>The <code translate="no" class="notranslate">reject()</code> method was introduced in Symfony 6.3.</p>
</div>
<div class="admonition admonition-tip ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                <span>Tip</span>
    </p><p>When using a <code translate="no" class="notranslate">MessageEvent</code> listener to
<a href="mailer.html#signing-and-encrypting-messages" class="reference internal">sign the email contents</a>, run it as
late as possible (e.g. setting a negative priority for it) so the email
contents are not set or modified after signing them.</p>
</div>
<p>Execute this command to find out which listeners are registered for this event
and their priorities:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console debug:event-dispatcher <span class="hljs-string">"Symfony\Component\Mailer\Event\MessageEvent"</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="sentmessageevent">
    SentMessageEvent
    <a class="headerlink" href="#sentmessageevent" title="Permalink to this headline">¶</a>
</h3>
<p><strong>Event Class</strong>: <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Event/SentMessageEvent.php" class="reference external" title="Symfony\Component\Mailer\Event\SentMessageEvent" rel="external noopener noreferrer" target="_blank">SentMessageEvent</a></p>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">SentMessageEvent</code> event was introduced in Symfony 6.2.</p>
</div>
<p><code translate="no" class="notranslate">SentMessageEvent</code> allows you to act on the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component//Mailer//SentMessage.php" class="reference external" title="Symfony\Component\\Mailer\\SentMessage" rel="external noopener noreferrer" target="_blank">SentMessage</a>
class to access the original message (<code translate="no" class="notranslate">getOriginalMessage()</code>) and some debugging
information (<code translate="no" class="notranslate">getDebug()</code>) such as the HTTP calls made by the HTTP transports,
which is useful for debugging errors:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">EventDispatcher</span>\<span class="hljs-title">EventSubscriberInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">SentMessageEvent</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">SentMessage</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(SentMessageEvent <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span>)</span>: <span class="hljs-title">void</span>
</span>{
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getMessage();
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>message</span> <span class="hljs-keyword">instanceof</span> SentMessage) {
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// do something with the message</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Execute this command to find out which listeners are registered for this event
and their priorities:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console debug:event-dispatcher <span class="hljs-string">"Symfony\Component\Mailer\Event\SentMessageEvent"</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<div class="section">
<h3 id="failedmessageevent">
    FailedMessageEvent
    <a class="headerlink" href="#failedmessageevent" title="Permalink to this headline">¶</a>
</h3>
<p><strong>Event Class</strong>: <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Component/Mailer/Event/FailedMessageEvent.php" class="reference external" title="Symfony\Component\Mailer\Event\FailedMessageEvent" rel="external noopener noreferrer" target="_blank">FailedMessageEvent</a></p>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">FailedMessageEvent</code> event was introduced in Symfony 6.2.</p>
</div>
<p><code translate="no" class="notranslate">FailedMessageEvent</code> allows acting on the the initial message in case of a failure:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">EventDispatcher</span>\<span class="hljs-title">EventSubscriberInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Mailer</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">FailedMessageEvent</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(FailedMessageEvent <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span>)</span>: <span class="hljs-title">void</span>
</span>{
    <span class="hljs-comment">// e.g you can get more information on this error when sending an email</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>event</span><span class="hljs-operator">-&gt;</span>getError();

    <span class="hljs-comment">// do something with the message</span>
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>Execute this command to find out which listeners are registered for this event
and their priorities:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-prompt">$ </span>php bin/console debug:event-dispatcher <span class="hljs-string">"Symfony\Component\Mailer\Event\FailedMessageEvent"</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
</div>
<div class="section">
<h2 id="development-debugging">
    Development &amp; Debugging
    <a class="headerlink" href="#development-debugging" title="Permalink to this headline">¶</a>
</h2>
<span id="mail-catcher"></span>
<div class="section">
<h3 id="enabling-an-email-catcher">
    Enabling an Email Catcher
    <a class="headerlink" href="#enabling-an-email-catcher" title="Permalink to this headline">¶</a>
</h3>
<p>When developing locally, it is recommended to use an email catcher. If you have
enabled Docker support via Symfony recipes, an email catcher is automatically
configured. In addition, if you are using the <a href="setup/symfony_server.html" class="reference internal">Symfony local web server</a>, the mailer DSN is automatically exposed via the
<a href="setup/symfony_server.html#symfony-server-docker" class="reference internal">symfony binary Docker integration</a>.</p>
</div>
<div class="section">
<h3 id="sending-test-emails">
    Sending Test Emails
    <a class="headerlink" href="#sending-test-emails" title="Permalink to this headline">¶</a>
</h3>
<p>Symfony provides a command to send emails, which is useful during development
to test if sending emails works correctly:</p>
<div translate="no" class="highlight-terminal highlight-bash notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs terminal bash"><span class="hljs-comment"># the only mandatory argument is the recipient address</span>
<span class="hljs-comment"># (check the command help to learn about its options)</span>
<span class="hljs-prompt">$ </span>php bin/console mailer:<span class="hljs-built_in">test</span> someone@example.com</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<p>This command bypasses the <a href="messenger.html" class="reference internal">Messenger bus</a>, if configured, to
ease testing emails even when the Messenger consumer is not running.</p>
<div class="admonition admonition-versionadded ">
    <p class="admonition-title">
                                    <span>6.2</span>
    </p><p>The <code translate="no" class="notranslate">mailer:test</code> command was introduced in Symfony 6.2.</p>
</div>
</div>
<div class="section">
<h3 id="disabling-delivery">
    Disabling Delivery
    <a class="headerlink" href="#disabling-delivery" title="Permalink to this headline">¶</a>
</h3>
<p>While developing (or testing), you may want to disable delivery of messages
entirely. You can do this by using <code translate="no" class="notranslate">null://null</code> as the mailer DSN, either in
your <a href="configuration.html#configuration-multiple-env-files" class="reference internal">.env configuration files</a> or in
the mailer configuration file (e.g. in the <code translate="no" class="notranslate">dev</code> or <code translate="no" class="notranslate">test</code> environments):</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-f2eac0f5d96ffd195ed116327a82b8690cac4ad0" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-3adb092549f7ae837811d14dcd5fbead4d8f2190" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-1833da879dbecc62dccf6c887ee59e0f67c36d50" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-f2eac0f5d96ffd195ed116327a82b8690cac4ad0" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-string">when@dev:</span>
    <span class="hljs-attr">framework:</span>
        <span class="hljs-attr">mailer:</span>
            <span class="hljs-attr">dsn:</span> <span class="hljs-string">'null://null'</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-3adb092549f7ae837811d14dcd5fbead4d8f2190" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/mailer.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span> <span class="hljs-attr">dsn</span>=<span class="hljs-string">"null://null"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-1833da879dbecc62dccf6c887ee59e0f67c36d50" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>mailer()
        <span class="hljs-operator">-&gt;</span>dsn(<span class="hljs-string">'null://null'</span>);
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
<div class="admonition admonition-note ">
    <p class="admonition-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                <span>Note</span>
    </p><p>If you're using Messenger and routing to a transport, the message will <em>still</em>
be sent to that transport.</p>
</div>
</div>
<div class="section">
<h3 id="always-send-to-the-same-address">
    Always Send to the same Address
    <a class="headerlink" href="#always-send-to-the-same-address" title="Permalink to this headline">¶</a>
</h3>
<p>Instead of disabling delivery entirely, you might want to <em>always</em> send emails to
a specific address, instead of the <em>real</em> address:</p>
<div class="configuration-block">
    <div role="tablist" aria-label="Configuration formats" class="configuration-tabs configuration-tabs-length-3">
                    <button role="tab" type="button" data-language="yaml"
                aria-controls="configuration-block-tabpanel-7039b5df46b4a54b5314ce668fb2d1c814930d2d" aria-selected="true"
                data-active="true" >
                <span>YAML</span>
            </button>
                    <button role="tab" type="button" data-language="xml"
                aria-controls="configuration-block-tabpanel-00c6a68888ec3625691deb6509b4f68535dfc763" aria-selected="false"
                 tabindex="-1">
                <span>XML</span>
            </button>
                    <button role="tab" type="button" data-language="php"
                aria-controls="configuration-block-tabpanel-f1841796cbd50d61ecd38b021d56569d6f166a73" aria-selected="false"
                 tabindex="-1">
                <span>PHP</span>
            </button>
            </div>

            <div role="tabpanel" id="configuration-block-tabpanel-7039b5df46b4a54b5314ce668fb2d1c814930d2d" aria-label="YAML" class="configuration-codeblock" data-language="yaml" style="">
            <div translate="no" class="highlight-yaml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs yaml"><span class="hljs-comment"># config/packages/mailer.yaml</span>
<span class="hljs-string">when@dev:</span>
    <span class="hljs-attr">framework:</span>
        <span class="hljs-attr">mailer:</span>
            <span class="hljs-attr">envelope:</span>
                <span class="hljs-attr">recipients:</span> <span class="hljs-string">['youremail@example.com']</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-00c6a68888ec3625691deb6509b4f68535dfc763" aria-label="XML" class="configuration-codeblock" data-language="xml" style="display: none">
            <div translate="no" class="highlight-xml notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs xml"><span class="hljs-comment">&lt;!-- config/packages/mailer.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">xmlns:framework</span>=<span class="hljs-string">"http://symfony.com/schema/dic/symfony"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd
        http://symfony.com/schema/dic/symfony https://symfony.com/schema/dic/symfony/symfony-1.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">framework:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">framework:mailer</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">framework:envelope</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">framework:recipient</span>&gt;</span>youremail@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">framework:recipient</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">framework:envelope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">framework:mailer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">framework:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
            <div role="tabpanel" id="configuration-block-tabpanel-f1841796cbd50d61ecd38b021d56569d6f166a73" aria-label="PHP" class="configuration-codeblock" data-language="php" style="display: none">
            <div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// config/packages/mailer.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Config</span>\<span class="hljs-title">FrameworkConfig</span>;

<span class="hljs-keyword">return</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(FrameworkConfig <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span>)</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>framework</span><span class="hljs-operator">-&gt;</span>mailer()
        <span class="hljs-operator">-&gt;</span>envelope()
            <span class="hljs-operator">-&gt;</span>recipients([<span class="hljs-string">'youremail@example.com'</span>])
    ;
};</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
<div class="section">
<h3 id="write-a-functional-test">
    Write a Functional Test
    <a class="headerlink" href="#write-a-functional-test" title="Permalink to this headline">¶</a>
</h3>
<p>Symfony provides lots of <a href="testing.html#mailer-assertions" class="reference internal">built-in mailer assertions</a>
to functionally test that an email was sent, its contents or headers, etc.
They are available in test classes extending
<a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/FrameworkBundle/Test/KernelTestCase.php" class="reference external" title="Symfony\Bundle\FrameworkBundle\Test\KernelTestCase" rel="external noopener noreferrer" target="_blank">KernelTestCase</a> or when using
the <a href="https://github.com/symfony/symfony/blob/5.4/src/Symfony/Bundle/FrameworkBundle/Test/MailerAssertionsTrait.php" class="reference external" title="Symfony\Bundle\FrameworkBundle\Test\MailerAssertionsTrait" rel="external noopener noreferrer" target="_blank">MailerAssertionsTrait</a>:</p>
<div translate="no" class="highlight-php notranslate">
    <table class="highlighttable">
        <tbody>
            <tr>
                <td class="linenos">
                    <div class="linenodiv">
                        <pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
                    </div>
                </td>
                <td class="code">
                    <div class="highlight">
                        <pre class="hljs php"><span class="hljs-comment">// tests/Controller/MailControllerTest.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Tests</span>\<span class="hljs-title">Controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Bundle</span>\<span class="hljs-title">FrameworkBundle</span>\<span class="hljs-title">Test</span>\<span class="hljs-title">WebTestCase</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MailControllerTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebTestCase</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testMailIsSentAndContentIsOk</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>client</span> = <span class="hljs-keyword">static</span><span class="hljs-operator">::</span>createClient();
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>client</span><span class="hljs-operator">-&gt;</span>request(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'/mail/send'</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>assertResponseIsSuccessful();

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>assertEmailCount(<span class="hljs-number">1</span>); <span class="hljs-comment">// use assertQueuedEmailCount() when using Messenger</span>

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span> = <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>getMailerMessage();

        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>assertEmailHtmlBodyContains(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>, <span class="hljs-string">'Welcome'</span>);
        <span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>this</span><span class="hljs-operator">-&gt;</span>assertEmailTextBodyContains(<span class="hljs-variable"><span class="hljs-variable-other-marker">$</span>email</span>, <span class="hljs-string">'Welcome'</span>);
    }
}</pre>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>
</div>
</div>

                            </div>                    </div>
                                    </div>        </div>

    </section>

</div>


<script type="text/javascript" src="assets/js/theme.js"></script>
<script type="text/javascript" src="assets/js/badge_only.js"></script>

 
</body>
</html>